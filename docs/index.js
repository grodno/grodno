!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=80)}([function(t,e,n){"use strict";n(3),n(6);const r=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!t)return e;const n="".concat(t);return e+n[0].toUpperCase()+n.slice(1)},i=t=>(""+t).split("_").map(t=>r(t)).join(" ");n(1);const o=(t,e,n)=>{const r=e.split(".").reduce((t,e)=>t?t["0"===e?0:e]:t,t);return void 0===r?n:r};n(35);function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e;return"string"==typeof e&&("-"===e[0]&&(n=-1,e=e.substr(1)),r=t=>t[e]),(t||[]).slice(0).sort(function(t,e){const i=r(t),o=r(e);return i<o?-n:i>o?n:0})}const s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=arguments.length>2?arguments[2]:void 0;const r={};if(t){const i="string"==typeof e?t=>t[e]:e;t.forEach(t=>{r[i(t)]=n?t[n]:t})}return r};n(2);function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){c(t,e,n[e])})}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return u({path:[],params:{},target:""},n);if("object"==typeof t)return u({path:[],params:{},target:""},n,t);if((e=t.indexOf(":"))>-1&&(n.type=t.slice(0,e),t=t.slice(e+1)),(e=t.indexOf("#"))>-1&&(n.data=d(t.slice(e+1)),t=t.slice(0,e)),e=t.indexOf("?"),n.params=n.params||{},e>-1){for(let r of t.slice(e+1).split("&")){let[t,e]=r.split("=");e&&(n.params[t]=d(e))}t=t.slice(0,e)}let r=n.path=t.split("/").map(decodeURIComponent);for(;r.length&&!n.target;)n.target=r.shift();return n}function h(t){let e="";if(!t)return e;if("string"==typeof t)return t;t.target&&(t.type&&(e+="".concat(t.type,"://")),e+=t.target),t.path&&(e+="/".concat(Array.isArray(t.path)?t.path.map(encodeURIComponent).join("/"):t.path));const n=t.params;if(n){const t=Object.keys(n).filter(t=>null!=n[t]);t.length&&(e+="?".concat(t.map(t=>"".concat(t,"=").concat(p(n[t]))).join("&")))}return t.data&&(e+="#".concat(p(t.data))),e}const f={true:!0,false:!1,undefined:void 0};function d(t){const e=decodeURIComponent(t);if("{[".indexOf(e[0])>-1)return JSON.parse(e);const n=+e;return isNaN(n)?f[e]||e:n}function p(t){return encodeURIComponent("object"==typeof t?JSON.stringify(t):"".concat(t))}const m=/&#?[0-9a-z]{3,5};/g,y=/<!--((?!-->)[\s\S])*-->/g,g=/([a-z][a-zA-Z0-9-:]+)="([^"]*)"/g,v=/["'&<>]/g,b=/(<)(\/?)([a-zA-Z][a-zA-Z0-9-:]*)((?:\s+[a-z][a-zA-Z0-9-:]+="[^"]*")*)\s*(\/?)>/g,w="img input br".split(" ").reduce((t,e)=>(t[e]=1,t),{}),E={amp:"&",gt:">",lt:"<",quot:'"',nbsp:" "},S={34:"&quot;",38:"&amp;",39:"&#39;",60:"&lt;",62:"&gt;"},T=t=>S[t.charCodeAt(0)],I=function(t){const e=t.substring(1,t.length-1);return"#"===e[0]?String.fromCharCode(+e.slice(1)):E[e]||" "},k=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(m,I)},_=t=>t?(""+t).replace(v,T):"";let A=1;const D=t=>{const e=new Map;if(!t)return e;for(;;){let n=g.exec(t);if(!n)return e;e.set(n[1],k(n[2]))}},C=t=>{if(!t||!t.size)return"";const e=[];return t.forEach((t,n)=>{t&&"#text"!==n&&e.push(" "+n+'="'+_(t)+'"')}),e.join("")};class N{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;this.uid=A++,this.tag=t||"",this.attrs=e,this.nodes=[]}getChild(t){return this.nodes[t]}setText(t){this.attrs.set("#text",t)}addChild(t,e){const n=new N(t,e);return this.nodes.push(n),n}toString(){return function t(e,n){let{tag:r,attrs:i,nodes:o}=e;const a=C(i);const s=o.map(e=>t(e,"  ".concat(n))).join("\n");const u=i.get("#text");const c=u?"  ".concat(n).concat(_(u)):"";return"".concat(n,"<").concat(r).concat(a)+(s||c?">\n".concat(s).concat(c,"\n").concat(n,"</").concat(r,">"):"/>")}(this,"")}}const O=(t,e)=>{const n=(""+t).trim().replace(y,""),r=[new N];let i=0;for(;;){let t=b.exec(n);if(!t)break;const o=t.index&&n.slice(i,t.index);if(o&&o.trim()&&r[0].addChild("#text").setText(o),t[2]){if(r[0].tag!==t[3])throw new Error((e||"")+" XML Parse closing tag does not match at: "+t.index+" near "+t.input.slice(Math.max(t.index-150,0),t.index)+"^^^^"+t.input.slice(t.index,Math.min(t.index+150,t.input.length)));r.shift()}else{const e=r[0].addChild(t[3],D(t[4]));if(!(t[5]||t[3]in w)&&(r.unshift(e),1===r.length))throw new Error("Parse error at: "+t[0])}i=b.lastIndex}return r[0].getChild(0)};let x=(new Date).getFullYear();Array.from({length:100},()=>"".concat(x--));const P={ru:{monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Март","Апр","Май","Июня","Июля","Авг","Сен","Окт","Ноя","Дек"],monthNamesDeclination:["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"],dayNames:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayNamesShort:["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ"],bookMonthNamesShort:["Янв","Фев","Март","Апр","Май","Июнь","Июль","Авг","Сен","Окт","Ноя","Дек"]}};P.ru.monthNamesShort;const R=t=>{const e=typeof t;if(null==t)return null;if("number"===e)return new Date(t);if("object"===e){if(t.getTime)return t;if(t.toDate)return t.toDate();if(t.seconds&&null!=t.nanoseconds)return new Date(1e3*t.seconds+t.nanoseconds)}return function(t){if("string"!=typeof t)throw new Error("parseISO8601String: not a string: ".concat(t));t.length<11&&(t+="T12:00");const e=/^([0-9]{4})-([0-9]{2})-([0-9]{2})[ T]([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?Z?(?:([+-])([0-9]{2})([0-9]{2}))?/.exec("".concat(t));if(!e)return null;const n=Date.UTC(parseInt(e[1]),parseInt(e[2])-1,parseInt(e[3]),parseInt(e[4]),parseInt(e[5]),e[6]&&parseInt(e[6])||0,e[7]&&parseFloat(e[7])||0);if(e[9]&&e[10]){let t=60*parseInt(e[9])+parseInt(e[10]);return new Date(n+("+"===e[8]?-6e4:6e4)*t)}return new Date(n)}(t)},M=t=>{if(!t)return"";const e=R(t),n=e.getDate(),r=n<10?"0".concat(n):n,i=e.getMonth()+1,o=i<10?"0".concat(i):i,a=e.getFullYear();return"".concat(r,".").concat(o,".").concat(a)},L=t=>{if(!t)return"";const e=Date.now(),n=R(t),r=n.getTime();return r>e?M(n):r+6e4>e?"na momante":r+432e5>e?"na dobu":r+1296e5>e?"uqory":M(n)};Object.undefined;let j=1;const F=t=>t,q=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t+j++};n.d(e,"b",function(){return r}),n.d(e,"e",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"i",function(){return a}),n.d(e,"a",function(){return s}),n.d(e,"j",function(){return l}),n.d(e,"k",function(){return h}),n.d(e,"g",function(){return O}),n.d(e,"h",function(){return L}),n.d(e,"d",function(){return F}),n.d(e,"f",function(){return q})},function(t,e,n){for(var r=n(92),i=n(26),o=n(16),a=n(8),s=n(12),u=n(46),c=n(4),l=c("iterator"),h=c("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),m=0;m<p.length;m++){var y,g=p[m],v=d[g],b=a[g],w=b&&b.prototype;if(w&&(w[l]||s(w,l,f),w[h]||s(w,h,g),u[g]=f,v))for(y in r)w[y]||o(w,y,r[y],!0)}},function(t,e,n){"use strict";var r=n(8),i=n(15),o=n(9),a=n(21),s=n(16),u=n(83).KEY,c=n(10),l=n(24),h=n(41),f=n(19),d=n(4),p=n(55),m=n(56),y=n(84),g=n(88),v=n(5),b=n(13),w=n(31),E=n(18),S=n(39),T=n(23),I=n(59),k=n(91),_=n(60),A=n(58),D=n(11),C=n(26),N=_.f,O=D.f,x=k.f,P=r.Symbol,R=r.JSON,M=R&&R.stringify,L=d("_hidden"),j=d("toPrimitive"),F={}.propertyIsEnumerable,q=l("symbol-registry"),B=l("symbols"),U=l("op-symbols"),V=Object.prototype,K="function"==typeof P&&!!A.f,z=r.QObject,G=!z||!z.prototype||!z.prototype.findChild,W=o&&c(function(){return 7!=I(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=N(V,e);r&&delete V[e],O(t,e,n),r&&t!==V&&O(V,e,r)}:O,Q=function(t){var e=B[t]=I(P.prototype);return e._k=t,e},H=K&&"symbol"==typeof P.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof P},Y=function(t,e,n){return t===V&&Y(U,e,n),v(t),e=S(e,!0),v(n),i(B,e)?(n.enumerable?(i(t,L)&&t[L][e]&&(t[L][e]=!1),n=I(n,{enumerable:T(0,!1)})):(i(t,L)||O(t,L,T(1,{})),t[L][e]=!0),W(t,e,n)):O(t,e,n)},X=function(t,e){v(t);for(var n,r=y(e=E(e)),i=0,o=r.length;o>i;)Y(t,n=r[i++],e[n]);return t},$=function(t){var e=F.call(this,t=S(t,!0));return!(this===V&&i(B,t)&&!i(U,t))&&(!(e||!i(this,t)||!i(B,t)||i(this,L)&&this[L][t])||e)},J=function(t,e){if(t=E(t),e=S(e,!0),t!==V||!i(B,e)||i(U,e)){var n=N(t,e);return!n||!i(B,e)||i(t,L)&&t[L][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=x(E(t)),r=[],o=0;n.length>o;)i(B,e=n[o++])||e==L||e==u||r.push(e);return r},tt=function(t){for(var e,n=t===V,r=x(n?U:E(t)),o=[],a=0;r.length>a;)!i(B,e=r[a++])||n&&!i(V,e)||o.push(B[e]);return o};K||(s((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===V&&e.call(U,n),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),W(this,t,T(1,n))};return o&&G&&W(V,t,{configurable:!0,set:e}),Q(t)}).prototype,"toString",function(){return this._k}),_.f=J,D.f=Y,n(45).f=k.f=Z,n(44).f=$,A.f=tt,o&&!n(25)&&s(V,"propertyIsEnumerable",$,!0),p.f=function(t){return Q(d(t))}),a(a.G+a.W+a.F*!K,{Symbol:P});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var rt=C(d.store),it=0;rt.length>it;)m(rt[it++]);a(a.S+a.F*!K,"Symbol",{for:function(t){return i(q,t+="")?q[t]:q[t]=P(t)},keyFor:function(t){if(!H(t))throw TypeError(t+" is not a symbol!");for(var e in q)if(q[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!K,"Object",{create:function(t,e){return void 0===e?I(t):X(I(t),e)},defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:tt});var ot=c(function(){A.f(1)});a(a.S+a.F*ot,"Object",{getOwnPropertySymbols:function(t){return A.f(w(t))}}),R&&a(a.S+a.F*(!K||c(function(){var t=P();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(b(e)||void 0!==t)&&!H(t))return g(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!H(e))return e}),r[1]=e,M.apply(R,r)}}),P.prototype[j]||n(12)(P.prototype,j,P.prototype.valueOf),h(P,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(t,e,n){"use strict";var r=n(61),i=n(5),o=n(98),a=n(47),s=n(29),u=n(32),c=n(48),l=n(10),h=Math.min,f=[].push,d=!l(function(){RegExp(4294967295,"y")});n(34)("split",2,function(t,e,n,l){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);for(var o,a,s,u=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,d=void 0===e?4294967295:e>>>0,p=new RegExp(t.source,l+"g");(o=c.call(p,i))&&!((a=p.lastIndex)>h&&(u.push(i.slice(h,o.index)),o.length>1&&o.index<i.length&&f.apply(u,o.slice(1)),s=o[0].length,h=a,u.length>=d));)p.lastIndex===o.index&&p.lastIndex++;return h===i.length?!s&&p.test("")||u.push(""):u.push(i.slice(h)),u.length>d?u.slice(0,d):u}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var i=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):p.call(String(i),n,r)},function(t,e){var r=l(p,t,this,e,p!==n);if(r.done)return r.value;var c=i(t),f=String(this),m=o(c,RegExp),y=c.unicode,g=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(d?"y":"g"),v=new m(d?c:"^(?:"+c.source+")",g),b=void 0===e?4294967295:e>>>0;if(0===b)return[];if(0===f.length)return null===u(v,f)?[f]:[];for(var w=0,E=0,S=[];E<f.length;){v.lastIndex=d?E:0;var T,I=u(v,d?f:f.slice(E));if(null===I||(T=h(s(v.lastIndex+(d?0:E)),f.length))===w)E=a(f,E,y);else{if(S.push(f.slice(w,E)),S.length===b)return S;for(var k=1;k<=I.length-1;k++)if(S.push(I[k]),S.length===b)return S;E=w=T}}return S.push(f.slice(w)),S}]})},function(t,e,n){var r=n(24)("wks"),i=n(19),o=n(8).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){var r=n(13);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";var r=n(5),i=n(31),o=n(29),a=n(30),s=n(47),u=n(32),c=Math.max,l=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;n(34)("replace",2,function(t,e,n,p){return[function(r,i){var o=t(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=p(n,t,this,e);if(i.done)return i.value;var h=r(t),f=String(this),d="function"==typeof e;d||(e=String(e));var y=h.global;if(y){var g=h.unicode;h.lastIndex=0}for(var v=[];;){var b=u(h,f);if(null===b)break;if(v.push(b),!y)break;""===String(b[0])&&(h.lastIndex=s(f,o(h.lastIndex),g))}for(var w,E="",S=0,T=0;T<v.length;T++){b=v[T];for(var I=String(b[0]),k=c(l(a(b.index),f.length),0),_=[],A=1;A<b.length;A++)_.push(void 0===(w=b[A])?w:String(w));var D=b.groups;if(d){var C=[I].concat(_,k,f);void 0!==D&&C.push(D);var N=String(e.apply(void 0,C))}else N=m(I,f,k,_,D,e);k>=S&&(E+=f.slice(S,k)+N,S=k+I.length)}return E+f.slice(S)}];function m(t,e,r,o,a,s){var u=r+t.length,c=o.length,l=d;return void 0!==a&&(a=i(a),l=f),n.call(s,l,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var l=+i;if(0===l)return n;if(l>c){var f=h(l/10);return 0===f?n:f<=c?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[l-1]}return void 0===s?"":s})}})},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(2),n(1);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class i{constructor(t){let{api:e,ref:n,props:i}=t;Object.assign(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){r(t,e,n[e])})}return t}({},i,{api:e,ref:n})),this.notify=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.emitter.notify(n,...r)},this.emit=function(){return e.emitter.emit(...arguments)},this.subscribe=function(){return e.emitter.subscribe(...arguments)},this.log=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.log(n+": ",...e)},this.error=t=>console.error(n+": ",t)}}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){t.exports=!n(10)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(5),i=n(52),o=n(39),a=Object.defineProperty;e.f=n(9)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(11),i=n(23);t.exports=n(9)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a});n(1),n(6),n(3);var r=n(0),i=n(20);const o=t=>t+",Гродно,Беларусь",a={upper:t=>(""+t).toUpperCase(),hostOf:t=>Object(r.j)(t).target||t,date:t=>Object(r.h)(t),capitalize:r.b,serializeParams:t=>t?Object.keys(t).map(e=>"".concat(e,"=").concat(t[e])).join("&"):"",initials:t=>t?t.split(" ").slice(0,2).map(t=>t.slice(0,1).toUpperCase()).join(""):"",not:t=>!t,translit:i.a,rest:t=>t?t.slice(1):[],limit:t=>t?t.slice(0,50):[],ifAbove:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return+t>+e?t:""},counts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!t)return"loading...";const{total:r,actual:i}=t;return r?i?i===r?r+" "+e:n+" "+i+" / "+r+" "+e:"Ne znojdzena":"Nic nema"},subject(t){const e=t||"";return e.slice(0,50)+(e.length>50?"...":"")},ago:t=>(t||"").fromNow().replace("ago","tamu").replace("hours","qasow").replace("hour","qas").replace("days","dzon").replace("day","dzen"),preview:t=>t,preview2:t=>(""+(t||"")).replace(/<br\s?\/?>/g,"~").replace(/<.*?>/g," ").trim().split("~")}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(8),i=n(12),o=n(15),a=n(19)("src"),s=n(82),u=(""+s).split("toString");n(22).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(o(n,a)||i(n,a,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(85),i=n(28);t.exports=function(t){return r(i(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){"use strict";n(1),n(6),n(51);const r=[[/shq/gi,function(t){return t[0]+t[2]}],[/dzh/gi,function(t){return t[0]+"h"}],[/cca\b/g,function(t){return"t sa"}],[/(shy|ci|m|j)sja\b/g,function(t,e){return e+" sa"}],[/[auyoielq][wjiya]sja\b/g,function(t){return t[0]+t[1]+" sa"}],[/(dz)j/gi,function(t,e){return e}],[/jj/gi,function(t){return"'"+t[0]}],[/lj[nklmspgt]/gi,function(t){return t[0]+t[2]}],[/\b[nb]ja/gi,function(t,e){return t[0]+"e"}],[/[uaoi]cj\b/g,function(t){return t[0]+"t"}],[/[zcs]j\b/gi,function(t){return t[0]}],[/aja\b/gi,function(t){return"ea"}],[/[cln]j[cln]/g,function(t,e,n){return t[0]+(t[0]===t[2]?"":t[1])+t[2]}],[/[yi]j[a]/gi,function(t){return t[0]+t[2]}],[/[ayiu]e[oue]/gi,function(t){return t[0]+t[2]}],[/[psgklfzcvbnm]j[a]/gi,function(t){return t[0]+"i"+t[2]}],[/[psgklfzcvbnm]e[e]/gi,function(t){return t[0]+""+t[2]}]],i=[[/\bjosc\b/gi,function(t,e){return"e"}],[/\bkab\b/gi,function(t,e){return"tob"}],[/\bjasqe\b/gi,function(t,e){return"sqe"}],[/\bjak(\w*)\b/gi,function(t,e){return e?"k"+e:"kaj"}],[/\b(c)iaper\b/gi,"doper"],[/\bamalj\b/gi,"badaj"],[/\b(seonnia)(\w*)\b/gi,function(t,e,n){return"dobu"+n}],[/\b(grod)n?(\w*)\b/gi,function(t,e,n){return"Olgard"+("a"===n?"":n)}],[/\b(garadzen)(\w*)\b/gi,function(t,e,n){return"Olgard"+("a"===n?"":n)}],[/\b(belarus)(\w*)\b/gi,function(t,e,n){return"Baltorus"+n}],[/\b(save[tc])s?k?(\w*)\b/gi,function(t,e,n){return"Slavian"+n}],[/\bj?ewr(o|a)(\w*)\b/gi,function(t,e,n){return"Euro"+n}],[/\respublik(\w*)\b/gi,function(t,e,n){return"Impery"+e}],[/\bv?oblasc?n?(\w*)\b/gi,function(t,e,n){return"zon"+e}],[/\brajon?n?(\w*)\b/gi,function(t,e,n){return"pavet"+e}],[/\blit(ow|v)(\w+)\b/gi,function(t,e,n){return"Letuvis"+n}],[/\bpols(q|k)(\w+)\b/gi,function(t,e,n){return"Panstv"+n}],[/\b(lenin)(\w*)\b/gi,function(t,e,n){return"Babaj"+n}],[/\b(kastryqn)(\w*)\b/gi,function(t,e,n){return"Kryshn"+n}],[/\b(prezident)(\w*)\b/gi,function(t,e,n){return"Igemon"+n}],[/\b(lukashenk)(\w*)\b/gi,function(t,e,n){return"I"}],[/\b((?:abl|gar|raj)vykankam)(\w*)\b/gi,function(t,e,n){return"Kurultaj"+n}],[/\b(naj)([qrtpsdfghklxcvbnm]\w+)\b/gi,function(t,e,n){return e+" "+n}],[/\bw/gi,function(t){return"w"===t?"u":"U"}]],o="((".concat("b|bl|br|c|cm|cs|cv|d|dr|dv|dz|dzh|dzm|dzv|f|fl|g|gl|gm|gn|gr|gv|ja|k|kl|kn|kp|kr|krz|ks|kv|l|lg|m|mg|mgl|mgn|ml|mn|mr|n|p|pl|pq|pr|ps|psh|pt|pxn|q|qm|qv|r|rv|rz|rzh|s|sc|sh|shk|shl|shm|shn|shp|shq|shr|sht|shv|sk|skl|skr|skv|sl|sm|smr|sn|sp|spr|sq|sr|st|str|sv|t|tk|tkn|tl|tr|tv|tx|v|v|w|x|xl|xm|xr|xt|xv|z|zd|zdr|zdz|zh|zhd|zhm|zhn|zhv|zl|zm|zn|zr|zv",")(a|ai|aj|e|ej|i|ja|ju|o|oj|u|uj|y)(").concat("b|br|c|cm|cs|d|dk|dl|dr|dsk|dt|dv|dx|dz|dzc|dzh|dzk|dzm|dzv|f|ft|g|gc|gd|gl|gn|gr|gs|k|kc|kk|kl|kn|kr|ks|kt|kv|l|lb|ld|ldz|lg|lk|ll|lm|lp|lt|lz|m|mb|mk|ml|mn|mp|mr|ms|msc|mz|n|nc|ncs|nd|ndr|ndz|nk|nkt|nn|nq|ns|nsh|nsk|nt|ntr|nzh|p|pc|pl|pn|psh|psk|pst|pt|q|qm|qn|qq|r|rb|rc|rcs|rd|rdz|rg|rgn|rk|rkv|rl|rm|rn|rp|rpl|rq|rs|rsh|rsk|rsq|rst|rt|rtk|rtv|rv|rx|rzd|rzh|s|sc|scm|scs|sh|shc|shk|shl|shm|shn|sht|sk|skr|sl|sm|sn|sp|sq|st|str|t|tc|tk|tkn|tl|tn|tq|tr|v|w|x|xc|xk|xl|xm|xn|xq|xr|xt|z|zb|zd|zdq|zdr|zdz|zg|zgr|zh|zhd|zhn|zhq|zhz|zk|zl|zn|zsh",")?)(og|ozh|[iayou]q|[ao][td])?j?[kcqln]?"),a="(avawsh|ikowsk|adann|adliv|adumn|alenn|alist|aljon|aluqn|anstv|aqenn|aqkov|aqysq|arank|arodc|arodk|arodn|asnul|atann|atliv|atvor|avann|avenn|averx|avink|avjak|avodn|awlen|awlin|azdaq|azliv|ennic|ennik|enstv|instv|iwnik|jajuq|jecjk|meshn|nuwsh|onaqk|ovejk|udziv|uvann|uxnul|yvann|yxnul|abok|acjk|ajuq|alit|aljn|alos|anic|anin|anit|anjk|anov|anul|apud|aqyn|arad|arob|arsk|atux|avan|avat|avic|avit|awsh|azhn|ejsh|eljk|enjk|ensk|eshk|ewsh|ewsk|ezhn|icjk|iljn|ishk|iwsh|jank|jort|jutk|ocjk|okag|olen|oljn|onan|ontk|ovan|oviq|owsk|oxan|ozhn|shag|shan|ujuq|uman|ushk|ushn|uwsh|vjak|vjan|yqyn|yrav|ytus|ywsh|acc|adk|adn|adz|agn|ajc|ajk|ajn|ank|ann|aqk|aqv|ark|asc|ask|asl|asn|ast|atk|atn|awk|awl|axl|azh|bat|bov|edz|egl|ejk|elc|enc|enn|eqk|erk|esn|esq|ess|etn|ewc|ewk|ezg|gac|gan|idl|inc|ink|iqn|isl|isq|ist|itn|jas|jav|jon|mex|obk|obn|odn|odz|ojn|oll|omi|onc|onk|onn|oqk|oqv|ork|orn|otk|otn|owc|owk|own|owv|stk|stv|uar|ukn|ush|usk|utk|uxn|van|ydn|ync|ynk|ysh|ysq|yst|ytk|ab|ad|ag|ak|al|am|an|aq|ar|as|at|av|az|ec|ed|el|en|eq|er|et|ev|ew|ex|ic|id|ik|in|it|iv|ix|iz|ob|oc|od|og|ok|ol|on|op|oq|os|ot|ov|ow|sh|sk|st|ug|uk|ul|um|un|uq|us|ut|ux|yg|yk|yn|yq|yr|yt|yv|yx|b|v)?j?(a|e|i|o|u|y|ae|aj|am|aw|ax|ei|ej|em|ii|im|ix|ma|mi|oe|oi|oj|om|ue|uj|ym|yx|uw|aem|aja|aju|ami|amu|ee|eju|ija|imi|oju|oma|omi|omu|uju|yju|yja|ymi|ymu|yma|ajami|[auye]em|[iaeuy]li|[iaeuy]la|[iaeuy]lo|[aie]sh|[auye]esh|[ao]ga|gi|ogi)?",s=(new RegExp("^"+o+a+"$",""),new RegExp("^(abjas|nepry|paras|pryna|sprad|nepa|pada|pavy|pera|aba|abo|naj|nea|nes|new|pad|paw|pow|pra|pro|pry|ras|spa|wva|ab|ad|da|na|ne|ni|pa|po|sa|su|vo|vy|ws|za|a|s|u|w|z)"+o+a+"$",""),new RegExp("(cj|ci|sja|sj|cje)$"),(t,e)=>t.reduce((t,e)=>{let[n,r]=e;return t.replace(n,r)},e));n(3);const u={"а":"a","е":"e","э":"e","о":"o","ы":"y",i:"i","і":"i","и":"i","й":"j","ь":"j","ю":"eu","я":"ja","ё":"eo","ъ":"'","ж":"gh","ш":"sh","щ":"sq","б":"b","в":"v","г":"g","д":"d","з":"z","к":"k","л":"l","м":"m","н":"n","п":"p","р":"r","с":"s","т":"t","у":"u","ў":"w","ф":"f","х":"x","ц":"c","ч":"q","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"Je","Ё":"Jo","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ў":"W","Ф":"F","Х":"X","Ц":"C","Ч":"Q","Ш":"Sh","Щ":"Sq","Э":"E","Ы":"Y","Ь":"j","Ю":"Ju","Я":"Ja"},c=t=>(""+t).split("").map(t=>u[t]||t).join("");function l(t){return s(i,s(r,c(t)))}n.d(e,"a",function(){return l})},function(t,e,n){var r=n(8),i=n(22),o=n(12),a=n(16),s=n(54),u=function(t,e,n){var c,l,h,f,d=t&u.F,p=t&u.G,m=t&u.S,y=t&u.P,g=t&u.B,v=p?r:m?r[e]||(r[e]={}):(r[e]||{}).prototype,b=p?i:i[e]||(i[e]={}),w=b.prototype||(b.prototype={});for(c in p&&(n=e),n)h=((l=!d&&v&&void 0!==v[c])?v:n)[c],f=g&&l?s(h,r):y&&"function"==typeof h?s(Function.call,h):h,v&&a(v,c,h,t&u.U),b[c]!=h&&o(b,c,f),y&&w[c]!=h&&(w[c]=h)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){var n=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(22),i=n(8),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(25)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=!1},function(t,e,n){var r=n(57),i=n(43);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(30),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(28);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r=n(100),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,n){"use strict";var r=n(5);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";n(101);var r=n(16),i=n(12),o=n(10),a=n(28),s=n(4),u=n(48),c=s("species"),l=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),h=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var f=s(t),d=!o(function(){var e={};return e[f]=function(){return 7},7!=""[t](e)}),p=d?!o(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[f](""),!e}):void 0;if(!d||!p||"replace"===t&&!l||"split"===t&&!h){var m=/./[f],y=n(a,f,""[t],function(t,e,n,r,i){return e.exec===u?d&&!i?{done:!0,value:m.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),g=y[0],v=y[1];r(String.prototype,t,g),i(RegExp.prototype,f,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},function(t,e,n){"use strict";var r=n(21),i=n(40),o=n(31),a=n(10),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(102)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,n){"use strict";n(103);var r=n(5),i=n(33),o=n(9),a=/./.toString,s=function(t){n(16)(RegExp.prototype,"toString",t,!0)};n(10)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(6),n(1),n(0);const r=function(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(e=>e.replace(/<template\sid="(.+)"\>([\s\S]*?)<\/template>/gm,(e,n,r)=>t.push({NAME:n,TEMPLATE:r}))),t}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){var r=n(13);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(11).f,i=n(15),o=n(4)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(24)("keys"),i=n(19);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(57),i=n(43).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e){t.exports={}},function(t,e,n){"use strict";var r=n(99)(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){"use strict";var r,i,o=n(33),a=RegExp.prototype.exec,s=String.prototype.replace,u=a,c=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];(c||l)&&(u=function(t){var e,n,r,i,u=this;return l&&(n=new RegExp("^"+u.source+"$(?!\\s)",o.call(u))),c&&(e=u.lastIndex),r=a.call(u,t),c&&r&&(u.lastIndex=u.global?r.index+r[0].length:e),l&&r&&r.length>1&&s.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r}),t.exports=u},function(t,e,n){"use strict";var r=n(5),i=n(29),o=n(47),a=n(32);n(34)("match",1,function(t,e,n,s){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=s(n,t,this);if(e.done)return e.value;var u=r(t),c=String(this);if(!u.global)return a(u,c);var l=u.unicode;u.lastIndex=0;for(var h,f=[],d=0;null!==(h=a(u,c));){var p=String(h[0]);f[d]=p,""===p&&(u.lastIndex=o(c,i(u.lastIndex),l)),d++}return 0===d?null:f}]})},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){var r=n(8),i=n(107),o=n(11).f,a=n(45).f,s=n(61),u=n(33),c=r.RegExp,l=c,h=c.prototype,f=/a/g,d=/a/g,p=new c(f)!==f;if(n(9)&&(!p||n(10)(function(){return d[n(4)("match")]=!1,c(f)!=f||c(d)==d||"/a/i"!=c(f,"i")}))){c=function(t,e){var n=this instanceof c,r=s(t),o=void 0===e;return!n&&r&&t.constructor===c&&o?t:i(p?new l(r&&!o?t.source:t,e):l((r=t instanceof c)?t.source:t,r&&o?u.call(t):e),n?this:h,c)};for(var m=function(t){t in c||o(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})},y=a(l),g=0;y.length>g;)m(y[g++]);h.constructor=c,c.prototype=h,n(16)(r,"RegExp",c)}n(109)("RegExp")},function(t,e,n){t.exports=!n(9)&&!n(10)(function(){return 7!=Object.defineProperty(n(53)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(13),i=n(8).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(40);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){e.f=n(4)},function(t,e,n){var r=n(8),i=n(22),o=n(25),a=n(55),s=n(11).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var r=n(15),i=n(18),o=n(86)(!1),a=n(42)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(5),i=n(89),o=n(43),a=n(42)("IE_PROTO"),s=function(){},u=function(){var t,e=n(53)("iframe"),r=o.length;for(e.style.display="none",n(90).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(44),i=n(23),o=n(18),a=n(39),s=n(15),u=n(52),c=Object.getOwnPropertyDescriptor;e.f=n(9)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(13),i=n(27),o=n(4)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){"use strict";var r=n(5),i=n(104),o=n(32);n(34)("search",1,function(t,e,n,a){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=r(t),u=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var l=o(s,u);return i(s.lastIndex,c)||(s.lastIndex=c),null===l?-1:l.index}]})},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});n(1),n(105),n(106),n(112);var r=n(7);const i=t=>t.docs.reduce((t,e)=>{const n=e.data();return n.id=e.id,t.push(n),t},[]);class o extends r.a{constructor(t){super(t);const e=window.firebase;e.initializeApp(this.config),this.firestore=e.firestore(),this.firestore.enablePersistence({synchronizeTabs:!0}).catch(function(t){"failed-precondition"===t.code||t.code}),this.auth=e.auth(),this.auth.languageCode="by",this.providers={Google:e.auth.GoogleAuthProvider}}done(){window.firebase.app().delete()}signInAnonymously(){this.auth.signInAnonymously().catch(function(t){var e=t.message;console.log("signInAnonymously err="+e)})}listenUser(t){this.auth.onAuthStateChanged(t)}getCurrentUser(){return this.auth.currentUser}linkProvider(t){const e=new this.providers.Google;e.addScope("https://www.googleapis.com/auth/contacts.readonly"),this.auth.signInWithPopup(e).then(function(e){var n=e.user,r=this.auth.GoogleAuthProvider.credential(n.getAuthResponse().id_token);this.getCurrentUser().linkAndRetrieveDataWithCredential(r).then(function(e){var n=e.user;console.log("Anonymous account successfully upgraded",n),t()},function(t){console.log("Error upgrading anonymous account",t)})}).catch(function(t){var e=t.message;console.log("signInAnonymously err="+e)})}logout(t){t()}getCollection(t,e){return(t=>e?t.where("modified_at",">",e):t)(this.firestore.collection(t)).get().then(i)}listenCollection(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return(t=>e?t.where("modified_at",">",e):t)(this.firestore.collection(t)).onSnapshot(function(e){var r=[];e.forEach(function(t){const e=t.data();e.id=t.id,r.push(e)}),n(null,{[t]:r})})}nextId(t){return this.firestore.collection(t).doc().id}update(t){const e=Date.now().valueOf();var n=this.firestore.batch();return Object.keys(t).forEach(r=>{const i=this.firestore.collection(r);t[r].forEach(t=>{t.modified_at=e;var r=i.doc(""+t.id);n.set(r,t,{merge:!0})})}),n.commit()}}const a=t.hot;a&&a.accept()}).call(this,n(38)(t))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){n(56)("asyncIterator")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(67),o=n(110),a=n(111),s=((r={})["no-app"]="No Firebase App '{$name}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$name}",r["duplicate-app"]="Firebase App named '{$name}' already exists",r["app-deleted"]="Firebase App named '{$name}' already deleted",r["duplicate-service"]="Firebase service named '{$name}' already registered",r["invalid-app-argument"]="firebase.{$name}() takes either no argument or a Firebase App instance.",r),u=new o.ErrorFactory("app","Firebase",s),c="[DEFAULT]",l=[],h=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){l.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){l=l.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,r=Object.keys(t.services_);n<r.length;n++)for(var i=r[n],o=0,a=Object.keys(t.services_[i]);o<a.length;o++){var s=a[o];e.push(t.services_[i][s])}return Promise.all(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=c),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==c?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;o.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(l.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),l=[])},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{name:this.name_})},t}();h.prototype.name&&h.prototype.options||h.prototype.delete||console.log("dc");var f="6.2.4";
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var d=new a.Logger("@firebase/app");if(o.isBrowser()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var p=self.firebase.SDK_VERSION;p&&p.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var m=
/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function t(){var e=function(t){var e={},n={},r={},i={__esModule:!0,initializeApp:function(n,r){if(void 0===r&&(r={}),"object"!=typeof r||null===r){var a=r;r={name:a}}var s=r;void 0===s.name&&(s.name=c);var h=s.name;if("string"!=typeof h||!h)throw u.create("bad-app-name",{name:String(h)});if(o.contains(e,h))throw u.create("duplicate-app",{name:h});var f=new t(n,s,i);return e[h]=f,l(f,"create"),f},app:a,apps:null,SDK_VERSION:f,INTERNAL:{registerService:function(e,c,l,h,f){if(void 0===f&&(f=!1),n[e])throw u.create("duplicate-service",{name:e});function d(t){if(void 0===t&&(t=a()),"function"!=typeof t[e])throw u.create("invalid-app-argument",{name:e});return t[e]()}return n[e]=c,h&&(r[e]=h,s().forEach(function(t){h("create",t)})),void 0!==l&&o.deepExtend(d,l),i[e]=d,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._getService.bind(this,e);return r.apply(this,f?t:[])},d},removeApp:function(t){l(e[t],"delete"),delete e[t]},factories:n,useAsService:h}};function a(t){if(t=t||c,!o.contains(e,t))throw u.create("no-app",{name:t});return e[t]}function s(){return Object.keys(e).map(function(t){return e[t]})}function l(t,e){for(var i=0,o=Object.keys(n);i<o.length;i++){var a=h(0,o[i]);if(null===a)return;r[a]&&r[a](e,t)}}function h(t,e){return"serverAuth"===e?null:e}return i.default=i,Object.defineProperty(i,"apps",{get:s}),a.App=t,i}(h);return e.INTERNAL=i.__assign({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){o.deepExtend(e,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),e}(),y=m.initializeApp;m.initializeApp=function(){return o.isNode()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\n      to false and "main" to true:\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),y.apply(void 0,arguments)};var g=m;e.default=g,e.firebase=g},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",function(){return i}),n.d(e,"__assign",function(){return o}),n.d(e,"__rest",function(){return a}),n.d(e,"__decorate",function(){return s}),n.d(e,"__param",function(){return u}),n.d(e,"__metadata",function(){return c}),n.d(e,"__awaiter",function(){return l}),n.d(e,"__generator",function(){return h}),n.d(e,"__exportStar",function(){return f}),n.d(e,"__values",function(){return d}),n.d(e,"__read",function(){return p}),n.d(e,"__spread",function(){return m}),n.d(e,"__await",function(){return y}),n.d(e,"__asyncGenerator",function(){return g}),n.d(e,"__asyncDelegator",function(){return v}),n.d(e,"__asyncValues",function(){return b}),n.d(e,"__makeTemplateObject",function(){return w}),n.d(e,"__importStar",function(){return E}),n.d(e,"__importDefault",function(){return S});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||s(t,e)})})}function s(t,e){try{(n=i[t](e)).value instanceof y?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function v(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:y(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,i){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,i,(e=t[n](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function E(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function S(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){"use strict";e.a='<body id="app">\n    <template id="TopNews">\n        <ui:fragment>\n            <ResService ui:ref="res" />\n            <Firebase ui:ref="firebase" config=":firebaseConfig" />\n            <LocalStorage ui:ref="local" />\n            <DatabaseService ui:ref="db" schema=":dbSchema" />\n            <SWRunner />\n            <GARunner account="UA-3066107-2" />\n            <NewsPage />\n        </ui:fragment>\n\n    </template>\n    <template id="Top">\n        <ui:fragment>\n            <ResService ui:ref="res" />\n            <Firebase ui:ref="firebase" config=":firebaseConfig" />\n            <NavigationService ui:ref="nav" />\n            <LocalStorage ui:ref="local" />\n            <DatabaseService ui:ref="db" schema=":dbSchema" />\n            <UserService ui:ref="user" />\n            <Sidebar>\n                <Sidebar:aside>\n                    <Panel style="height: 100vh;">\n                        <Panel:title>\n                            <h3>:appName</h3>\n                        </Panel:title>\n                        <Panel:footer>\n                            <div>:settings</div>\n                        </Panel:footer>\n                        <NavTree data="<- nav://sitemap" />\n                    </Panel>\n                </Sidebar:aside>\n                <ui:fragment>\n                    <Navbar logo=":appLogo">\n                        <Navbar:right>\n                            <UserBar />\n                        </Navbar:right>\n                    </Navbar>\n                    <Container>\n                        <PageRouter ui:props="<- nav://state" />\n                    </Container>\n                </ui:fragment>\n            </Sidebar>\n        </ui:fragment>\n    </template>\n</body>'},function(t,e,n){"use strict";(function(t,n){var r=Object.keys,i=Array.isArray,o="undefined"!=typeof self?self:"undefined"!=typeof window?window:t;function a(t,e){return"object"!=typeof e?t:(r(e).forEach(function(n){t[n]=e[n]}),t)}var s=Object.getPrototypeOf,u={}.hasOwnProperty;function c(t,e){return u.call(t,e)}function l(t,e){"function"==typeof e&&(e=e(s(t))),r(e).forEach(function(n){f(t,n,e[n])})}var h=Object.defineProperty;function f(t,e,n,r){h(t,e,a(n&&c(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function d(t){return{from:function(e){return t.prototype=Object.create(e.prototype),f(t.prototype,"constructor",t),{extend:l.bind(null,t.prototype)}}}}var p=Object.getOwnPropertyDescriptor;var m=[].slice;function y(t,e,n){return m.call(t,e,n)}function g(t,e){return e(t)}function v(t){if(!t)throw new Error("Assertion Failed")}function b(t){o.setImmediate?n(t):setTimeout(t,0)}function w(t,e){return t.reduce(function(t,n,r){var i=e(n,r);return i&&(t[i[0]]=i[1]),t},{})}function E(t,e){return function(){try{t.apply(this,arguments)}catch(t){e(t)}}}function S(t,e,n){try{t.apply(null,n)}catch(t){e&&e(t)}}function T(t,e){if(c(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var n=[],r=0,i=e.length;r<i;++r){var o=T(t,e[r]);n.push(o)}return n}var a=e.indexOf(".");if(-1!==a){var s=t[e.substr(0,a)];return void 0===s?void 0:T(s,e.substr(a+1))}}function I(t,e,n){if(t&&void 0!==e&&!("isFrozen"in Object&&Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){v("string"!=typeof n&&"length"in n);for(var r=0,i=e.length;r<i;++r)I(t,e[r],n[r])}else{var o=e.indexOf(".");if(-1!==o){var a=e.substr(0,o),s=e.substr(o+1);if(""===s)void 0===n?delete t[a]:t[a]=n;else{var u=t[a];u||(u=t[a]={}),I(u,s,n)}}else void 0===n?delete t[e]:t[e]=n}}function k(t){var e={};for(var n in t)c(t,n)&&(e[n]=t[n]);return e}var _=[].concat;function A(t){return _.apply([],t)}var D="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(A([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return o[t]}).map(function(t){return o[t]});function C(t){if(!t||"object"!=typeof t)return t;var e;if(i(t)){e=[];for(var n=0,r=t.length;n<r;++n)e.push(C(t[n]))}else if(D.indexOf(t.constructor)>=0)e=t;else for(var o in e=t.constructor?Object.create(t.constructor.prototype):{},t)c(t,o)&&(e[o]=C(t[o]));return e}function N(t,e,n,i){return n=n||{},i=i||"",r(t).forEach(function(r){if(c(e,r)){var o=t[r],a=e[r];"object"==typeof o&&"object"==typeof a&&o&&a&&""+o.constructor==""+a.constructor?N(o,a,n,i+r+"."):o!==a&&(n[i+r]=e[r])}else n[i+r]=void 0}),r(e).forEach(function(r){c(t,r)||(n[i+r]=e[r])}),n}var O="undefined"!=typeof Symbol&&Symbol.iterator,x=O?function(t){var e;return null!=t&&(e=t[O])&&e.apply(t)}:function(){return null},P={};function R(t){var e,n,r,o;if(1===arguments.length){if(i(t))return t.slice();if(this===P&&"string"==typeof t)return[t];if(o=x(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==t)return[t];if("number"==typeof(e=t.length)){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var M="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function L(t,e){M=t,j=e}var j=function(){return!0},F=!new Error("").stack;function q(){if(F)try{throw q.arguments,new Error}catch(t){return t}return new Error}function B(t,e){var n=t.stack;return n?(e=e||0,0===n.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),n.split("\n").slice(e).filter(j).map(function(t){return"\n"+t}).join("")):""}var U=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],V=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(U),K={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function z(t,e){this._e=q(),this.name=t,this.message=e}function G(t,e,n,r){this._e=q(),this.failures=e,this.failedKeys=r,this.successCount=n}function W(t,e){this._e=q(),this.name="BulkError",this.failures=e,this.message=function(t,e){return t+". Errors: "+e.map(function(t){return t.toString()}).filter(function(t,e,n){return n.indexOf(t)===e}).join("\n")}(t,e)}d(z).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+B(this._e,2))}},toString:function(){return this.name+": "+this.message}}),d(G).from(z),d(W).from(z);var Q=V.reduce(function(t,e){return t[e]=e+"Error",t},{}),H=z,Y=V.reduce(function(t,e){var n=e+"Error";function r(t,r){this._e=q(),this.name=n,t?"string"==typeof t?(this.message=t,this.inner=r||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=K[e]||n,this.inner=null)}return d(r).from(H),t[e]=r,t},{});Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError;var X=U.reduce(function(t,e){return t[e+"Error"]=Y[e],t},{});var $=V.reduce(function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=Y[e]),t},{});function J(){}function Z(t){return t}function tt(t,e){return null==t||t===Z?e:function(n){return e(t(n))}}function et(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function nt(t,e){return t===J?e:function(){var n=t.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?et(r,this.onsuccess):r),i&&(this.onerror=this.onerror?et(i,this.onerror):i),void 0!==o?o:n}}function rt(t,e){return t===J?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?et(n,this.onsuccess):n),r&&(this.onerror=this.onerror?et(r,this.onerror):r)}}function it(t,e){return t===J?e:function(n){var r=t.apply(this,arguments);a(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?et(i,this.onsuccess):i),o&&(this.onerror=this.onerror?et(o,this.onerror):o),void 0===r?void 0===s?void 0:s:a(r,s)}}function ot(t,e){return t===J?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function at(t,e){return t===J?e:function(){var n=t.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}$.ModifyError=G,$.DexieError=z,$.BulkError=W;var st={},ut=100,ct=7,lt=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(e){var t=o.Promise;return t?[t.resolve(),t.prototype,t.resolve()]:[]}}(),ht=lt[0],ft=lt[1],dt=lt[2],pt=ft&&ft.then,mt=ht&&ht.constructor,yt=lt[3],gt=!!dt,vt=!1,bt=dt?function(){dt.then(Bt)}:o.setImmediate?n.bind(null,Bt):o.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){Bt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Bt,0)},wt=function(t,e){Ct.push([t,e]),St&&(bt(),St=!1)},Et=!0,St=!0,Tt=[],It=[],kt=null,_t=Z,At={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ce,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{ce(t[0],t[1])}catch(t){}})}},Dt=At,Ct=[],Nt=0,Ot=[];function xt(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=J,this._lib=!1;var e=this._PSD=Dt;if(M&&(this._stackHolder=q(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==st)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Mt(this,this._value))}this._state=null,this._value=null,++e.ref,function t(e,n){try{n(function(n){if(null===e._state){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&Ut();n&&"function"==typeof n.then?t(e,function(t,e){n instanceof xt?n._then(t,e):n.then(t,e)}):(e._state=!0,e._value=n,Lt(e)),r&&Vt()}},Mt.bind(null,e))}catch(t){Mt(e,t)}}(this,t)}var Pt={get:function(){var t=Dt,e=Xt;function n(n,r){var i=this,o=!t.global&&(t!==Dt||e!==Xt);o&&te();var a=new xt(function(e,a){jt(i,new Rt(ae(n,t,o),ae(r,t,o),e,a,t))});return M&&qt(a,this),a}return n.prototype=st,n},set:function(t){f(this,"then",t&&t.prototype===st?Pt:{get:function(){return t},set:Pt.set})}};function Rt(t,e,n,r,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r,this.psd=i}function Mt(t,e){if(It.push(e),null===t._state){var n=t._lib&&Ut();e=_t(e),t._state=!1,t._value=e,M&&null!==e&&"object"==typeof e&&!e._promise&&S(function(){var n=function t(e,n){var r;return p(e,n)||(r=s(e))&&t(r,n)}(e,"stack");e._promise=t,f(e,"stack",{get:function(){return vt?n&&(n.get?n.get.apply(e):n.value):t.stack}})}),function(t){Tt.some(function(e){return e._value===t._value})||Tt.push(t)}(t),Lt(t),n&&Vt()}}function Lt(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)jt(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),0===Nt&&(++Nt,wt(function(){0==--Nt&&Kt()},[]))}function jt(t,e){if(null!==t._state){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Nt,wt(Ft,[n,t,e])}else t._listeners.push(e)}function Ft(t,e,n){try{kt=e;var r,i=e._value;e._state?r=t(i):(It.length&&(It=[]),r=t(i),-1===It.indexOf(i)&&function(t){var e=Tt.length;for(;e;)if(Tt[--e]._value===t._value)return void Tt.splice(e,1)}(e)),n.resolve(r)}catch(t){n.reject(t)}finally{kt=null,0==--Nt&&Kt(),--n.psd.ref||n.psd.finalize()}}function qt(t,e){var n=e?e._numPrev+1:0;n<ut&&(t._prev=e,t._numPrev=n)}function Bt(){Ut()&&Vt()}function Ut(){var t=Et;return Et=!1,St=!1,t}function Vt(){var t,e,n;do{for(;Ct.length>0;)for(t=Ct,Ct=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}}while(Ct.length>0);Et=!0,St=!0}function Kt(){var t=Tt;Tt=[],t.forEach(function(t){t._PSD.onunhandled.call(null,t._value,t)});for(var e=Ot.slice(0),n=e.length;n;)e[--n]()}function zt(t){return new xt(st,!1,t)}function Gt(t,e){var n=Dt;return function(){var r=Ut(),i=Dt;try{return re(n,!0),t.apply(this,arguments)}catch(t){e&&e(t)}finally{re(i,!1),r&&Vt()}}}l(xt.prototype,{then:Pt,_then:function(t,e){jt(this,new Rt(null,null,t,e,Dt))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],n=arguments[1];return"function"==typeof e?this.then(null,function(t){return t instanceof e?n(t):zt(t)}):this.then(null,function(t){return t&&t.name===e?n(t):zt(t)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),zt(e)})},stack:{get:function(){if(this._stack)return this._stack;try{vt=!0;var t=function t(e,n,r){if(n.length===r)return n;var i="";if(!1===e._state){var o,a,s=e._value;null!=s?(o=s.name||"Error",a=s.message||s,i=B(s,0)):(o=s,a=""),n.push(o+(a?": "+a:"")+i)}M&&((i=B(e._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),e._prev&&t(e._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{vt=!1}}},timeout:function(t,e){var n=this;return t<1/0?new xt(function(r,i){var o=setTimeout(function(){return i(new Y.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&f(xt.prototype,Symbol.toStringTag,"Promise"),At.env=ie(),l(xt,{all:function(){var t=R.apply(null,arguments).map(ee);return new xt(function(e,n){0===t.length&&e([]);var r=t.length;t.forEach(function(i,o){return xt.resolve(i).then(function(n){t[o]=n,--r||e(t)},n)})})},resolve:function(t){if(t instanceof xt)return t;if(t&&"function"==typeof t.then)return new xt(function(e,n){t.then(e,n)});var e=new xt(st,!0,t);return qt(e,kt),e},reject:zt,race:function(){var t=R.apply(null,arguments).map(ee);return new xt(function(e,n){t.map(function(t){return xt.resolve(t).then(e,n)})})},PSD:{get:function(){return Dt},set:function(t){return Dt=t}},newPSD:Jt,usePSD:oe,scheduler:{get:function(){return wt},set:function(t){wt=t}},rejectionMapper:{get:function(){return _t},set:function(t){_t=t}},follow:function(t,e){return new xt(function(n,r){return Jt(function(e,n){var r=Dt;r.unhandleds=[],r.onunhandled=n,r.finalize=et(function(){var t=this;!function(t){Ot.push(function e(){t();Ot.splice(Ot.indexOf(e),1)}),++Nt,wt(function(){0==--Nt&&Kt()},[])}(function(){0===t.unhandleds.length?e():n(t.unhandleds[0])})},r.finalize),t()},e,n,r)})}});var Wt={awaits:0,echoes:0,id:0},Qt=0,Ht=[],Yt=0,Xt=0,$t=0;function Jt(t,e,n,r){var i=Dt,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++$t;var s=At.env;o.env=gt?{Promise:xt,PromiseProp:{value:xt,configurable:!0,writable:!0},all:xt.all,race:xt.race,resolve:xt.resolve,reject:xt.reject,nthen:se(s.nthen,o),gthen:se(s.gthen,o)}:{},e&&a(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=oe(o,t,n,r);return 0===o.ref&&o.finalize(),u}function Zt(){return Wt.id||(Wt.id=++Qt),++Wt.awaits,Wt.echoes+=ct,Wt.id}function te(t){!Wt.awaits||t&&t!==Wt.id||(0==--Wt.awaits&&(Wt.id=0),Wt.echoes=Wt.awaits*ct)}function ee(t){return Wt.echoes&&t&&t.constructor===mt?(Zt(),t.then(function(t){return te(),t},function(t){return te(),le(t)})):t}function ne(){var t=Ht[Ht.length-1];Ht.pop(),re(t,!1)}function re(t,e){var n,r=Dt;if((e?!Wt.echoes||Yt++&&t===Dt:!Yt||--Yt&&t===Dt)||(n=e?function(t){++Xt,Wt.echoes&&0!=--Wt.echoes||(Wt.echoes=Wt.id=0),Ht.push(Dt),re(t,!0)}.bind(null,t):ne,pt.call(ht,n)),t!==Dt&&(Dt=t,r===At&&(At.env=ie()),gt)){var i=At.env.Promise,a=t.env;ft.then=a.nthen,i.prototype.then=a.gthen,(r.global||t.global)&&(Object.defineProperty(o,"Promise",a.PromiseProp),i.all=a.all,i.race=a.race,i.resolve=a.resolve,i.reject=a.reject)}}function ie(){var t=o.Promise;return gt?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:t.all,race:t.race,resolve:t.resolve,reject:t.reject,nthen:ft.then,gthen:t.prototype.then}:{}}function oe(t,e,n,r,i){var o=Dt;try{return re(t,!0),e(n,r,i)}finally{re(o,!1)}}function ae(t,e,n){return"function"!=typeof t?t:function(){var r=Dt;n&&Zt(),re(e,!0);try{return t.apply(this,arguments)}finally{re(r,!1)}}}function se(t,e){return function(n,r){return t.call(this,ae(n,e,!1),ae(r,e,!1))}}var ue="unhandledrejection";function ce(t,e){var n;try{n=e.onuncatched(t)}catch(t){}if(!1!==n)try{var r,i={promise:e,reason:t};if(o.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ue,!0,!0),a(r,i)):o.CustomEvent&&a(r=new CustomEvent(ue,{detail:i}),i),r&&o.dispatchEvent&&(dispatchEvent(r),!o.PromiseRejectionEvent&&o.onunhandledrejection))try{o.onunhandledrejection(r)}catch(t){}r.defaultPrevented||console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var le=xt.reject;function he(t){var e={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return e[n].subscribe.apply(null,o),t}if("string"==typeof n)return e[n]};n.addEventType=s;for(var o=1,a=arguments.length;o<a;++o)s(arguments[o]);return n;function s(t,o,a){if("object"!=typeof t){var u;o||(o=ot),a||(a=J);var c={subscribers:[],fire:a,subscribe:function(t){-1===c.subscribers.indexOf(t)&&(c.subscribers.push(t),c.fire=o(c.fire,t))},unsubscribe:function(t){c.subscribers=c.subscribers.filter(function(e){return e!==t}),c.fire=c.subscribers.reduce(o,a)}};return e[t]=n[t]=c,c}r(u=t).forEach(function(t){var e=u[t];if(i(e))s(t,u[t][0],u[t][1]);else{if("asap"!==e)throw new Y.InvalidArgument("Invalid event config");var n=s(t,Z,function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];n.subscribers.forEach(function(t){b(function(){t.apply(null,e)})})})}})}}var fe,de=String.fromCharCode(65535),pe=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(t){return de}}(),me=-1/0,ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ge="String expected.",ve=[],be="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),we=be,Ee=be,Se=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function Te(t,e){var n,s,u,h,d,p=Te.dependencies,m=a({addons:Te.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange},e),b=m.addons,_=m.autoOpen,D=m.indexedDB,O=m.IDBKeyRange,x=this._dbSchema={},L=[],j=[],F={},U=null,V=null,K=!1,z=null,Q=!1,H="readwrite",X=this,$=new xt(function(t){n=t}),et=new xt(function(t,e){s=e}),ot=!0,st=!!Re(D);function ut(t){this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function ct(t,e,n){var i=X._createTransaction(H,j,x);i.create(e),i._completion.catch(n);var o=i._reject.bind(i);Jt(function(){Dt.trans=i,0===t?(r(x).forEach(function(t){lt(e,t,x[t].primKey,x[t].indexes)}),xt.follow(function(){return X.on.populate.fire(i)}).catch(o)):function(t,e,n){var i=[],o=L.filter(function(e){return e._cfg.version===t})[0];if(!o)throw new Y.Upgrade("Dexie specification of currently installed DB version is missing");x=X._dbSchema=o._cfg.dbschema;var a=!1;return L.filter(function(e){return e._cfg.version>t}).forEach(function(t){i.push(function(){var r=x,i=t._cfg.dbschema;Rt(r,n),Rt(i,n),x=X._dbSchema=i;var o=function(t,e){var n={del:[],add:[],change:[]};for(var r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(i){var a={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)a.recreate=!0,n.change.push(a);else{var s=i.idxByName,u=o.idxByName;for(var c in s)u[c]||a.del.push(c);for(c in u){var l=s[c],h=u[c];l?l.src!==h.src&&a.change.push(h):a.add.push(h)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([r,o])}return n}(r,i);if(o.add.forEach(function(t){lt(n,t[0],t[1].primKey,t[1].indexes)}),o.change.forEach(function(t){if(t.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var e=n.objectStore(t.name);t.add.forEach(function(t){ht(e,t)}),t.change.forEach(function(t){e.deleteIndex(t.name),ht(e,t)}),t.del.forEach(function(t){e.deleteIndex(t)})}),t._cfg.contentUpgrade)return a=!0,xt.follow(function(){t._cfg.contentUpgrade(e)})}),i.push(function(e){a&&we||function(t,e){for(var n=0;n<e.db.objectStoreNames.length;++n){var r=e.db.objectStoreNames[n];null==t[r]&&e.db.deleteObjectStore(r)}}(t._cfg.dbschema,e)})}),function t(){return i.length?xt.resolve(i.shift()(e.idbtrans)).then(t):xt.resolve()}().then(function(){!function(t,e){r(t).forEach(function(n){e.db.objectStoreNames.contains(n)||lt(e,n,t[n].primKey,t[n].indexes)})}(x,n)})}(t,i,e).catch(o)})}function lt(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(t){ht(i,t)}),i}function ht(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ft(t,e,n){var r=arguments.length;if(r<2)throw new Y.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[t,A(i),n]}function dt(t,e,n){this.name=t,this.schema=e,this._tx=n,this.hook=F[t]?F[t].hook:he(null,{creating:[nt,J],reading:[tt,Z],updating:[it,J],deleting:[rt,J]})}function pt(t,e,n){return(n?De:_e)(function(n){t.push(n),e&&e()})}function gt(t,e,n,r,i){return new xt(function(o,a){var s=n.length,u=s-1;if(0===s)return o();if(r){var c,l=De(a),h=ke(null);S(function(){for(var r=0;r<s;++r){c={onsuccess:null,onerror:null};var a=n[r];i.call(c,a[0],a[1],e);var f=t.delete(a[0]);f._hookCtx=c,f.onerror=l,f.onsuccess=r===u?ke(o):h}},function(t){throw c.onerror&&c.onerror(t),t})}else for(var f=0;f<s;++f){var d=t.delete(n[f]);d.onerror=_e(a),f===u&&(d.onsuccess=Gt(function(){return o()}))}})}function vt(t,e,n,r){var i=this;this.db=X,this.mode=t,this.storeNames=e,this.idbtrans=null,this.on=he(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new xt(function(t,e){i._resolve=t,i._reject=e}),this._completion.then(function(){i.active=!1,i.on.complete.fire()},function(t){var e=i.active;return i.active=!1,i.on.error.fire(t),i.parent?i.parent._reject(t):e&&i.idbtrans&&i.idbtrans.abort(),le(t)})}function bt(t,e,n){this._ctx={table:t,index:":id"===e?null:e,or:n}}function wt(t,e){var n=null,r=null;if(e)try{n=e()}catch(t){r=t}var i=t._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o.hook.reading.fire}}function Et(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function St(t,e){return t._cfg.version-e._cfg.version}function Tt(t,e,n){e.forEach(function(e){var r=n[e];t.forEach(function(t){e in t||(t===vt.prototype||t instanceof vt?f(t,e,{get:function(){return this.table(e)}}):t[e]=new dt(e,r))})})}function It(t,e,n,r,i,o){var a=Gt(o?function(t,e,r){return n(o(t),e,r)}:n,i);t.onerror||(t.onerror=_e(i)),t.onsuccess=E(e?function(){var n=t.result;if(n){var o=function(){n.continue()};e(n,function(t){o=t},r,i)&&a(n.value,n,function(t){o=t}),o()}else r()}:function(){var e=t.result;if(e){var n=function(){e.continue()};a(e.value,e,function(t){n=t}),n()}else r()},i)}function kt(t,e){return D.cmp(t,e)}function _t(t,e){return kt(t,e)>0?t:e}function At(t,e){return D.cmp(t,e)}function Ct(t,e){return D.cmp(e,t)}function Nt(t,e){return t<e?-1:t===e?0:1}function Ot(t,e){return t>e?-1:t===e?0:1}function Pt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}function Rt(t,e){for(var n=e.db.objectStoreNames,r=0;r<n.length;++r){var i=n[r],a=e.objectStore(i);u="getAll"in a;for(var s=0;s<a.indexNames.length;++s){var c=a.indexNames[s],l=a.index(c).keyPath,h="string"==typeof l?l:"["+y(l).join("+")+"]";if(t[i]){var f=t[i].idxByName[h];f&&(f.name=c)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(u=!1)}function Mt(t){X.on("blocked").fire(t),ve.filter(function(t){return t.name===X.name&&t!==X&&!t._vcFired}).map(function(e){return e.on("versionchange").fire(t)})}this.version=function(t){if(U||K)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=L.filter(function(e){return e._cfg.version===t})[0];return e||(e=new ut(t),L.push(e),L.sort(St),ot=!1,e)},a(ut.prototype,{stores:function(t){this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,t):t;var e={};L.forEach(function(t){a(e,t._cfg.storesSource)});var n=this._cfg.dbschema={};return this._parseStoresSpec(e,n),x=X._dbSchema=n,[F,X,vt.prototype].forEach(function(t){for(var e in t)t[e]instanceof dt&&delete t[e]}),Tt([F,X,vt.prototype,this._cfg.tables],r(n),n),j=r(n),this},upgrade:function(t){return this._cfg.contentUpgrade=t,this},_parseStoresSpec:function(t,e){r(t).forEach(function(n){if(null!==t[n]){var r={},o=function(t){var e=[];return t.split(",").forEach(function(t){var n=(t=t.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;e.push(new Oe(n,r||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),i(r),/\./.test(t)))}),e}(t[n]),a=o.shift();if(a.multi)throw new Y.Schema("Primary key cannot be multi-valued");a.keyPath&&I(r,a.keyPath,a.auto?0:a.keyPath),o.forEach(function(t){if(t.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string");I(r,t.keyPath,t.compound?t.keyPath.map(function(){return""}):"")}),e[n]=new xe(n,a,o,r)}})}}),this._allTables=F,this._createTransaction=function(t,e,n,r){return new vt(t,e,n,r)},this._whenReady=function(t){return Q||Dt.letThrough?t():new xt(function(t,e){if(!K){if(!_)return void e(new Y.DatabaseClosed);X.open().catch(J)}$.then(t,e)}).then(t)},this.verno=0,this.open=function(){if(K||U)return $.then(function(){return V?le(V):X});M&&(et._stackHolder=q()),K=!0,V=null,Q=!1;var e=n,i=null;return xt.race([et,new xt(function(e,n){if(!D)throw new Y.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var o=ot?D.open(t):D.open(t,Math.round(10*X.verno));if(!o)throw new Y.MissingAPI("IndexedDB API not available");o.onerror=_e(n),o.onblocked=Gt(Mt),o.onupgradeneeded=Gt(function(e){if(i=o.transaction,ot&&!X._allowEmptyDB){o.onerror=Ce,i.abort(),o.result.close();var r=D.deleteDatabase(t);r.onsuccess=r.onerror=Gt(function(){n(new Y.NoSuchDatabase("Database "+t+" doesnt exist"))})}else{i.onerror=_e(n),ct((e.oldVersion>Math.pow(2,62)?0:e.oldVersion)/10,i,n)}},n),o.onsuccess=Gt(function(){if(i=null,U=o.result,ve.push(X),ot)!function(){if(X.verno=U.version/10,X._dbSchema=x={},0===(j=y(U.objectStoreNames,0)).length)return;var t=U.transaction(Pe(j),"readonly");j.forEach(function(e){for(var n=t.objectStore(e),r=n.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf("."),o=new Oe(r,r||"",!1,!1,!!n.autoIncrement,r&&"string"!=typeof r,i),a=[],s=0;s<n.indexNames.length;++s){var u=n.index(n.indexNames[s]);r=u.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf(".");var c=new Oe(u.name,r,!!u.unique,!!u.multiEntry,!1,r&&"string"!=typeof r,i);a.push(c)}x[e]=new xe(e,o,a,{})}),Tt([F],r(x),x)}();else if(U.objectStoreNames.length>0)try{Rt(x,U.transaction(Pe(U.objectStoreNames),"readonly"))}catch(t){}U.onversionchange=Gt(function(t){X._vcFired=!0,X.on("versionchange").fire(t)}),st||"__dbnames"===t||fe.dbnames.put({name:t}).catch(J),e()},n)})]).then(function(){return z=[],xt.resolve(Te.vip(X.on.ready.fire)).then(function t(){if(z.length>0){var e=z.reduce(at,J);return z=[],xt.resolve(Te.vip(e)).then(t)}})}).finally(function(){z=null}).then(function(){return K=!1,X}).catch(function(t){try{i&&i.abort()}catch(t){}return K=!1,X.close(),le(V=t)}).finally(function(){Q=!0,e()})},this.close=function(){var t=ve.indexOf(X);if(t>=0&&ve.splice(t,1),U){try{U.close()}catch(t){}U=null}_=!1,V=new Y.DatabaseClosed,K&&s(V),$=new xt(function(t){n=t}),et=new xt(function(t,e){s=e})},this.delete=function(){var e=arguments.length>0;return new xt(function(n,r){if(e)throw new Y.InvalidArgument("Arguments not allowed in db.delete()");function i(){X.close();var e=D.deleteDatabase(t);e.onsuccess=Gt(function(){st||fe.dbnames.delete(t).catch(J),n()}),e.onerror=_e(r),e.onblocked=Mt}K?$.then(i):i()})},this.backendDB=function(){return U},this.isOpen=function(){return null!==U},this.hasBeenClosed=function(){return V&&V instanceof Y.DatabaseClosed},this.hasFailed=function(){return null!==V},this.dynamicallyOpened=function(){return ot},this.name=t,l(this,{tables:{get:function(){return r(F).map(function(t){return F[t]})}}}),this.on=he(this,"populate","blocked","versionchange",{ready:[at,J]}),this.on.ready.subscribe=g(this.on.ready.subscribe,function(t){return function(e,n){Te.vip(function(){Q?(V||xt.resolve().then(e),n&&t(e)):z?(z.push(e),n&&t(e)):(t(e),n||t(function t(){X.on.ready.unsubscribe(e),X.on.ready.unsubscribe(t)}))})}}),this.transaction=function(){var t=ft.apply(this,arguments);return this._transaction.apply(this,t)},this._transaction=function(t,e,n){var r=Dt.trans;r&&r.db===X&&-1===t.indexOf("!")||(r=null);var i=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{var o=e.map(function(t){var e=t instanceof dt?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e});if("r"==t||"readonly"==t)t="readonly";else{if("rw"!=t&&t!=H)throw new Y.InvalidArgument("Invalid transaction mode: "+t);t=H}if(r){if("readonly"===r.mode&&t===H){if(!i)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach(function(t){if(r&&-1===r.storeNames.indexOf(t)){if(!i)throw new Y.SubTransaction("Table "+t+" not included in parent transaction.");r=null}}),i&&r&&!r.active&&(r=null)}}catch(t){return r?r._promise(null,function(e,n){n(t)}):le(t)}return r?r._promise(t,a,"lock"):Dt.trans?oe(Dt.transless,function(){return X._whenReady(a)}):X._whenReady(a);function a(){return xt.resolve().then(function(){var e,i=Dt.transless||Dt,a=X._createTransaction(t,o,x,r),s={trans:a,transless:i};r?a.idbtrans=r.idbtrans:a.create(),n.constructor===yt&&Zt();var u=xt.follow(function(){if(e=n.call(a,a))if(e.constructor===mt){var t=te.bind(null,null);e.then(t,t)}else"function"==typeof e.next&&"function"==typeof e.throw&&(e=Ne(e))},s);return(e&&"function"==typeof e.then?xt.resolve(e).then(function(t){return a.active?t:le(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):u.then(function(){return e})).then(function(t){return r&&a._resolve(),a._completion.then(function(){return t})}).catch(function(t){return a._reject(t),le(t)})})}},this.table=function(t){if(!c(F,t))throw new Y.InvalidTable("Table "+t+" does not exist");return F[t]},l(dt.prototype,{_trans:function(t,e,n){var r=this._tx||Dt.trans;return r&&r.db===X?r===Dt.trans?r._promise(t,e,n):Jt(function(){return r._promise(t,e,n)},{trans:r,transless:Dt.transless||Dt}):function t(e,n,r){if(Q||Dt.letThrough){var i=X._createTransaction(e,n,x);try{i.create()}catch(t){return le(t)}return i._promise(e,function(t,e){return Jt(function(){return Dt.trans=i,r(t,e,i)})}).then(function(t){return i._completion.then(function(){return t})})}if(!K){if(!_)return le(new Y.DatabaseClosed);X.open().catch(J)}return $.then(function(){return t(e,n,r)})}(t,[this.name],e)},_idbstore:function(t,e,n){var r=this.name;return this._trans(t,function(t,n,i){if(-1===i.storeNames.indexOf(r))throw new Y.NotFound("Table"+r+" not part of transaction");return e(t,n,i.idbtrans.objectStore(r),i)},n)},get:function(t,e){if(t&&t.constructor===Object)return this.where(t).first(e);var n=this;return this._idbstore("readonly",function(e,r,i){var o=i.get(t);o.onerror=_e(r),o.onsuccess=Gt(function(){e(n.hook.reading.fire(o.result))},r)}).then(e)},where:function(t){if("string"==typeof t)return new bt(this,t);if(i(t))return new bt(this,"["+t.join("+")+"]");var e=r(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(t){return t.compound&&e.every(function(e){return t.keyPath.indexOf(e)>=0})&&t.keyPath.every(function(t){return e.indexOf(t)>=0})})[0];if(n&&pe!==de)return this.where(n.name).equals(n.keyPath.map(function(e){return t[e]}));n||console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+e.join("+")+"]");var o=this.schema.idxByName,a=e.reduce(function(e,n){return[e[0]||o[n],e[0]||!o[n]?Pt(e[1],function(e){return""+T(e,n)==""+t[n]}):e[1]]},[null,null]),s=a[0];return s?this.where(s.name).equals(t[s.keyPath]).filter(a[1]):n?this.filter(a[1]):this.where(e).equals("")},count:function(t){return this.toCollection().count(t)},offset:function(t){return this.toCollection().offset(t)},limit:function(t){return this.toCollection().limit(t)},reverse:function(){return this.toCollection().reverse()},filter:function(t){return this.toCollection().and(t)},each:function(t){return this.toCollection().each(t)},toArray:function(t){return this.toCollection().toArray(t)},orderBy:function(t){return new wt(new bt(this,i(t)?"["+t.join("+")+"]":t))},toCollection:function(){return new wt(new bt(this))},mapToClass:function(t,e){this.schema.mappedClass=t;var n=Object.create(t.prototype);e&&Ie(n,e),this.schema.instanceTemplate=n;var r=function(e){if(!e)return e;var n=Object.create(t.prototype);for(var r in e)if(c(e,r))try{n[r]=e[r]}catch(t){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t},defineClass:function(t){return this.mapToClass(Te.defineClass(t),t)},bulkDelete:function(t){return this.hook.deleting.fire===J?this._idbstore(H,function(e,n,r,i){e(gt(r,i,t,!1,J))}):this.where(":id").anyOf(t).delete().then(function(){})},bulkPut:function(t,e){var n=this;return this._idbstore(H,function(r,i,o){if(!o.keyPath&&!n.schema.primKey.auto&&!e)throw new Y.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(o.keyPath&&e)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(e&&e.length!==t.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return r();var a,s,u=function(t){0===c.length?r(t):i(new W(n.name+".bulkPut(): "+c.length+" of "+l+" operations failed",c))},c=[],l=t.length,h=n;if(n.hook.creating.fire===J&&n.hook.updating.fire===J){s=pt(c);for(var f=0,d=t.length;f<d;++f)(a=e?o.put(t[f],e[f]):o.put(t[f])).onerror=s;a.onerror=pt(c,u),a.onsuccess=Ae(u)}else{var p=e||o.keyPath&&t.map(function(t){return T(t,o.keyPath)}),m=p&&w(p,function(e,n){return null!=e&&[e,t[n]]});(p?h.where(":id").anyOf(p.filter(function(t){return null!=t})).modify(function(){this.value=m[this.primKey],m[this.primKey]=null}).catch(G,function(t){c=t.failures}).then(function(){for(var n=[],r=e&&[],i=p.length-1;i>=0;--i){var o=p[i];(null==o||m[o])&&(n.push(t[i]),e&&r.push(o),null!=o&&(m[o]=null))}return n.reverse(),e&&r.reverse(),h.bulkAdd(n,r)}).then(function(t){var e=p[p.length-1];return null!=e?e:t}):h.bulkAdd(t)).then(u).catch(W,function(t){c=c.concat(t.failures),u()}).catch(i)}},"locked")},bulkAdd:function(t,e){var n=this,r=this.hook.creating.fire;return this._idbstore(H,function(i,o,a,s){if(!a.keyPath&&!n.schema.primKey.auto&&!e)throw new Y.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(a.keyPath&&e)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(e&&e.length!==t.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return i();function u(t){0===f.length?i(t):o(new W(n.name+".bulkAdd(): "+f.length+" of "+d+" operations failed",f))}var c,l,h,f=[],d=t.length;if(r!==J){var p,m=a.keyPath;l=pt(f,null,!0),h=ke(null),S(function(){for(var n=0,i=t.length;n<i;++n){p={onerror:null,onsuccess:null};var o=e&&e[n],u=t[n],f=e?o:m?T(u,m):void 0,d=r.call(p,f,u,s);null==f&&null!=d&&(m?I(u=C(u),m,d):o=d),(c=null!=o?a.add(u,o):a.add(u))._hookCtx=p,n<i-1&&(c.onerror=l,p.onsuccess&&(c.onsuccess=h))}},function(t){throw p.onerror&&p.onerror(t),t}),c.onerror=pt(f,u,!0),c.onsuccess=ke(u)}else{l=pt(f);for(var y=0,g=t.length;y<g;++y)(c=e?a.add(t[y],e[y]):a.add(t[y])).onerror=l;c.onerror=pt(f,u),c.onsuccess=Ae(u)}})},add:function(t,e){var n=this.hook.creating.fire;return this._idbstore(H,function(r,i,o,a){var s={onsuccess:null,onerror:null};if(n!==J){var u=null!=e?e:o.keyPath?T(t,o.keyPath):void 0,c=n.call(s,u,t,a);null==u&&null!=c&&(o.keyPath?I(t,o.keyPath,c):e=c)}try{var l=null!=e?o.add(t,e):o.add(t);l._hookCtx=s,l.onerror=De(i),l.onsuccess=ke(function(e){var n=o.keyPath;n&&I(t,n,e),r(e)})}catch(t){throw s.onerror&&s.onerror(t),t}})},put:function(t,e){var n=this,r=this.hook.creating.fire,i=this.hook.updating.fire;if(r!==J||i!==J){var o=this.schema.primKey.keyPath,a=void 0!==e?e:o&&T(t,o);return null==a?this.add(t):(t=C(t),this._trans(H,function(){return n.where(":id").equals(a).modify(function(){this.value=t}).then(function(r){return 0===r?n.add(t,e):a})},"locked"))}return this._idbstore(H,function(n,r,i){var o=void 0!==e?i.put(t,e):i.put(t);o.onerror=_e(r),o.onsuccess=Gt(function(e){var r=i.keyPath;r&&I(t,r,e.target.result),n(o.result)})})},delete:function(t){return this.hook.deleting.subscribers.length?this.where(":id").equals(t).delete():this._idbstore(H,function(e,n,r){var i=r.delete(t);i.onerror=_e(n),i.onsuccess=Gt(function(){e(i.result)})})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(H,function(t,e,n){var r=n.clear();r.onerror=_e(e),r.onsuccess=Gt(function(){t(r.result)})})},update:function(t,e){if("object"!=typeof e||i(e))throw new Y.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||i(t))return this.where(":id").equals(t).modify(e);r(e).forEach(function(n){I(t,n,e[n])});var n=T(t,this.schema.primKey.keyPath);return void 0===n?le(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(e)}}),l(vt.prototype,{_lock:function(){return v(!Dt.global),++this._reculock,1!==this._reculock||Dt.global||(Dt.lockOwnerFor=this),this},_unlock:function(){if(v(!Dt.global),0==--this._reculock)for(Dt.global||(Dt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{oe(t[1],t[0])}catch(t){}}return this},_locked:function(){return this._reculock&&Dt.lockOwnerFor!==this},create:function(t){var e=this;if(!this.mode)return this;if(v(!this.idbtrans),!t&&!U)switch(V&&V.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(V);case"MissingAPIError":throw new Y.MissingAPI(V.message,V);default:throw new Y.OpenFailed(V)}if(!this.active)throw new Y.TransactionInactive;return v(null===this._completion._state),(t=this.idbtrans=t||U.transaction(Pe(this.storeNames),this.mode)).onerror=Gt(function(n){Ce(n),e._reject(t.error)}),t.onabort=Gt(function(n){Ce(n),e.active&&e._reject(new Y.Abort(t.error)),e.active=!1,e.on("abort").fire(n)}),t.oncomplete=Gt(function(){e.active=!1,e._resolve()}),this},_promise:function(t,e,n){var r=this;if(t===H&&this.mode!==H)return le(new Y.ReadOnly("Transaction is readonly"));if(!this.active)return le(new Y.TransactionInactive);if(this._locked())return new xt(function(i,o){r._blockedFuncs.push([function(){r._promise(t,e,n).then(i,o)},Dt])});if(n)return Jt(function(){var t=new xt(function(t,n){r._lock();var i=e(t,n,r);i&&i.then&&i.then(t,n)});return t.finally(function(){return r._unlock()}),t._lib=!0,t});var i=new xt(function(t,n){var i=e(t,n,r);i&&i.then&&i.then(t,n)});return i._lib=!0,i},_root:function(){return this.parent?this.parent._root():this},waitFor:function(t){var e=this._root();if(t=xt.resolve(t),e._waitingFor)e._waitingFor=e._waitingFor.then(function(){return t});else{e._waitingFor=t,e._waitingQueue=[];var n=e.idbtrans.objectStore(e.storeNames[0]);!function t(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(n.get(-1/0).onsuccess=t)}()}var r=e._waitingFor;return new xt(function(n,i){t.then(function(t){return e._waitingQueue.push(Gt(n.bind(null,t)))},function(t){return e._waitingQueue.push(Gt(i.bind(null,t)))}).finally(function(){e._waitingFor===r&&(e._waitingFor=null)})})},abort:function(){this.active&&this._reject(new Y.Abort),this.active=!1},tables:{get:(h="Transaction.tables",d=function(){return F},function(){return console.warn(h+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+B(q(),1)),d.apply(this,arguments)})},table:function(t){return new dt(t,X.table(t).schema,this)}}),l(bt.prototype,function(){function t(t,e,n){var r=t instanceof bt?new wt(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function e(t){return new wt(t,function(){return O.only("")}).limit(0)}function n(t,e,n,r,i,o){for(var a=Math.min(t.length,r.length),s=-1,u=0;u<a;++u){var c=e[u];if(c!==r[u])return i(t[u],n[u])<0?t.substr(0,u)+n[u]+n.substr(u+1):i(t[u],r[u])<0?t.substr(0,u)+r[u]+n.substr(u+1):s>=0?t.substr(0,s)+e[s]+n.substr(s+1):null;i(t[u],c)<0&&(s=u)}return a<r.length&&"next"===o?t+n.substr(t.length):a<t.length&&"prev"===o?t.substr(0,n.length):s<0?null:t.substr(0,s)+r[s]+n.substr(s+1)}function r(e,r,i,o){var a,s,u,c,l,h,f,d=i.length;if(!i.every(function(t){return"string"==typeof t}))return t(e,ge);function p(t){a=function(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}(t),s=function(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}(t),u="next"===t?Nt:Ot;var e=i.map(function(t){return{lower:s(t),upper:a(t)}}).sort(function(t,e){return u(t.lower,e.lower)});c=e.map(function(t){return t.upper}),l=e.map(function(t){return t.lower}),h=t,f="next"===t?"":o}p("next");var m=new wt(e,function(){return O.bound(c[0],l[d-1]+o)});m._ondirectionchange=function(t){p(t)};var y=0;return m._addAlgorithm(function(t,e,i){var o=t.key;if("string"!=typeof o)return!1;var a=s(o);if(r(a,l,y))return!0;for(var p=null,m=y;m<d;++m){var g=n(o,a,c[m],l[m],u,h);null===g&&null===p?y=m+1:(null===p||u(p,g)>0)&&(p=g)}return e(null!==p?function(){t.continue(p+f)}:i),!1}),m}return{between:function(n,r,i,o){i=!1!==i,o=!0===o;try{return kt(n,r)>0||0===kt(n,r)&&(i||o)&&(!i||!o)?e(this):new wt(this,function(){return O.bound(n,r,!i,!o)})}catch(e){return t(this,ye)}},equals:function(t){return new wt(this,function(){return O.only(t)})},above:function(t){return new wt(this,function(){return O.lowerBound(t,!0)})},aboveOrEqual:function(t){return new wt(this,function(){return O.lowerBound(t)})},below:function(t){return new wt(this,function(){return O.upperBound(t,!0)})},belowOrEqual:function(t){return new wt(this,function(){return O.upperBound(t)})},startsWith:function(e){return"string"!=typeof e?t(this,ge):this.between(e,e+de,!0,!0)},startsWithIgnoreCase:function(t){return""===t?this.startsWith(t):r(this,function(t,e){return 0===t.indexOf(e[0])},[t],de)},equalsIgnoreCase:function(t){return r(this,function(t,e){return t===e[0]},[t],"")},anyOfIgnoreCase:function(){var t=R.apply(P,arguments);return 0===t.length?e(this):r(this,function(t,e){return-1!==e.indexOf(t)},t,"")},startsWithAnyOfIgnoreCase:function(){var t=R.apply(P,arguments);return 0===t.length?e(this):r(this,function(t,e){return e.some(function(e){return 0===t.indexOf(e)})},t,de)},anyOf:function(){var n=R.apply(P,arguments),r=At;try{n.sort(r)}catch(e){return t(this,ye)}if(0===n.length)return e(this);var i=new wt(this,function(){return O.bound(n[0],n[n.length-1])});i._ondirectionchange=function(t){r="next"===t?At:Ct,n.sort(r)};var o=0;return i._addAlgorithm(function(t,e,i){for(var a=t.key;r(a,n[o])>0;)if(++o===n.length)return e(i),!1;return 0===r(a,n[o])||(e(function(){t.continue(n[o])}),!1)}),i},notEqual:function(t){return this.inAnyRange([[me,t],[t,pe]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var e=R.apply(P,arguments);if(0===e.length)return new wt(this);try{e.sort(At)}catch(e){return t(this,ye)}var n=e.reduce(function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[me,e]]},null);return n.push([e[e.length-1],pe]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,r){if(0===n.length)return e(this);if(!n.every(function(t){return void 0!==t[0]&&void 0!==t[1]&&At(t[0],t[1])<=0}))return t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var i=!r||!1!==r.includeLowers,o=r&&!0===r.includeUppers;var a,s=At;function u(t,e){return s(t[0],e[0])}try{(a=n.reduce(function(t,e){for(var n=0,r=t.length;n<r;++n){var i=t[n];if(kt(e[0],i[1])<0&&kt(e[1],i[0])>0){i[0]=(o=i[0],a=e[0],kt(o,a)<0?o:a),i[1]=_t(i[1],e[1]);break}}var o,a;return n===r&&t.push(e),t},[])).sort(u)}catch(e){return t(this,ye)}var c=0,l=o?function(t){return At(t,a[c][1])>0}:function(t){return At(t,a[c][1])>=0},h=i?function(t){return Ct(t,a[c][0])>0}:function(t){return Ct(t,a[c][0])>=0};var f=l,d=new wt(this,function(){return O.bound(a[0][0],a[a.length-1][1],!i,!o)});return d._ondirectionchange=function(t){"next"===t?(f=l,s=At):(f=h,s=Ct),a.sort(u)},d._addAlgorithm(function(t,e,n){for(var r=t.key;f(r);)if(++c===a.length)return e(n),!1;return!!function(t){return!l(t)&&!h(t)}(r)||0!==kt(r,a[c][1])&&0!==kt(r,a[c][0])&&(e(function(){s===At?t.continue(a[c][0]):t.continue(a[c][1])}),!1)}),d},startsWithAnyOf:function(){var n=R.apply(P,arguments);return n.every(function(t){return"string"==typeof t})?0===n.length?e(this):this.inAnyRange(n.map(function(t){return[t,t+de]})):t(this,"startsWithAnyOf() only works with strings")}}}),l(wt.prototype,function(){function t(t,e){t.filter=Pt(t.filter,e)}function e(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Pt(r(),e())}:e,t.justLimit=n&&!r}function n(t,e){if(t.isPrimKey)return e;var n=t.table.schema.idxByName[t.index];if(!n)throw new Y.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return e.index(n.name)}function i(t,e){var r=n(t,e);return t.keysOnly&&"openKeyCursor"in r?r.openKeyCursor(t.range||null,t.dir+t.unique):r.openCursor(t.range||null,t.dir+t.unique)}function o(t,e,n,r,o){var a=t.replayFilter?Pt(t.filter,t.replayFilter()):t.filter;t.or?function(){var s={},u=0;function l(){2==++u&&n()}function h(t,n,i){if(!a||a(n,i,l,r)){var o=n.primaryKey,u=""+o;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(o)),c(s,u)||(s[u]=!0,e(t,n,i))}}t.or._iterate(h,l,r,o),It(i(t,o),t.algorithm,h,l,r,!t.keysOnly&&t.valueMapper)}():It(i(t,o),Pt(t.algorithm,a),e,n,r,!t.keysOnly&&t.valueMapper)}return{_read:function(t,e){var n=this._ctx;return n.error?n.table._trans(null,le.bind(null,n.error)):n.table._idbstore("readonly",t).then(e)},_write:function(t){var e=this._ctx;return e.error?e.table._trans(null,le.bind(null,e.error)):e.table._idbstore(H,t,"locked")},_addAlgorithm:function(t){var e=this._ctx;e.algorithm=Pt(e.algorithm,t)},_iterate:function(t,e,n,r){return o(this._ctx,t,e,n,r)},clone:function(t){var e=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&a(n,t),e._ctx=n,e},raw:function(){return this._ctx.valueMapper=null,this},each:function(t){var e=this._ctx;return this._read(function(n,r,i){o(e,t,n,r,i)})},count:function(t){var e=this._ctx;if(Et(e,!0))return this._read(function(t,r,i){var o=n(e,i),a=e.range?o.count(e.range):o.count();a.onerror=_e(r),a.onsuccess=function(n){t(Math.min(n.target.result,e.limit))}},t);var r=0;return this._read(function(t,n,i){o(e,function(){return++r,!1},function(){t(r)},n,i)},t)},sortBy:function(t,e){var n=t.split(".").reverse(),r=n[0],i=n.length-1;function o(t,e){return e?o(t[n[e]],e-1):t[r]}var a="next"===this._ctx.dir?1:-1;function s(t,e){var n=o(t,i),r=o(e,i);return n<r?-a:n>r?a:0}return this.toArray(function(t){return t.sort(s)}).then(e)},toArray:function(t){var e=this._ctx;return this._read(function(t,r,i){if(u&&"next"===e.dir&&Et(e,!0)&&e.limit>0){var a=e.table.hook.reading.fire,s=n(e,i),c=e.limit<1/0?s.getAll(e.range,e.limit):s.getAll(e.range);c.onerror=_e(r),c.onsuccess=Ae(a===Z?t:function(e){try{t(e.map(a))}catch(t){r(t)}})}else{var l=[];o(e,function(t){l.push(t)},function(){t(l)},r,i)}},t)},offset:function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Et(n)?e(n,function(){var e=t;return function(t,n){return 0===e||(1===e?(--e,!1):(n(function(){t.advance(e),e=0}),!1))}}):e(n,function(){var e=t;return function(){return--e<0}}),this)},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),e(this._ctx,function(){var e=t;return function(t,n,r){return--e<=0&&n(r),e>=0}},!0),this},until:function(e,n){return t(this._ctx,function(t,r,i){return!e(t.value)||(r(i),n)}),this},first:function(t){return this.limit(1).toArray(function(t){return t[0]}).then(t)},last:function(t){return this.reverse().first(t)},filter:function(e){return t(this._ctx,function(t){return e(t.value)}),function(t,e){t.isMatch=Pt(t.isMatch,e)}(this._ctx,e),this},and:function(t){return this.filter(t)},or:function(t){return new bt(this._ctx.table,t,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,n){t(n.key,n)})},eachUniqueKey:function(t){return this._ctx.unique="unique",this.eachKey(t)},eachPrimaryKey:function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,n){t(n.primaryKey,n)})},keys:function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var n=[];return this.each(function(t,e){n.push(e.key)}).then(function(){return n}).then(t)},primaryKeys:function(t){var e=this._ctx;if(u&&"next"===e.dir&&Et(e,!0)&&e.limit>0)return this._read(function(t,r,i){var o=n(e,i),a=e.limit<1/0?o.getAllKeys(e.range,e.limit):o.getAllKeys(e.range);a.onerror=_e(r),a.onsuccess=Ae(t)}).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each(function(t,e){r.push(e.primaryKey)}).then(function(){return r}).then(t)},uniqueKeys:function(t){return this._ctx.unique="unique",this.keys(t)},firstKey:function(t){return this.limit(1).keys(function(t){return t[0]}).then(t)},lastKey:function(t){return this.reverse().firstKey(t)},distinct:function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return t(this._ctx,function(t){var e=t.primaryKey.toString(),n=c(r,e);return r[e]=!0,!n}),this},modify:function(t){var e=this,n=this._ctx.table.hook,i=n.updating.fire,o=n.deleting.fire;return this._write(function(n,s,u,l){var h;if("function"==typeof t)h=i===J&&o===J?t:function(e){var n=C(e);if(!1===t.call(this,e,this))return!1;if(c(this,"value")){var a=N(n,this.value),s=i.call(this,a,this.primKey,n,l);s&&(e=this.value,r(s).forEach(function(t){I(e,t,s[t])}))}else o.call(this,this.primKey,e,l)};else if(i===J){var f=r(t),d=f.length;h=function(e){for(var n=!1,r=0;r<d;++r){var i=f[r],o=t[i];T(e,i)!==o&&(I(e,i,o),n=!0)}return n}}else{var p=t;t=k(p),h=function(e){var n=!1,o=i.call(this,t,this.primKey,C(e),l);return o&&a(t,o),r(t).forEach(function(r){var i=t[r];T(e,r)!==i&&(I(e,r,i),n=!0)}),o&&(t=k(p)),n}}var m=0,y=0,g=!1,v=[],b=[],w=null;function E(t){return t&&(v.push(t),b.push(w)),s(new G("Error modifying one or more objects",v,y,b))}function _(){g&&y+v.length===m&&(v.length>0?E():n(y))}e.clone().raw()._iterate(function(t,e){w=e.primaryKey;var n={primKey:e.primaryKey,value:t,onsuccess:null,onerror:null};function r(t){return v.push(t),b.push(n.primKey),_(),!0}if(!1!==h.call(n,t,n)){var i=!c(n,"value");++m,S(function(){var t=i?e.delete():e.update(n.value);t._hookCtx=n,t.onerror=De(r),t.onsuccess=ke(function(){++y,_()})},r)}else n.onsuccess&&n.onsuccess(n.value)},function(){g=!0,_()},E,u)})},delete:function(){var t=this,e=this._ctx,n=e.range,r=e.table.hook.deleting.fire,i=r!==J;if(!i&&Et(e)&&(e.isPrimKey&&!Ee||!n))return this._write(function(t,e,r){var i=_e(e),o=n?r.count(n):r.count();o.onerror=i,o.onsuccess=function(){var a=o.result;S(function(){var e=n?r.delete(n):r.clear();e.onerror=i,e.onsuccess=function(){return t(a)}},function(t){return e(t)})}});var o=i?2e3:1e4;return this._write(function(n,a,s,u){var c=0,l=t.clone({keysOnly:!e.isMatch&&!i}).distinct().limit(o).raw(),h=[],f=function(){return l.each(i?function(t,e){h.push([e.primaryKey,e.value])}:function(t,e){h.push(e.primaryKey)}).then(function(){return i?h.sort(function(t,e){return At(t[0],e[0])}):h.sort(At),gt(s,u,h,i,r)}).then(function(){var t=h.length;return c+=t,h=[],t<o?c:f()})};n(f())})}}}),a(this,{Collection:wt,Table:dt,Transaction:vt,Version:ut,WhereClause:bt}),X.on("versionchange",function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+X.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+X.name+"'. Closing db now to resume the delete request."),X.close()}),X.on("blocked",function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+X.name+"') was blocked"):console.warn("Upgrade '"+X.name+"' blocked by other connection holding version "+t.oldVersion/10)}),b.forEach(function(t){t(X)})}function Ie(t,e){return r(e).forEach(function(n){var r=function t(e){if("function"==typeof e)return new e;if(i(e))return[t(e[0])];if(e&&"object"==typeof e){var n={};return Ie(n,e),n}return e}(e[n]);t[n]=r}),t}function ke(t){return Gt(function(e){var n=e.target,r=n._hookCtx,i=r.value||n.result,o=r&&r.onsuccess;o&&o(i),t&&t(i)},t)}function _e(t){return Gt(function(e){return Ce(e),t(e.target.error),!1})}function Ae(t){return Gt(function(e){t(e.target.result)})}function De(t){return Gt(function(e){var n=e.target,r=n.error,i=n._hookCtx,o=i&&i.onerror;return o&&o(r),Ce(e),t(r),!1})}function Ce(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function Ne(t){var e=function(e){return t.next(e)},n=o(e),r=o(function(e){return t.throw(e)});function o(t){return function(e){var o=t(e),a=o.value;return o.done?a:a&&"function"==typeof a.then?a.then(n,r):i(a)?xt.all(a).then(n,r):n(a)}}return o(e)()}function Oe(t,e,n,r,i,o,a){this.name=t,this.keyPath=e,this.unique=n,this.multi=r,this.auto=i,this.compound=o,this.dotted=a;var s="string"==typeof e?e:e&&"["+[].join.call(e,"+")+"]";this.src=(n?"&":"")+(r?"*":"")+(i?"++":"")+s}function xe(t,e,n,r){this.name=t,this.primKey=e||new Oe,this.indexes=n||[new Oe],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=w(n,function(t){return[t.name,t]})}function Pe(t){return 1===t.length?t[0]:t}function Re(t){var e=t&&(t.getDatabaseNames||t.webkitGetDatabaseNames);return e&&e.bind(t)}L(M,Se),l(Te,$),l(Te,{delete:function(t){var e=new Te(t),n=e.delete();return n.onblocked=function(t){return e.on("blocked",t),this},n},exists:function(t){return new Te(t).open().then(function(t){return t.close(),!0}).catch(Te.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(t){var e=Re(Te.dependencies.indexedDB);return e?new xt(function(t,n){var r=e();r.onsuccess=function(e){t(y(e.target.result,0))},r.onerror=_e(n)}).then(t):fe.dbnames.toCollection().primaryKeys(t)},defineClass:function(){return function(t){t&&a(this,t)}},applyStructure:Ie,ignoreTransaction:function(t){return Dt.trans?oe(Dt.transless,t):t()},vip:function(t){return Jt(function(){return Dt.letThrough=!0,t()})},async:function(t){return function(){try{var e=Ne(t.apply(this,arguments));return e&&"function"==typeof e.then?e:xt.resolve(e)}catch(t){return le(t)}}},spawn:function(t,e,n){try{var r=Ne(t.apply(n,e||[]));return r&&"function"==typeof r.then?r:xt.resolve(r)}catch(t){return le(t)}},currentTransaction:{get:function(){return Dt.trans||null}},waitFor:function(t,e){var n=xt.resolve("function"==typeof t?Te.ignoreTransaction(t):t).timeout(e||6e4);return Dt.trans?Dt.trans.waitFor(n):n},Promise:xt,debug:{get:function(){return M},set:function(t){L(t,"dexie"===t?function(){return!0}:Se)}},derive:d,extend:a,props:l,override:g,Events:he,getByKeyPath:T,setByKeyPath:I,delByKeyPath:function(t,e){"string"==typeof e?I(t,e,void 0):"length"in e&&[].map.call(e,function(e){I(t,e,void 0)})},shallowClone:k,deepClone:C,getObjectDiff:N,asap:b,maxKey:pe,minKey:me,addons:[],connections:ve,MultiModifyError:Y.Modify,errnames:Q,IndexSpec:Oe,TableSchema:xe,dependencies:function(){try{return{indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"{version}",version:"{version}".split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,2*n)}),default:Te,Dexie:Te}),xt.rejectionMapper=function(t,e){if(!t||t instanceof z||t instanceof TypeError||t instanceof SyntaxError||!t.name||!X[t.name])return t;var n=new X[t.name](e||t.message,t);return"stack"in t&&f(n,"stack",{get:function(){return this.inner.stack}}),n},(fe=new Te("__dbnames")).version(1).stores({dbnames:"name"}),function(){try{void 0!==typeof localStorage&&void 0!==o.document&&(JSON.parse(localStorage.getItem("Dexie.DatabaseNames")||"[]").forEach(function(t){return fe.dbnames.put({name:t}).catch(J)}),localStorage.removeItem("Dexie.DatabaseNames"))}catch(t){}}(),e.a=Te}).call(this,n(17),n(113).setImmediate)},function(t,e,n){"use strict";e.a='<body>\n  <template id="MainPage">\n    <div class="container grid-lg">\n      <div class="columns">\n        <div class="column col-12">\n          <header>Olgerd na dobu</header>\n        </div>\n        <div class="column col-6" ui:each="item of <-nav:/items|rest">\n          <CardNews ui:props="{{item}}" />\n        </div>\n      </div>\n      <h4 class="ui header">\n        <a target="video" href="//www.youtube.com/embed/5NkGFURgisI">2013</a>\n        -\n        <a target="video" href="//www.youtube.com/embed/j4oJoRAb_Ag">2012</a>\n        -\n        <a target="video" href="//www.youtube.com/embed/U0G5dBA854g">2011</a>\n      </h4>\n      <div class="embed-responsive embed-responsive-4by3">\n        \x3c!-- <iframe class="embed-responsive-item" src="//www.youtube.com/embed/j4oJoRAb_Ag" allowfullscreen="true"></iframe> --\x3e\n      </div>\n      <small>\n        <p>\n          <strong>Olgard</strong> - e mestom Sily. Tut qas beghyt pa-svojmu i inshy masshtab padzej, zdarenni\n          abumowleny i wseo navokal prasiaknuto asobym sensam.\n          Treba adno zawvaghac detali, sluxac tishynu, kab dotknuc sa da hetae inshae realnosti.\n        </p>\n        <p>\n          <strong>\n            <a href="http://ru.wikipedia.org/wiki/%D0%98%D1%81%D1%82%D0%BE%D1%80%D0%B8%D1%8F_%D0%93%D1%80%D0%BE%D0%B4%D0%BD%D0%BE"\n               target="_blank">Gistorya mesta Olgard</a>\n          </strong> neodjemnea qastka susvetnaj gistoryi. Leosy, zvyqai, mova i kultura tesno perapleli sa tut w\n          admyslovy uzor. Nashae\n          mesto josc prykladom tradycyj sebrowstva i wzaemnaj povagi migh leudzmi. My roznye, ale nas jednae vera w\n          lepshae majbytne, shto my razam buduem dzenj za dniom. I tamu tut lubiat pawtorac:\n          <i>"Use my liudzi", "Nex zhye volnosc", "Xto krucit, toj mae"</i>.\n        </p>\n      </small>\n    </div>\n\n  </template>\n\n  <template id="CardNews">\n    <div class="my-1">\n      <Card title="{{name}}" subtitle="{{name}}" ui:props="<-">\n        <li ui:each="e of links"><a href="{{e.link}}" class="item">{{e.name|subject|translit}}</a></li>\n      </Card>\n    </div>\n  </template>\n\n  <template id="Footer">\n    <footer class="ui inverted vertical footer segment">\n      <div class="ui center aligned container">\n        <div class="ui stackable inverted divided grid">\n          <div class="three wide column">\n            <h4 class="ui inverted header">Ab\'javy</h4>\n            <div class="ui inverted link list">\n              <a href="http://realty.grodno.co/" class="item">Zhytlo</a>\n              <a href="http://cars.grodno.co/" class="item">Samoxody</a>\n              <a href="http://job.grodno.co/" class="item">Pratsa</a>\n              <a href="http://service.grodno.co/" class="item">Paslugi</a>\n            </div>\n          </div>\n          <div class="seven wide column">\n            <h4 class="ui inverted header">Grodnae urbi est</h4>\n            <p>Sonca wsxodzic i zaxodzic, a pavazhnea plyn Niemana ne spyniaet sa ni na mig.</p>\n          </div>\n        </div>\n        <div class="ui inverted section divider"></div>\n        <img src="/logo.jpg" class="ui centered mini image" />\n        <div class="ui horizontal inverted small divided link list">\n          <a class="item" href="#">Site Map</a>\n          <a class="item" href="#">Contact Us</a>\n          <a class="item" href="#">Terms and Conditions</a>\n          <a class="item" href="#">Privacy Policy</a>\n        </div>\n      </div>\n    </footer>\n  </template>\n</body>'},function(t,e,n){"use strict";e.a='<body>\n\n  <template id="CalendarPage">\n    <div>\n      <div class="container pt-1 bg-gray" style="max-width:940px;">\n        <div class="columns">\n          <div class="column col-12 col-sm-12">\n            <IFrame src="<- routeMapUrl" />\n          </div>\n        </div>\n      </div>\n\n      <div class="container my-0 pt-0" style="max-width:940px;">\n        <Tags data="<- filteredTags" onItem="-> toggleTag" />\n        <PlacesSelectorList data="<- filteredPlaces" sortBy="created_at" />\n      </div>\n    </div>\n  </template>\n\n\n  <template id="AsideAdmin">\n    <div class="panel" style="height: 100%;">\n      <div class="panel-header">\n        <a class="btn btn-clear show-lg" style="float: right!important" href="#"></a>\n        <div class="panel-title">\n          <h1>A new route</h1>\n        </div>\n      </div>\n      <div class="panel-nav">\n      </div>\n      <div class="panel-body">\n        <SubmitForm places="<- selectedPlacesIds" photo="<- suggestedPhoto" />\n      </div>\n      <div class="panel-footer">\n      </div>\n    </div>\n  </template>\n\n  <template id="SubmitForm">\n    <form class="form-horizontal" method="POST" target="submitted"\n          action="https://script.google.com/macros/s/AKfycbygqpzU57bxZAW48Mo8nFxodJmy9_WFwiG7XizFmxY/dev">\n      <div class="form-group">\n        <div class="col-3 col-sm-12">\n          <label class="form-label" for="title">Name</label>\n        </div>\n        <div class="col-9 col-sm-12">\n          <input class="form-input" type="text" name="title" id="title" placeholder="name" />\n        </div>\n      </div>\n      <div class="form-group">\n        <div class="col-3 col-sm-12">\n          <label class="form-label" for="description">Description</label>\n        </div>\n        <div class="col-9 col-sm-12">\n          <textarea class="form-input" name="description" id="description" placeholder="description" />\n          </div>\n      </div>\n      <div class="form-group">\n        <div class="col-3 col-sm-12">\n          <label class="form-label" for="link">Link</label>\n        </div>\n        <div class="col-9 col-sm-12">\n          <input class="form-input" type="text" name="link" id="link" placeholder="URL address (optional)" />\n        </div>\n      </div>\n      <div class="form-group">\n        <div class="col-3 col-sm-12">\n          <label class="form-label" for="input-example-1">Places</label>\n        </div>\n      </div>\n      <PlacesList2 data="<- selectedPlaces" />\n\n      <div class="input-group">\n        <input class="form-input" type="hidden" name="_format" value="html" />\n        <input class="form-input" type="hidden" name="sheet" value="routes" />\n        <input class="form-input" type="hidden" name="places" value="{{places}}" />\n        <input class="form-input" type="hidden" name="photo" value="{{photo}}" />\n        <button class="btn btn-primary input-group-btn">Submit</button>\n      </div>\n      <iframe name="submitted" width="100%" height="15" frameborder="0"></iframe>\n    </form>\n  </template>\n\n  <template id="PlacesList2">\n    <div class="timeline">\n\n      <div class="timeline-item" id="timeline-example-2" ui: each="item of data">\n    <div class="timeline-left">\n        <figure class="avatar avatar-sm bg-primary" data-initial="{{item.title|initials}}">\n          <img src="{{item.photo}}" class="img-responsive" />\n        </figure>\n      </div>\n      <div class="timeline-content">\n        <div class="tile">\n          <div class="tile-content">\n            <p class="tile-subtitle">{{ item.title | subject }}</p>\n          </div>\n          <div class="tile-action">\n            <div class="btn-group btn-group-block">\n              <button class="btn disabled:{{itemIndex}}=0" data-id="{{item.id}}" data-dir="up" click="-> arrangePlace"><i class="icon icon-arrow-up"></i></button>\n              <button class="btn disabled:{{itemIndex}}={{data.length}}" data-id="{{item.id}}" data-dir="down" click="-> arrangePlace"><i class="icon icon-arrow-down"></i></button>\n              <button class="btn btn-primary" data-id="{{item.id}}" click="-> togglePlace"><i class="icon icon-cross"></i></button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </template>\n\n  <template id="PlacesSelectorList">\n    <div class="columns">\n      <PlacesSelectorListItem item="{{item}}" ui:each="item of data"/>\n    </div>\n  </template>\n\n  <template id="PlacesSelectorListItem">\n    <div class="column col-4 col-sm-12">\n      <div class="card">\n        <div class="card-image" data-modal="true" click="{{assign}}">\n          <Parallax backImage="{{item.photo}}" />\n        </div>\n        <div class="card-header">\n          <div class="form-group">\n            <label class="form-switch">\n              <input type="checkbox" checked="{{item.selected}}" data-id="{{item.id}}" toggle="-> togglePlace" />\n              <i class="form-icon"></i><h5 class="card-title">{{ item.title | subject }}</h5>\n            </label>\n          </div>\n        </div>\n      </div>\n      <Modal title="{{item.title|subject}}" ui: if="modal" close="{{ assign }}">\n      <span>{{ item.description }}</span>\n      <a href="{{item.link}}" target="_blank">More...</a>\n      </Modal>\n    </div>\n  </template  >\n  </body >'},function(t,e,n){"use strict";e.a='<template id="GeomapPage">\n  <div>\n    <Hero title="{{route.title|subject}}" />\n    <div class="container pt-1 bg-gray" style="max-width:940px;">\n      <div class="columns">\n        <div class="column col-12 col-sm-12">\n          <span class="tile-subtitle p-2">{{route.description}}</span>\n          <a href="{{route.link}}" target="_blank">More...</a>\n        </div>\n        <div class="column col-12 col-sm-12">\n          <IFrame src="<- routeMapUrl" />\n        </div>\n      </div>\n    </div>\n    <div class="container my-0 pt-0" style="max-width:940px;">\n      <h5 class="tile-subtitle p-2">Places</h5>\n      <PlacesList data="<- selectedPlaces" sortBy="created_at" />\n    </div>\n  </div>\n</template>\n\n<template id="AsideClient">\n  <div class="panel" style="height: 100%;">\n    <div class="panel-header">\n      <a class="btn btn-clear show-lg" style="float: right!important" href="#"></a>\n      <div class="panel-title">\n        <h1>Routes</h1>\n      </div>\n    </div>\n    <div class="panel-nav">\n    </div>\n    <div class="panel-body">\n      <RoutesList data="<- routes" />\n    </div>\n    <div class="panel-footer">\n    </div>\n  </div>\n</template>\n\n<template id="PlacesListItem">\n  <div class="column col-4 col-sm-12" data-modal="true" click="{{assign}}">\n    <div class="card">\n      <div class="card-image">\n        <Parallax backImage="{{item.photo}}" />\n      </div>\n      <div class="card-header">\n        <h5 class="card-title">{{ item.title | subject }}</h5>\n      </div>\n    </div>\n    <Modal title="{{item.title|subject}}" ui:if="modal" close="{{ assign }}">\n      <span>{{ item.description }}</span>\n      <a href="{{item.link}}" target="_blank">More...</a>\n    </Modal>\n  </div>\n</template>\n\n<template id="PlacesList">\n  <div class="columns">\n    <PlacesListItem item="{{item}}" ui:each="item of data" />\n  </div>\n</template>\n\n<template id="RoutesList">\n  <div class="columns" style="max-width:350px;">\n    <div class="column col-12 col-sm-12 mt-1" ui:each="item of data">\n      <div class="card">\n        <div class="card-header">\n          <div class="tile">\n            <div class="tile-icon">\n              <figure class="avatar avatar-lg bg-primary" data-initial="{{item.title|initials}}">\n                <img src="{{item.photo}}" class="img-responsive" />\n              </figure>\n            </div>\n            <div class="tile-content">\n              <p class="tile-title">\n                <div>\n                  <a class="header" data="{{item}}" click="-> selectRoute">{{ item.title | subject }}</a>\n                </div>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>'},function(t,e,n){"use strict";e.a='<body id="app">\n  <template id="NewsPage">\n    <ui:fragment>\n      <Collection ui:ref="news"\n                  data="<- db://index/news"\n                  initials=":newsInitialTags" />\n      <NewsList ui:props="<- news://info" />\n      \x3c!-- <BigRedButton data=":AddNewRecordData" tooltip="tool" action="-> news://openAddNew" /> --\x3e\n      \x3c!-- <NewsUpdateModal ui:if="id" id="{{id}}" open="{{open}}" data2="db:one/news/{{id}}" /> --\x3e\n      <NewsCreateModal ui:props="<- news://newEntry" submit="-> news://saveNew" cancel="-> news://cancelAddNew" />\n      <Toast ui:if="error" message="{{error.message}}" />\n    </ui:fragment>\n  </template>\n\n  <template id="NewsList">\n    <div class="container bg-gray" style="max-width:940px;">\n      <a name="top"></a>\n      <Box>\n        <Box:1>\n          <h3 class="s-title badge text-gray my-2" data-badge="{{counts|counts}}">Naviny z Olgarda</h3>\n        </Box:1>\n        <Box:2>\n          <SearchBar\n                     input="-> news:inputKluq"\n                     enter="-> news:znajdzPoKluqu"\n                     value="{{kluqInput}}"\n                     suggestions="{{suggestions}}" />\n        </Box:2>\n      </Box>\n      <div class="sticky bg-gray py-2">\n        <Chips data="{{tags}}" click="-> news://tag" />\n      </div>\n      <div class="columns">\n        <NewsListItem ui:props="{{item}}" itemClick="-> nav:openItem" ui:each="item of data">\n          <ui:loading>\n            <div class="column col-9 col-sm-12 loading"></div>\n          </ui:loading>\n          <ui:empty>\n            <h6 class="column col-9 col-sm-12">Nic nema</h6>\n          </ui:empty>\n        </NewsListItem>\n        <Toast ui:if="error" message="{{error.message}}" />\n      </div>\n      <button class="btn btn-primary btn-sm" data-size="20"\n              click="-> news://showMore"\n              ui:if="counts.hasMore">:pakazac_bolsh</button>\n      <a href="#top" ui:if="counts.actual|isAbove:5">:naverx</a>\n    </div>\n  </template>\n\n  <template id="NewsListItem">\n    <div class="column col-12 col-sm-12 my-2">\n      <div class="card">\n        <div class="card-header">\n          <div class="tile">\n            <div class="tile-icon">\n              \x3c!-- <figure class="avatar avatar- bg-primary" data-initial="{{subject|initials}}"> --\x3e\n              <img src="{{image}}"\n                   class="img-responsive" width="196" data-value="{{id}}" click="itemClick" />\n              \x3c!-- </figure> --\x3e\n            </div>\n            <div class="tile-content">\n              <h5 class="tile-title">{{subject|translit}}</h5>\n              <p>\n                <small class="text-gray">{{created_at|date}}</small>\n                <small class="text-gray mx-1"><a href="{{link}}" target="_blank">{{link|hostOf}}</a></small>\n                <small class="text-gray" ui:if="tags">({{tags}})</small>\n              </p>\n            </div>\n          </div>\n        </div>\n        <div class="card-body">\n          <img src="/assets/grodno2.svg" height="10" width="10" />\n          <small class="mx-2">{{preview|translit}}</small>\n        </div>\n        \x3c!-- <div class="card-footer">\n          <button class="btn btn-primary btn-sm">Do</button>\n        </div> --\x3e\n      </div>\n    </div>\n  </template>\n\n  <template id="NewsCreateModal">\n    <Modal ui:if="open" open="{{open}}" title="Add a new record" close="{{cancel}}">\n      <Form fields=":news_form" data="{{data}}" change="->" />\n      <Modal:footer>\n        <button class="btn btn-primary" data="{{data}}" click="{{submit}}">:create_new</button>\n      </Modal:footer>\n    </Modal>\n  </template>\n\n  <template id="NewsUpdateModal">\n    <Modal ui:if="id" open="{{open}}" title="Edit record ({{id}})" close="-> nav:close">\n      <Form fields=":news_form" data="{{data}}" changed="{{assign}}" />\n      <ui:fragment key="footer">\n        <button class="btn btn-primary" data="{{data}}" click="-> db:update/news">:update</button>\n        <button class="btn btn-danger" click="-> db:delete/news/{{id}}">:delete</button>\n      </ui:fragment>\n    </Modal>\n  </template>\n\n</body>'},function(t,e,n){"use strict";e.a={appName:"Olgard",appLogo:"/logo.jpg",appVersion:"4.0.0",sitemap:[{name:"Galownea",id:"main"},{name:"Objavy",id:"ads"},{name:"Naviny",id:"news"},{name:"Calendar",id:"calendar"},{name:"Karta",id:"geomap"},{name:"Leudzi",id:"people"}],media_links:[{name:"S13.ru",id:"//s13.ru"},{name:"Forum",id:"//forum.grodno.net/"}],news_form:[{id:"subject",type:"name",typeSpec:"city"},{id:"preview",type:"text",typeSpec:"unit"},{id:"body",type:"text",typeSpec:"country"},{id:"tags",type:"enum",typeSpec:"tags"}],tags:[{name:"Padzei",id:"events"},{name:"Gistorya",id:"history"},{name:"Zabavki",id:"amazing"}],newsInitialTags:"asoba,gramadstva,dabrabyt,axtung,adukacya,biznes",AddNewRecordData:{title:"Add a new record",data:{subject:"new record"}},firebaseConfig:{apiKey:"AIzaSyBZ4bR8ArGmHxo-ExfKrlhkMMAj86lSIpw",authDomain:"grodno-24aa8.firebaseapp.com",databaseURL:"https://grodno-24aa8.firebaseio.com",projectId:"grodno-24aa8",storageBucket:"grodno-24aa8.appspot.com",messagingSenderId:"1045179719966"},dbSchema:{news:"id, modified_at",users:"id, modified_at",comments:"id, target, modified_at"},gender:[{id:"male"},{id:"female"},{id:"unisex"}],marital:[{id:"married"},{id:"single"}],allergy:[{id:"penicillin"},{id:"codeine"}],risk_factors:[{id:"smoking"},{id:"stress"},{id:"alcohol"},{id:"weight"}],specialty:[{id:"therapist"},{id:"neurologist"},{id:"ophtalmologist"},{id:"pulmonologist"},{id:"cardiologist"}],category:[{id:"first"},{id:"highest"}],degree:[{id:"doctor"},{id:"docent"},{id:"professor"}],status:[{id:"open"},{id:"appointed"},{id:"in_progress"},{id:"done"},{id:"confirmed"}],orderStatus:[{id:"reserved"},{id:"cancel"},{id:"complete"}],orderType:[{id:"online"},{id:"ofline"}],medician_form:[{id:"name",type:"name"},{id:"specialty",type:"enum",typeSpec:"specialty"},{id:"category",type:"enum",typeSpec:"category"},{id:"degree",type:"enum",typeSpec:"degree"},{id:"tags",type:"tag"},{id:"city",type:"dict",typeSpec:"city"},{id:"organization",shown:"{{city}}",type:"ref",typeSpec:"organization?city={{city}}"},{id:"unit",shown:"{{organization}}",type:"ref",typeSpec:"unit?organization={{organization}}"}],organization_form:[{id:"item",type:"ref",typeSpec:"item"},{id:"type",type:"enum",typeSpec:"org_type"},{id:"address",type:"ref",typeSpec:"address"},{id:"head_of",type:"ref",typeSpec:"person"},{id:"name",type:"name"},{id:"parent",type:"ref",typeSpec:"unit"},{id:"weight",type:"ref",typeSpec:"person"},{id:"head_of",type:"ref",typeSpec:"person"}],address_form:[{id:"city",type:"dict",typeSpec:"city"},{id:"street",type:"ref",typeSpec:"unit"},{id:"country",type:"dict",typeSpec:"country"},{id:"item",type:"embed",typeSpec:"item"}],patient_form:[{id:"name",type:"name"},{id:"birth_date",type:"dateTime"},{id:"gender",type:"enum",typeSpec:"gender"},{id:"marital_status",type:"enum",typeSpec:"marital_status"},{id:"emergency_contact",type:"issuesCriticality"},{id:"address",type:"ref",typeSpec:"address"},{id:"phone",type:"issueType"},{id:"email",type:"issueName"},{id:"name",type:"span"},{id:"position",type:"timeAgo"},{id:"date"},{id:"medication"},{id:"appearance"},{id:"quantity"},{id:"start_date"},{id:"end_date"},{id:"medician",type:"ref",typeSpec:"staff"},{id:"pharmacy"},{id:"chronic_conditions"},{id:"risk_factors",type:"dict",typeSpec:"risk_factor"},{id:"allergies",type:"enum",typeSpec:"allergy"},{id:"notes",type:"note"}]}},function(t,e,n){"use strict";e.a={result:{routes:[{_id:1,id:1,title:"История древнего города",places:"5,8,14",link:"http://s13.ru",description:"Церковь Святых Бориса и Глеба – уникальный шедевр Гродненской архитектурной школы.",photo:"https://grodno.flatbook.by/img/landmarks/grodno/full/6laau9vtz0088kgk88oos8osk.jpg"},{_id:2,id:2,title:"Легенды дышат в ухо",places:"6,8,14",link:"http://s13.ru",description:"Центральный Спортивный Комплекс «Неман» — многофункциональный стадион в Гродно, Беларусь. В основном используется для проведения домашних матчей футбольного клуба «Неман».",photo:"https://www.pressball.by/images/football/stadiums/neman_grodno.JPG"},{_id:3,id:3,title:"Паеш брушки",places:"7,8,14",link:"http://s13.ru",description:'злоумышленном устройстве будет продолжать жить и дальше, то с него можно будет продолжать иметь доступ к аккаунту даже после добавления более "продвинутых" способов авторизации',photo:"http://bssr.by/uploads/1534491246060dfzg8ynacxs0s0ccwggosswkc.jpg"},{_id:4,id:4,title:"Слон Гоша и яго сябры",places:"8,8,14",link:"http://s13.ru",description:"Гродненский зоопарк был основан в 1927 году Яном Кохановским. На сегодняшний день тут работает террариум, зоомагазин, а также детское кафе и бар для родителей. На территории зоопарка также установлены детские аттракционы и контактная площадка «Бабушкин дворик», где каждый желающий может поближе познакомиться с детенышами представленных в зоопарке особей. В зоомагазине можно приобрести грызунов, птиц и аквариумных рыбок. А также корма, клетки и аксессуары для домашних питомцев. Имеется сувенирная продукция.",photo:"https://3.bp.blogspot.com/-oKVeNFgB0Pw/WFGOG5Xkr7I/AAAAAAAAIzs/sETSSuBy4xEuDPejIXCLHHiGSQ5QD477gCEw/s1600/1607151646591.jpg"},{_id:5,id:5,title:"Кася, Бася и другие",places:"9,8,14",link:"http://s13.ru",description:"Торговый дом Неман расположен в самом центре Гродно. Здесь вы найдете все, чтобы хорошо выглядеть, отлично провести время, вкусно покушать и побаловать себя чашкой ароматного  кофе. У нас представлены  такие марки, как  Colins, Mothercare, ТВОЕ, Мегатоп, Foroom, Дом меха, Золотая мечта, 7 Карат, а также кафе, ресторан-бистро, детский развлекательный центр, аптека.",photo:"http://my-travel-diary.by/wp-content/uploads/2015/04/DSC_0997.jpg"},{_id:6,id:6,title:"Театральный Гродно",places:"10,8,14",link:"http://s13.ru",description:"одним из интереснейших театров Беларуси и близлежащего европейского региона.",photo:"https://www.holiday.by/files/sights/88dca3c21ee405ee672459a6abb05f6a-thumb-900x600-proportional-w.jpg"},{_id:7,id:7,title:"Фарный косцел",places:"11,8,14",link:"http://s13.ru",description:"Кафедральный собор Святого Франциска Ксаверия, неофициально называется также Фарный костёл",photo:"https://postim.by/post_photo/19370/xbfblucF1518108503.jpg"},{_id:8,id:8,title:"Рыбак рыбака",places:"20,17,7",link:"http://s13.ru",description:'злоумышленном устройстве будет продолжать жить и дальше, то с него можно будет продолжать иметь доступ к аккаунту даже после добавления более "продвинутых" способов авторизации',photo:"https://postim.by/post_photo/19370/xbfblucF1518108503.jpg"},{_id:9,id:9,title:"Не для слабонервных",places:"21,8,14",link:"http://s13.ru",description:"История необычной экспозиции берёт начало в 50-е годы 20 века.",photo:"https://media.grodno.in/source/photos/2014/04/04/izobrajenie-081-17f0_s_3x2.jpg"}],places:[{_id:1,id:1,title:"Коложская церковь",latitude:"53.67995898",longitude:"23.81381035",address:"Ulitsa Kolozha 6, Hrodna 230029",description:"Церковь Святых Бориса и Глеба – уникальный шедевр Гродненской архитектурной школы, созданный в XII веке византийским зодчим Петром Милонегом. \nВ 1853 г. в Неман обрушилась южная стена храма. В 1897 г. берег был укреплен, а рухнувшая стена заменена временной деревянной.",tags:"religious",tags2:"landmarks",photo:"https://grodno.flatbook.by/img/landmarks/grodno/full/6laau9vtz0088kgk88oos8osk.jpg"},{_id:2,id:2,title:"Стадион Неман",latitude:"53.6887783",longitude:"23.82114887",address:"Komunal'naya Ulitsa 3, 230025, Hrodna",description:"Центральный Спортивный Комплекс «Неман» — многофункциональный стадион в Гродно, Беларусь. В основном используется для проведения домашних матчей футбольного клуба «Неман».",tags:"sport",tags2:"entertainment",photo:"https://www.pressball.by/images/football/stadiums/neman_grodno.JPG"},{_id:3,id:3,title:"Парк Жилибера",latitude:"53.68583026",longitude:"23.83702755",address:"vulica Elizy Ažeška 15, Hrodna",tags:"nature & parks",tags2:"city_centre",photo:"http://bssr.by/uploads/1534491246060dfzg8ynacxs0s0ccwggosswkc.jpg"},{_id:4,id:4,title:"Зоопарк",latitude:"53.68913408",longitude:"23.84827137",address:"г. Гродно, ул. Тимирязева,11",description:"Гродненский зоопарк был основан в 1927 году Яном Кохановским. На сегодняшний день тут работает террариум, зоомагазин, а также детское кафе и бар для родителей. На территории зоопарка также установлены детские аттракционы и контактная площадка «Бабушкин дворик», где каждый желающий может поближе познакомиться с детенышами представленных в зоопарке особей. В зоомагазине можно приобрести грызунов, птиц и аквариумных рыбок. А также корма, клетки и аксессуары для домашних питомцев. Имеется сувенирная продукция.",tags:"animals",tags2:"for_kids",tags3:"city_centre",photo:"https://3.bp.blogspot.com/-oKVeNFgB0Pw/WFGOG5Xkr7I/AAAAAAAAIzs/sETSSuBy4xEuDPejIXCLHHiGSQ5QD477gCEw/s1600/1607151646591.jpg"},{_id:5,id:5,title:"Торговый дом Неман",latitude:"53.68236097",longitude:"23.83144855",address:"г.Гродно, ул.Советская, 18",description:"Торговый дом Неман расположен в самом центре Гродно. Здесь вы найдете все, чтобы хорошо выглядеть, отлично провести время, вкусно покушать и побаловать себя чашкой ароматного  кофе. У нас представлены  такие марки, как  Colins, Mothercare, ТВОЕ, Мегатоп, Foroom, Дом меха, Золотая мечта, 7 Карат, а также кафе, ресторан-бистро, детский развлекательный центр, аптека.",tags:"shopping",tags2:"city_centre",photo:"http://my-travel-diary.by/wp-content/uploads/2015/04/DSC_0997.jpg"},{_id:6,id:6,title:"Кукольный театр",latitude:"53.68673248",longitude:"23.83531094",address:"vulica Dziaržynskaha 1/1, Hrodna 230023",description:"Прекрасный актерский ансамбль, изысканная и изящная сценография, современная концептуальная режиссура, глубоко гуманистические и философские спектакли делают Гродненский областной театр кукол одним из интереснейших театров Беларуси и близлежащего европейского региона.",tags:"theatre",tags2:"city_centre",tags3:"for_kids",photo:"https://www.holiday.by/files/sights/88dca3c21ee405ee672459a6abb05f6a-thumb-900x600-proportional-w.jpg"},{_id:7,id:7,title:"Фарный косцел",latitude:"53.67825591",longitude:"23.83147001",address:"г. Гродно, пл. Советская 4.",description:"Кафедральный собор Святого Франциска Ксаверия, неофициально называется также Фарный костёл — католический собор в городе Гродно, кафедральный собор Гродненского диоцеза. Один из трёх храмов Белоруссии, носящих почётный титул малая базилика.",tags:"religious",tags2:"landmarks",photo:"https://postim.by/post_photo/19370/xbfblucF1518108503.jpg"},{_id:8,id:8,title:"Свято-Покровский кафедральный собор",latitude:"53.67712472",longitude:"23.82663131",address:"vulica Elizy Ažeška 23, Hrodna 230023",description:"Свято-Покровский кафедральный собор находится в Гродно. Храм построили в честь Гродненского гарнизона, воины которого в 1904–1905 гг погибли в русско-японской войне. Их имена высечены на мемориальных досках, которые висят на стенах собора.В храме находится чудотворная икона «Казанской Божьей Матери». По легенде, во время Первой мировой войны эту иконку пытались вывезти в Россию, но задумка не удалась, так как никто не смог сдвинуть её с места.Также в храме находится копия креста религиозного и исторического деятеля белорусской земли Евфросиньи Полоцкой. В этом кресте хранятся частицы мощей святых Беларуси.",tags:"religious",tags2:"landmarks",photo:"https://upload.wikimedia.org/wikipedia/commons/f/f9/%D0%93%D1%80%D0%BE%D0%B4%D0%BD%D0%BE_%D1%83%D0%BB._%D0%9E%D0%B6%D0%B5%D1%88%D0%BA%D0%BE_09.jpg"},{_id:9,id:9,title:"Новый Замок",latitude:"53.67604435",longitude:"23.82503271",address:"улица Замковая, 20",description:"Но́вый за́мок в Гро́дно — новый королевский дворец, построенный в Гродно, напротив старого дворца (Старый замок), в 1734—1751 годах во время правления польского короля и великого князя литовского Августа III как летняя резиденция польских королей и великих князей литовских, по проекту Карла Фридриха Пёппельмана.",tags:"architecture",tags2:"landmarks",photo:"https://www.holiday.by/files/sights/grodno_novyj_zamok_608219f410fca31e603c727aecabbd38996-thumb-900x600-proportional-w.jpg"},{_id:10,id:10,title:"Костёл Обретения Святого Креста и монастырь бернардинцев",latitude:"53.67478599",longitude:"23.83024693",address:"Mostowa, Hrodna",description:"Костёл Обретения Святого Креста и монастырь бернардинцев в Гродно — крупнейший действующий католический комплекс города. Костёл является одним из старейших на территории всей западной Беларуси. История строительства комплекса началась в конце 15 века и связана с именем великого князя Литовского и короля Польского Александра Ягеллончика.",tags:"religious",tags2:"landmarks",photo:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/%D0%90%D0%BD%D1%81%D0%B0%D0%BC%D0%B1%D0%BB%D1%8C_%D0%B1%D1%8B%D0%BB%D0%BE%D0%B3%D0%B0_%D0%BA%D0%BB%D1%8F%D1%88%D1%82%D0%B0%D1%80%D0%B0_%D0%B1%D0%B5%D1%80%D0%BD%D0%B0%D1%80%D0%B4%D0%B7%D1%96%D0%BD%D1%86%D0%B0%D1%9E.jpg/1200px-%D0%90%D0%BD%D1%81%D0%B0%D0%BC%D0%B1%D0%BB%D1%8C_%D0%B1%D1%8B%D0%BB%D0%BE%D0%B3%D0%B0_%D0%BA%D0%BB%D1%8F%D1%88%D1%82%D0%B0%D1%80%D0%B0_%D0%B1%D0%B5%D1%80%D0%BD%D0%B0%D1%80%D0%B4%D0%B7%D1%96%D0%BD%D1%86%D0%B0%D1%9E.jpg"},{_id:11,id:11,title:"Драматический театр",latitude:"53.6753262",longitude:"23.82754326",address:"Драматический театр",tags:"theatre",tags2:"entertainment",tags3:"architecture"},{_id:12,id:12,title:'Хостел "Hello, Grodno!"',latitude:"53.67982554",longitude:"23.8336587",address:'Хостел "Hello, Grodno!"',tags:"accomodation",tags2:"city_centre"},{_id:13,id:13,title:"Дом-музей Элизы Ожешко",latitude:"53.68421638",longitude:"23.83940935",address:"Дом-музей Элизы Ожешко",tags:"landmarks",tags2:"city_centre",photo:"http://my-travel-diary.by/wp-content/uploads/2015/04/DSC_0948.jpg"},{_id:14,id:14,title:"Лютеранская кирха",latitude:"53.68710734",longitude:"23.84038568",address:"Лютеранская кирха",tags:"religious",tags2:"landmarks",tags3:"architecture"},{_id:15,id:16,title:"Королинская усадьба Тызенгауза",address:"Королинская усадьба Тызенгауза",tags:"out_of_town",photo:"http://www.karalino.by/_img/slider-img.png"},{_id:16,id:17,title:"Дом рыбака",address:"Дом рыбака",tags:"out_of_town",tags2:"nature & parks",tags3:"accomodation"},{_id:17,id:18,title:"Гродненская кунсткамера",address:"Гродненская кунсткамера",description:"История необычной экспозиции берёт начало в 50-е годы 20 века. В то время при университете была сформирована кафедра анатомии и начался сбор экспонатов. К 1990 году был выведен Музей уродств человеческого тела. Проведение лекций для студентов началось в 1994 году.2 июля 2013 года была открыта обновлённая экспозиция, насчитывающая более 70 различных экспонатов. Именно тогда ей и было присвоено название «Гродненская кунсткамера». В настоящее время проводятся экскурсии продолжительностью 30–40 минут, во время которых подробно описываются все представленные аномалии человеческого тела. Проводят такие лекции-экскурсии преподаватели медицинского университета. Сотрудники кунсткамеры организуют и бесплатные лекции для сирот, инвалидов и детей из малоимущих семей.",link:"https://my-travel-diary.by/wp-content/uploads/2015/04/DSC01578_1151x766-min-1140x759.jpg",tags:"weird_place",photo:"https://media.grodno.in/source/photos/2014/04/04/izobrajenie-081-17f0_s_3x2.jpg"},{_id:18,id:19,title:"Аптека-музей",address:"Аптека-музей",description:"Первая в Беларуси аптека-музей. Открыта в 1996 году и находится в старейшем здании иезуитской аптеки. Экспозиции знакомят с развитием фармации в Гродно, демонстрируется коллекция аптечной посуды конца XIX — первой половины XX вв, инструментов и книг.",tags:"weird_place"},{_id:19,id:20,title:"Церковь Рождества Богородицы",address:"Церковь Рождества Богородицы",description:"Рождество-Богородичный монастырь в Гродно — православный храм. При нем находится женский Рождество-Богородичный монастырь. Первые летописные упоминания о нём датированы 1506 годом. Тогда на его месте стоял деревянный храм — Пречистенская церковь."},{_id:20,id:21,title:"Швейцарская долина",address:"Швейцарская долина",description:"Швейцарская долина в Гродно — живописный парковый комплекс в центральной части города. История его создания уходит корнями в 18 век и связана с именем гродненского старосты Антония Тизенгауза.",tags:"nature & parks",tags2:"city_centre",photo:"https://media.grodno.in/source/photos/2016/07/12/img-5210-m.jpg"},{_id:21,id:22,title:"Еврейское гетто",address:"Еврейское гетто",description:"Еврейское гетто в Гродно существовало в период с ноября 1941 по май 1943 года. Оно было создано нацистами с целью принудительного переселения гродненских евреев. По статистическим данным к началу военных действий на территории Гродно проживало больше 18500 евреев, что на тот момент составляло половину городского населения. Город был в числе первых захваченных в Беларуси, а его оккупация прошла в течение одного дня.",photo:"https://media.grodno.in/source/photos/2016/10/18/img-7906-m.jpg"},{_id:22,id:23,title:"Бригитский костел",address:"Бригитский костел",description:"Костёл Благовещения Пресвятой Девы Марии и монастырь бригиток — архитектурный комплекс 17 века, построенный в Гродно. Храм располагается на улице Молодёжной в историческом центре города."},{_id:23,id:24,title:"Форт #2",address:"Форт #2",description:"Фотификационное сооружение на территории Гродненской крепости. \nВ 1915 году крепость находилась в осадном положении. В связи с этим была объявления эвакуации солдат, во время которой все форты должны были подорвать. Форт №2 не стал исключением. \nВ годы Великой Отечественной войны форт приобрёл печальную известность. Именно здесь, на его развалинах, немецко-фашистские захватчики неоднократно проводили массовые казни военнопленных и мирных жителей. В расстрелах погибли тысячи ни в чём не повинных людей.",photo:"https://media.grodno.in/source/photos/2017/01/19/img-2169-m.jpg"},{_id:24,id:25,title:"Музей истории религии",address:"Музей истории религии",description:"музей существует с 6 июня 1977 года. В коллекции музея находится порядка 85.000 экспонатов, которые в совокупности составляют 14 коллекций.",tags:"culture",photo:"https://media.grodno.in/source/photos/2017/01/25/img-7301-m.jpg"},{_id:25,id:26,title:"Пожарная каланча",address:"Пожарная каланча",description:"Пожарная каланча в Гродно — памятник архитектуры 20 века, на территории которого располагается действующая пожарно-спасательная часть. Находится на пересечении старейших улиц города — Замковой и Давида Городенского.",tags:"culture",tags2:"architecture",photo:"https://media.grodno.in/source/photos/2017/01/25/img-7320-m04899ba9_6x4.jpg"},{_id:26,id:27,title:"Усадьба Станиславово",address:"Усадьба Станиславово",description:"Усадьба Станиславово в Гродно — памятник архитектуры, созданный в 18 веке по проекту «зодчего Гродно» Джузеппе Сакко. Заказчиком был последний польский король и великий князь Станислав Август Понятовский, сделавший имение своей загородной резиденцией.",tags:"architecture",photo:"https://media.grodno.in/source/photos/2017/03/11/img-3847-mac63e7dc_4x3.jpg"},{_id:27,id:28,title:"Августовский канал",address:"Августовский канал",description:"Августовский канал в районе Гродно — уникальный памятник гидротехнической архитектуры 18–19 веков, соединяющий бассейны рек Висла и Неман. Канал является одной из красивейших и важнейших достопримечательностей Гродненского района и располагается на территории двух соседствующих государств: Республики Польши и Беларуси.",tags:"out_of_town"},{_id:28,id:29,title:"Старое городское кладбище",address:"Старое городское кладбище",description:"Старое городское кладбище в Гродно — старейшее место захоронения в городе и одно из самых старых в Беларуси. Расположено на улице Антонова за центральным городским рынком.",tags:"culture",tags2:"weird_place",photo:"https://media.grodno.in/source/photos/2017/03/24/img-6327-m.jpg"},{_id:29,id:30,title:"Цудоуня",address:"Цудоуня",description:'изделия ручной работы от белорусских мастеров: этнография и этностиль, белорусские традиции, реконструкция; белорусские книги, сувениры и открытки. Здесь - доступные вещи для всех и уникальные статусные подарки. У нас вы найдете украшения, предметы интерьера, предметы домашнего обихода, одежду с традиционными орнаментами, народные музыкальные инструменты, керамику, плетеные изделия из лозы и соломы, резьбу по дереву, кованые изделия и многое другое. У нас есть белорусские книги для детей и взрослых (современная литература, классика в переводе, история и краеведение, этнография). Кроме предложения качественных предметов белорусского ремесла и сувениров, мы можем рассказать о техниках изготовления вещей, представленных здесь, рассказать об истории вещей и народных традициях. * "Цуд" по-белорусски - "чудо"; тое есть "место с чудесами".',tags:"book_store",tags2:"local_goods",tags3:"souveniurs"},{_id:30,id:31,title:"Торговый центр “OldCity”",address:"Торговый центр “OldCity”",description:"Торговый центр “OldCity” – замечательное место для шоппинга и отдыха всей семьей. Расположен в северной части Гродно, в микрорайоне “Девятовка”.",tags:"shopping"},{_id:31,id:32,title:'Галерея "У Майстра"',address:'Галерея "У Майстра"',description:'Галерея "У Майстра" это первая частная галерея города. Рекомендуем любителям искусства посмотреть интересные выставки, а также можно заглянуть за оригинальным подарком.',tags:"art_gallery",tags2:"local_goods",tags3:"souveniurs"},{_id:32,id:33,title:'Магазин "Ратушный"',address:'Магазин "Ратушный"',description:"В центре Гродно купить сувенир с символикой города и изображением его знаковых мест сегодня можно в любом магазине, даже продовольственном. К примеру, в расположенном на площади Советской магазине «Ратушный» предлагают около 6 тысяч наименований сувенирной продукции! Товарооборот ее здесь за последний год вырос вдвое. Самые ходовые товары: магниты, льняные полотенца, бельевой трикотаж, колготки, носки.",tags:"local_goods",tags2:"souveniurs"}],tags:[{_id:1,id:"accomodation",of:"active"},{_id:2,id:"active"},{_id:3,id:"amusement_park",of:"active"},{_id:4,id:"animals",of:"active"},{_id:5,id:"architecture",of:"active"},{_id:6,id:"art_gallery",of:"active"},{_id:7,id:"bank",of:"business"},{_id:8,id:"bar",of:"business"},{_id:9,id:"beauty",of:"business"},{_id:10,id:"bicycle_rent",of:"business"},{_id:11,id:"book_store",of:"business"},{_id:12,id:"bowling",of:"business"},{_id:13,id:"business"},{_id:14,id:"cafe",of:"business"},{_id:15,id:"casino",of:"business"},{_id:16,id:"cinema",of:"culture"},{_id:17,id:"city_centre",of:"culture"},{_id:18,id:"coffee",of:"culture"},{_id:19,id:"culture"},{_id:20,id:"dentist",of:"culture"},{_id:21,id:"eating out",of:"culture"},{_id:22,id:"entertainment"},{_id:23,id:"exibition",of:"culture"},{_id:24,id:"florist",of:"culture"},{_id:25,id:"food, wine & nightlife",of:"culture"},{_id:26,id:"for_kids",of:"culture"},{_id:27,id:"Grodno_local",of:"culture"},{_id:28,id:"gyms & workout",of:"culture"},{_id:29,id:"hoarses",of:"culture"},{_id:30,id:"hospital",of:"culture"},{_id:31,id:"landmarks",of:"shopping"},{_id:32,id:"large_companies",of:"shopping"},{_id:33,id:"local_goods",of:"shopping"},{_id:34,id:"museum",of:"shopping"},{_id:35,id:"nature & parks",of:"shopping"},{_id:36,id:"out_of_town",of:"shopping"},{_id:37,id:"religious",of:"shopping"},{_id:38,id:"romantic",of:"shopping"},{_id:39,id:"shopping"},{_id:40,id:"souveniurs",of:"shopping"},{_id:41,id:"sport",of:"entertainment"},{_id:42,id:"student",of:"entertainment"},{_id:43,id:"swimming",of:"entertainment"},{_id:44,id:"theatre",of:"entertainment"},{_id:45,id:"transport",of:"entertainment"},{_id:46,id:"vegetarian",of:"entertainment"},{_id:47,id:"weird_place",of:"entertainment"}],meta:[{_id:1,id:"id",value:"grodnoexpl"},{_id:2,id:"name",value:"Grodno Explorer"},{_id:3,id:"author",value:"Litskevich"},{_id:4,id:"dataUrl",value:"https://script.google.com/macros/s/AKfycbzWtsvIwdC_3v7fiI03ex4NDwbRXH6g_zl9Vts2BLToyTy4QGI/exec"},{_id:5,id:"description"},{_id:6,id:"architecture"}]}}},function(t,e,n){"use strict";n(1),n(2),n(3);var r=n(0);n(6),n(49),n(36);function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){o(t,e,n[e])})}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const a=/^\{\{([a-zA-Z0-9.:_$|]+)\}\}$/,s=/\{\{([a-zA-Z0-9.:_$|]+)\}\}/g,u={true:!0,false:!1,null:null},c=(t=>e=>t.requestAnimationFrame(()=>e.call(t,t.document)))(window),l=(t,e)=>{const n=t.$boundFnMap||(t.$boundFnMap=new Map);let r=n.get(e);return r||(r=e.bind(t.impl),n.set(e,r)),r},h=t=>["parent","children","owner","impl","app","ctx"].forEach(e=>{delete t[e]}),f=(t,e)=>{const n=new Map;return t.forEach((t,r)=>{r!==e&&n.set(r,t)}),n};function d(t){if(":"===t[0])return p(t);if(!t.includes("{{")){const e=t in u?u[t]:t;return()=>e}return t.match(a)?p(t.slice(2,-2).trim()):function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=t.replace(s,(t,n)=>(e.push(p(n)),"{{"+(e.length-1)+"}}"));return t=>n.replace(/\{\{(\d+)\}\}/g,(n,r)=>{const i=e[r](t);return i||0===i?i:""})}(t)}function p(t){return function(t,e){const n=t.split("|").map(t=>t.trim()),r=n.shift(),i=e(r);return n.length?t=>n.reduce((e,n)=>t.reduce(e,n),i(t)):i}(t,t=>":"===t[0]?(t=>e=>e.string(t))(t.slice(1).trim()):e=>e.prop(t))}const m={"#text":(t,e,n)=>t.textContent=null==n?"":n,disabled:(t,e,n)=>t[e]=!!n||null,class:(t,e,n)=>{n.includes(":")&&(n=(""+n).split(" ").map(t=>{const[e,n]=t.split(":");if(void 0===n)return e;const[r,i]=n.split("==");return(i?r!==i:["","0","false",null].indexOf(r)>-1)?"":e}).join(" ")),t.className=n},selected:(t,e,n)=>t[e]=!!n||null,value:(t,e,n)=>t[e]=null==n?"":n,checked:(t,e,n)=>t[e]=!!n,data:function(t,e,n){this.$dataset=n,n&&Object.keys(n).forEach(e=>{t.dataset[e]=n[e]})},keypress:function(t,e,n){this.setListener("keyup",n?n=>(13!==n.keyCode&&27!==n.keyCode&&(this.$attributes[e](i({value:t.value},t.$dataset),n),setTimeout(()=>t.focus(),0)),!1):null)},enter:function(t,e,n){this.setListener("keyup",n?n=>(13===n.keyCode&&this.$attributes[e](i({value:t.value},t.$dataset),n),13!==n.keyCode&&27!==n.keyCode||t.blur(),!1):null)},toggle:function(t,e,n){this.setListener("change",n?n=>(this.$attributes[e](i({value:t.checked},t.$dataset),n),!1):null)}},y={value:(t,e,n)=>t.value===e,_:(t,e,n)=>e===n};function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){v(t,e,n[e])})}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const b=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_";return(n,r)=>{if(t){const i=t(n);"data-"===e.slice(0,5)?r.data=g({},r.data,{[e.slice(5)]:i in u?u[i]:i}):r[e]=i}}},w=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d(t);return t=>t["$"+e]||(t["$"+e]=(e,r)=>t.emit(n(t),e,r))},E=(t,e)=>{let n=!1;return t.content.forEach(r=>{n=n||r.tag===t.tag+":"+e}),n};function S(t){let{tag:e,attrs:n,uid:r,nodes:i}=t;const o=n.get("ui:each");if(o)return function(t,e){let[n,,r]=t,{tag:i,attrs:o,uid:a,nodes:s}=e;const u={itemId:n},c={tag:"ui:fragment",uid:"each:"+r+a,$each:u,key:o.get("key")};if("<-"===r.slice(0,2)){const t=r.slice(2).split("|").map(t=>t.trim()),e=t.shift(),n=t.length?n=>n.connect(e,e=>({$data:t.reduce((t,e)=>n.reduce(t,e),e)})):t=>t.connect(e,t=>({$data:t}));(c.inits||(c.inits=[])).push(n)}else(c.updates||(c.updates=[])).push(b(d("{:".includes(r[0])?r:"{{"+r+"}}"),"$data"));let l=s;if(s&&s.length){const t=l.find(t=>"ui:empty"===t.tag);t&&(u.emptyNode=t.nodes.map(S),l=l.filter(e=>e!==t));const e=l.find(t=>"ui:loading"===t.tag);e&&(u.loadingNode=e.nodes.map(S),l=l.filter(t=>t!==e))}return u.itemNode=S({tag:i,attrs:o,uid:a,nodes:l}),c}(o.split(" "),{tag:e,attrs:f(n,"ui:each"),uid:r,nodes:i});const a=n.get("ui:if");if(a)return function(t,e){let{tag:n,attrs:r,uid:i,nodes:o}=e;const a={},s={tag:"ui:fragment",uid:"if:"+t+i,key:r.get("key"),$if:a},u="!"===t[0],c=u?t.slice(1):t;if("<-"===c.slice(0,2))(s.inits||(s.inits=[])).push(t=>t.connect(c.slice(2).trim(),u?t=>({$data:!t}):t=>({$data:!!t})));else if("slot:"===c.slice(0,5)){const t=t=>E(t,c.slice(5));(s.updates||(s.updates=[])).push((e,n)=>{n.$data=u?!t(e):t(e)})}else{const t=d("{:".includes(c[0])?c:"{{"+c+"}}");(s.updates||(s.updates=[])).push((e,n)=>{n.$data=u?!t(e):t(e)})}let l=null;if(o&&o.length){const t=o.find(t=>"ui:else"===t.tag),e=o.find(t=>"ui:then"===t.tag);t?(a.else=t.nodes.map(S),l=e?e.nodes:[{tag:n,attrs:r,uid:i,nodes:o.filter(e=>e!==t)}]):e&&(l=[{tag:n,attrs:r,uid:i,nodes:e.nodes}])}return a.then=(l||[{tag:n,attrs:r,uid:i,nodes:o}]).map(S),s}(a,{tag:e,attrs:f(n,"ui:if"),uid:r,nodes:i});const s={tag:e,uid:r,id:n.get("id"),ref:n.get("ui:ref"),nodes:i.map(S)};let u=n.get("ui:props");if(u)if("<-"===u.slice(0,2))(s.inits||(s.inits=[])).push(t=>t.connect(u.slice(2).trim(),t=>t));else{const t=d(u);(s.updates||(s.updates=[])).push((e,n)=>Object.assign(n,t(e)))}return n.forEach((t,e)=>{if("ui:"!==e.slice(0,3)){const n=t.slice(0,2);if("<-"===n){const n=d(t.slice(2).trim());(s.inits||(s.inits=[])).push(t=>t.connect(n(t),t=>({[e]:t})))}else"->"===n?(s.updates||(s.updates=[])).push(b(w(t.slice(2).trim(),e),e)):t.includes("{{")||":"===t[0]?(s.updates||(s.updates=[])).push(b(d(t),e)):(s.initials||(s.initials={}))[e]=t}}),s}const T=new Map,I={},k=t=>{const e="function"==typeof t?t:Object.assign(function(){},t),n=e.NAME=e.NAME||e.name||(t=>(/^function\s+([\w$]+)\s*\(/.exec(t.toString())||[])[1]||Object(r.f)("$C"))(e),i=e.TEMPLATE||e.prototype.TEMPLATE;e.$TEMPLATE=()=>I[n]||(I[n]=i?S(Object(r.g)(i,n)):[]),T.set(n,e)};k({NAME:"ui:fragment"});const _=T.get.bind(T),A=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.forEach(k)},D=()=>Object.keys(I).forEach(t=>{delete I[t]}),C=[],N=(t,e,n)=>{if(t.eachChild(t=>e.has(t.uid)?0:t.done()),!e.size)return;C.unshift("  ");const r=t.children||(t.children=new Map);t.rendering=!0,e.forEach((e,i)=>{let{tag:o,content:a,owner:s,props:u,inits:c,initials:l,ref:h,$if:f,$each:d}=e,p=r.get(i);p||(p=new U(_(o),{props:u,tag:o,ref:h,$if:f,$each:d,uid:i,ctx:n,owner:s,inits:c,initials:l,parent:t}),r.set(i,p)),p.owner=s,p.content=a,p.prevElt=n.cursor,p.up(u)}),t.rendering=!1,t.eachChild(t=>t.isInited?0:t.init()),C.shift()},O=(t,e,n)=>(t.content.forEach((r,i)=>{e?r.tag===t.tag+":"+e&&r.content.forEach(t=>n.set(i,t)):r.tag.slice(0,t.tag.length+1)!==t.tag+":"&&n.set(i,r)}),n),x=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;return e&&e.length?e.reduce((e,n)=>R(t,n,e),n):null},P=(t,e)=>t&&t.length?t.reduce((t,n)=>(n(e,t),t),{}):null;function R(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;return e?e.reduce?e.length?x(t,e,n):n:function(t,e,n){let{tag:r,updates:i,initials:o,inits:a,nodes:s,uid:u,id:c,ref:l,$if:h,$each:f}=n;if("ui:slot"===r)return O(e,c,t);const d=P(i,e),p=x(e,s),m="ui:tag"===r?d.tag:r;return t.set(m+u,{tag:m,id:c,ref:l,owner:e,initials:o,inits:a,$if:h,$each:f,props:d,content:p})}(n,t,e):n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){L(t,e,n[e])})}return t}function L(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const j=window.document;class F{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.elt="#text"===t.tag?j.createTextNode(""):j.createElement(t.tag),this.$attributes={},this.$=t,this.applyAttributes(e)}done(){const t=this.elt,e=this.$listeners;e&&(Object.keys(e).forEach(n=>t.removeEventListener(n,e[n])),this.$listeners=null);const n=t.parentElement;n&&n.removeChild(t),this.elt=this.$attributes=null}set(t){return this.delta=t,this.$.nodes||t&&Object.keys(t).length}render(t){const e=this.elt,n=this.$;n.content&&(e.cursor=null,N(n,n.content,e),e.cursor=null),this.delta&&(this.applyAttributes(this.delta),this.delta=null);const r=t.cursor?t.cursor.nextSibling:t.firstChild;r?e!==r&&t.insertBefore(e,r):t.appendChild(e),t.cursor=e}applyAttributes(t){const e=this.elt,n=this.$attributes;for(let r in t)if(t.hasOwnProperty(r)&&!(y[r]||y._)(e,t[r],n[r])){const n=t[r],i=m[r];if(i)i.call(this,e,r,n);else if("function"==typeof n||this.listeners&&this.listeners.has(r)){const t=this;this.setListener(r,n?n=>(t.$attributes[r](M({value:e.value},this.$dataset),n),!1):null)}else this.setAttribute(r,n)}this.$attributes=t}setAttribute(t,e){null!=e?this.elt.setAttribute(t,e):this.elt.removeAttribute(t)}setListener(t,e){e?(this.listeners||(this.listeners=new Map),this.listeners.has(t)||(this.elt.addEventListener(t,e,!1),this.listeners.set(t,e))):this.listeners&&this.listeners.has(t)&&(this.elt.removeEventListener(t,this.listeners.get(t)),this.listeners.delete(t))}}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){B(t,e,n[e])})}return t}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class U{constructor(t,e){if(Object.assign(this,e),this.parent?(this.api=this.parent.api,this.impl=t?new t({ref:this.ref,api:this.api,props:q({},this.props,this.initials)}):new F(this,q({},this.props,this.initials))):this.api=this.impl=new t,this.ref){const t=this.api[this.ref];this.api[this.ref]=this.impl,this.defer(()=>{this.api[this.ref]=t})}}renderFragment(){const t=new Map;if(this.$each){const e=this.$each,{$data:n}=this.impl,{itemId:r,itemNode:i,emptyNode:o,loadingNode:a}=e,{tag:s,updates:u,initials:c={},nodes:l,uid:h}=i;this.content=new Map,n&&n.length?n.forEach((e,n)=>{const i="".concat(h,"-$").concat(e.id||n),o=Object.create(this);o.impl={[r]:e,[r+"Index"]:n},R(o,{tag:s,initials:c,updates:u,nodes:l,uid:i},t)}):n?n.length||o&&R(this.owner,o,t):a&&R(this.owner,a,t)}else if(this.$if){const e=this.$if,{$data:n}=this.impl,r=n?e.then:e.else;this.content=new Map,R(this,r,t)}else this.content&&this.content.forEach((e,n)=>t.set(n,e));N(this,t,this.ctx)}render(){this.ctx.cursor=this.prevElt,this.impl.render?this.impl.render(this.ctx):"ui:fragment"===this.tag?this.renderFragment():N(this,R(this,this.impl.constructor.$TEMPLATE()),this.ctx)}init(){this.isDone||(this.isInited=!0,this.inits&&(this.inits.forEach(t=>this.defer(t(this))),delete this.inits),this.impl.init&&this.defer(this.impl.init(this)))}done(){this.isDone||(this.isDone=!0,this.impl.done&&this.impl.done(this),this.eachChild(t=>{t.parent=null,t.done()}),this.parent&&this.parent.children.delete(this.uid),this.defered&&(this.defered.forEach(t=>t(this)),delete this.defered),h(this))}defer(t){t&&(this.defered||(this.defered=[])).push(t)}eachChild(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.children;e&&e.forEach(t)}up(t){if(this.isDone)return;if(t&&t.then)return void t.then(t=>this.up(t));const e=this.impl;this.impl.set?this.impl.set(t):t&&Object.entries(t).forEach(t=>{let[n,r]=t;const i=e[n];if(void 0!==r&&r!==i){const t=e["set"+n[0].toUpperCase()+n.slice(1)];t?t.call(e,r):e[n]=r}}),(this.parent.rendering?this:this.parent).render()}prop(t){let e=this.impl.get?this.impl.get():this.impl;const[n,...i]=t.split("."),o=e[Object(r.b)(n,"get")];let a=void 0;if(o)a=o.call(e,this);else{if(!(n in e))return this.owner?this.owner.prop(t):a;a=e[n]}return i.length&&(a=i.reduce((t,e)=>t?t[e]:t,a)),"function"==typeof a?l(this,a):a}connect(t,e){const n=(t,n)=>this.up(q({error:t},e?e(n):n));return t?this.api.emitter.connect(t,n):n(null,this.owner.impl)}emit(t,e){let n=this;for(;n.owner&&"ui:fragment"===n.tag;n=n.owner);t?this.api.emitter.emit(t,e).then(t=>n.up(q({error:null},t))).catch(t=>n.up({error:t})):n.up(q({error:null},e))}string(t){return this.resource(t)||Object(r.e)(t)}resource(t){try{return Object.R(t)}catch(t){return console.error("resource",t),null}}reduce(t,e){try{const[n,...r]=e.split(":"),i=this.resource("reducers."+n);return i?i.apply(this.impl,[t,...r]):t}catch(e){return console.error("reduce",e),t}}}class V{constructor(){const t={},e=this,n=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=t[e];o&&t[e].forEach(t=>t(...r))},i=(e,n)=>{const i=Object(r.f)(),o=t[e]||(t[e]=new Map);return n(),o.set(i,n),()=>o.delete(i)};this.emitter={notify:n,subscribe:i,emit:(t,i)=>{const o=Object(r.j)(t,{data:i}),{type:a,target:s}=o;try{const t=a?e[a]:e,i=(t&&t[Object(r.b)(s,"on")]).call(t,o);return(i&&i.then?i:Promise.resolve(i)).then(t=>(n(a),t))}catch(t){return console.error("emit "+a+":"+s,t),Promise.reject(t)}},connect:(t,n)=>{const o=Object(r.j)(t),{type:a,target:s}=o;return i(a,()=>{try{const t=a?e[a]:e,i=(t&&t[Object(r.b)(s,"get")]).call(t,o);i&&i.then?i.then(t=>n(null,t),n):n(null,i)}catch(t){console.error("connect "+a+":"+s,t),n(t)}})}}}}function K(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];A(...e);const r=new Map([[0,{tag:e[0].NAME}]]);return{run(t,e){const n=new U(t||V,{}),i=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;return r=>N(n,t,e||r.body)};return c(i(r)),()=>{c(i()),n.done(),D()}}}}n.d(e,"a",function(){return K})},function(t,e,n){"use strict";n.r(e);var r=n(63),i=(n(2),n(1),n(0)),o=n(7);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class s extends o.a{constructor(t){let{api:e,ref:n}=t;super(this,{api:e,ref:n,state:{}})}init(){const t=()=>this.emit(this.ref+":hash",{value:window.location.hash.slice(1)});window.addEventListener("hashchange",t),t()}update(t){const{target:e,path:n,params:r}=t,o=("*"===e?this.state.module:e)||"main";this.state=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){a(t,e,n[e])})}return t}({module:o,page:Object(i.b)(o)+Object(i.b)("*"===n[0]?this.state.page:n[0]||"")+"Page",section:"*"===n[1]?this.state.section:n[1]||"main"},r)}getParam(t){return this.state.params[t]}getState(){return this.state}getModuleName(){return this.getItems().find(t=>t.id===this.state.module).name}onHash(t){let{data:{value:e}}=t;this.update(Object(i.j)(e))}getItems(){return Object.R("sitemap")}getSitemap(){return Object.R("sitemap")}getEmpty(){return[]}onUpdate(t){let{path:[e],data:n}=t;this.update(e?{[e]:n}:n)}onClose(t){return this.update({open:!1,newEntry:null,id:null})}onAddNew(t){return this.update({open:!0,newEntry:{},id:null})}onOpenItem(t){let{data:{value:e}}=t;return this.update({open:!0,id:e,newEntry:null})}onSort(t){let{data:{value:e}}=t;return this.update({sortBy:e})}}const u=t=>t?JSON.parse(t):void 0;class c{constructor(){const t=()=>{},e={},n=window.localStorage;this.get=t=>e[t]||(e[t]=u(n.getItem(t))),this.assign=function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;Object.entries(r).forEach(function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e[t]=r,n.setItem(t,JSON.stringify(r))}),i()}}transform(t,e,n){const r=this.get(t);return this.assign({[t]:e(r)},n)}toggleItemProperty(t,e,n){return this.transform(t,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t[e.id]?delete t[e.id]:t[e.id]=e,t},n)}toggleArrayElement(t,e,n){return this.transform(t,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const n=t.find(t=>t.id===e.id);return n?t.reduce((t,e)=>e===n?t:t.concat([e]),[]):t.concat([e])},n)}arrangeArrayElement(t,e,n,r){return this.transform(t,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const r=t.indexOf(t.find(t=>t.id==e));if(r>-1){const e=r+("up"===n?-1:1);if(e>=0&&e<t.length){const n=t[r];t[r]=t[e],t[e]=n}}return t},r)}}var l=n(69);function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){f(t,e,n[e])})}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class d extends o.a{constructor(t){super(t);const{schema:e,name:n="dexie"}=this,r=new l.a(n,1);r.version(1).stores(h({},e,{_meta:"id"})),Object.assign(this,{dexie:r,remote:this.api.firebase,cache:{},dbkeys:Object.keys(e)})}openDb(){this.dexie.open().then(()=>this.log("opened")).catch(this.error)}checkVersion(){this.api.local.get("$version")!==this.version&&this.api.local.assign({$version:this.version})}init(){this.openDb(),this.checkVersion(),this.syncAll()}getMeta(){return this.getTable("_meta").toArray().then(t=>Object(i.a)(t))}getTableMeta(t){return this.getMeta().then(e=>e[t]||{})}syncAll(){return this.getMeta().then(t=>Promise.all(this.dbkeys.map(e=>[e,Object(i.c)(t,"".concat(e,".last_modified"))]).map(t=>{let[e,n=0]=t;return this.remote.getCollection(e,n).then(t=>[e,t,t.reduce((t,e)=>{let{modified_at:n=0}=e;return Math.max(n,t)},n)])}))).then(t=>this.localUpdate(t.reduce((t,e)=>{let[n,r,i]=e;return t._meta.push({id:"".concat(n),last_modified:i}),t[n]=r,this.log("sync",n,i,r),t},{_meta:[]}))).then(this.notify).then(()=>{this.log("sync all: OK")}).catch(t=>this.log("sync all: error: "+t))}syncTable(t){return this.getTableMeta(t).then(e=>this.remote.getCollection(t,Object(i.c)(e,"last_modified")).then(t=>[t,t.reduce((t,e)=>e.modified_at>t?e.modified_at:t,Object(i.c)(e,"last_modified"))])).then(e=>{let[n,r]=e;return this.localUpdate({[t]:n,_meta:{[t]:{id:t,last_modified:r}}})}).then(this.notify).then(()=>{this.log("DB sync OK")}).catch(t=>this.log("DB sync error: "+t))}getTable(t){return this.dexie.table(t)}getOne(t){const[e,n]=t.path;return this.getCollection(e).get(n).then(t=>t?h({},t,{kind:e}):null)}getDict(t){const[e]=t.path;return this.getCollection("dict").where("type").equals(e).toArray()}getIndex(t){t=Object(i.j)(t);const[e,n,r,o]=t.path;if(!this.dbkeys.includes(e))return null;return this.getTable(e).toArray()}eachDelta(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.d;const n={};for(let r in t)this.dbkeys.includes(r)&&(n[r]=t[r].map(e));return n}localUpdate(t){const e=this.eachDelta(t);t._meta&&(e._meta=t._meta);const n=Object.keys(e).map(t=>this.dexie[t].bulkPut(e[t]));return Promise.all(n)}async update(t){return await this.localUpdate(t),this.remote.update(t)}async onUpsert(t){let{path:[e],data:n}=t;n.id||(n.id=this.remote.nextId(e)),await this.update({[e]:[n]}),this.log("onUpsert",n)}async onUpdate(t){let{path:[e],data:n}=t;await this.update({[e]:[n]}),this.log("Updated",n)}async onDelete(t){let{path:[e,n]}=t;await this.update({[e]:[{id:n,status:"deleted"}]}),this.log("Deleted",n)}}class p extends o.a{get fb(){return this.api.firebase}init(){this.fb.listenUser(t=>{t||this.fb.signInAnonymously(),this.api.notify(this.ref)})}getInfo(){const t=this.fb.getCurrentUser();return null!==t&&t.providerData.forEach(function(t){}),t||{}}onLogin(){this.fb.linkProvider()}onLogout(){this.fb.logout()}}n(35),n(6),n(3);var m=n(20);function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){g(t,e,n[e])})}return t}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const v=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=[...e],i={id:"zzz",name:"[reshta]",count:0,selected:!1};if(r.length||!n){const n=t.filter(t=>r.reduce((e,n)=>e&&t.$tags.has(n),!0)),o=n.reduce((t,n)=>(n.$tags.forEach(n=>{if(n===i.id)return t;(t[n]||(t[n]={id:n,name:n,count:0,selected:e.has(n)})).count++}),t),{});return 1===r.length&&e.has(i.id)&&(o[i.id]=Object.assign(i,{selected:!0})),{actualData:n,tagsHash:o}}{const e=t,r=n.split(",").map(t=>({id:t,name:t,count:0,selected:!1})).concat(i);return e.reduce((t,e)=>{let n=!1;return r.forEach(t=>{e.$tags.has(t.id)&&(t.count++,n=!0)}),n||(e.$tags.add(i.id),i.count++),t},{}),{actualData:e,tagsHash:r}}},b=(t,e)=>{const n={};return t.forEach(t=>t.$searchData.replace(/\w{3,}/g,t=>(n[t]=1,""))),Object.keys(n).filter(t=>t.includes(e)).map(t=>({name:t,id:t}))};class w{constructor(t,e){Object.assign(this,t,e)}get ts(){return this.$ts||(this.$ts=this.modified_at||this.created_at)}get $tags(){return this.$$tags||(this.$$tags=new Set((this.tags||"").split(",").filter(Boolean)))}get title(){return this.$title||(this.$title=this.name||this.subject||this.topic||this.id)}get $searchData(){return this.$$searchData||(this.$$searchData=(this.title+" "+Object(m.a)(this.title)+" "+this.preview+" "+Object(m.a)(this.preview)).toLowerCase())}}class E extends o.a{constructor(t){super(t),this.selection=new Set,this.shownLimit=50,this.sortBy="-ts",this.kluqPoshuku=""}setData(t){this.data=t.map(t=>new w(t)),this.notify()}getInfo(){if(!this.data)return{};const t=this.kluqPoshuku?this.data.filter(t=>t.$searchData.includes(this.kluqPoshuku)):this.data,e=this.inputKluqPoshuku?b(this.data,this.inputKluqPoshuku):null,{actualData:n,tagsHash:r}=v(t,this.selection,this.initials);return{tags:Object.values(r).sort((t,e)=>t.selected===e.selected?t.id>e.id?1:-1:t.selected?-1:1),data:Object(i.i)(n,this.sortBy).slice(0,this.shownLimit),kluq:this.kluqPoshuku,kluqInput:this.inputKluqPoshuku,suggestions:this.kluqPoshuku===this.inputKluqPoshuku?null:e,counts:{total:this.data.length,actual:n.length,hasMore:this.shownLimit<n.length}}}onTag(t){let{data:{id:e}}=t;this.selection.has(e)?this.selection.delete(e):this.selection.add(e)}onZnajdzPoKluqu(t){let{data:{value:e}}=t;this.inputKluqPoshuku=e||"",this.kluqPoshuku=e||""}onInputKluq(t){let{data:{value:e}}=t;this.inputKluqPoshuku=e||""}onSortBy(t){let{data:{value:e}}=t;this.sortBy=e||"-ts"}onShowMore(t){let{data:{size:e=50}}=t;this.shownLimit+=e}getNewEntry(){return this.newEntry||{}}onOpenAddNew(t){let{data:e}=t;this.newEntry=y({},e,this.newEntry,{open:!0})}onCancelAddNew(){this.newEntry=y({},this.newEntry,{open:!1})}async onSaveNew(t){let{data:e}=t;delete e.id,await this.upsert(e),this.newEntry=y({},this.newEntry,{data:e,open:!1})}async onUpdate(t){let{path:[e],data:n}=t;await this.update({[e]:[n]})}async onDelete(t){let{path:[e,n]}=t;await this.update({[e]:[{id:n,status:"deleted"}]})}upsert(t,e){return this.log("upsert",t),this.emit("db://upsert/"+this.table,t)}}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class T extends o.a{getResource(t){let{path:e}=t;return Object.R(e[0])}getEnum(t){let{path:e}=t;return Object.R(e[0]).map(t=>(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){S(t,e,n[e])})}return t})({},t,{name:t.name||Object.R(t.id)}))}}class I{init(){if("localhost"===window.location.host)return;const t=window.navigator;"serviceWorker"in t&&(t.serviceWorker.register("/sw.js",{scope:"/"}).then(function(t){console.log("Service Worker Registered")}),t.serviceWorker.ready.then(function(t){console.log("Service Worker Ready")}))}}class k{init(){var t,e,n,r,i,o;"localhost"!==window.location.host&&(t=window,e=document,n="script",r="ga",t.GoogleAnalyticsObject=r,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,i=e.createElement(n),o=e.getElementsByTagName(n)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(i,o),ga("create",this.account,"auto"),ga("send","pageview"))}}n.d(e,"Firebase",function(){return r.a}),n.d(e,"NavigationService",function(){return s}),n.d(e,"LocalStorage",function(){return c}),n.d(e,"DatabaseService",function(){return d}),n.d(e,"UserService",function(){return p}),n.d(e,"Collection",function(){return E}),n.d(e,"ResService",function(){return T}),n.d(e,"SWRunner",function(){return I}),n.d(e,"GARunner",function(){return k})},function(t,e,n){"use strict";n(2),n(1),n(62);function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){i(t,e,n[e])})}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}let o=1;n(6);function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){s(t,e,n[e])})}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const u={enum:"EnumField",ref:"RefField",text:"TextareaField",dict:"DictField",bool:"SwitchField"};var c=n(37);e.a=[class{TEMPLATE(){return'\n<div class="bg-gray">\n  <FilterChip ui:each="chip of chips" data="{{chip}}" filter="{{this}}" index="{{chipIndex}}"/>\n  <FilterAppendChip filter="{{this}}" value="{{search}}" menu="{{suggestedChips}}"/>\n</div>'}getThis(){return this}setData(t){this.suggestedChips=this.data=(t||[]).map(t=>r({},t,{name:t.id,field:t.id}))}getChips(){return this.chips||(this.chips=[])}addNewChip(t){let{field:e}=t;const n=this.data.find(t=>t.field===e),i=this.getChips().concat(r({},n,{op:"eq",id:o++}));this.assign({chips:i,suggestedChips:this.data,search:""})}removeChip(t){const e=this.getChips().filter(e=>e.id!==t);this.assign({chips:e}),this.onChanged(e)}updateChip(t,e){const n=this.getChips(),r=n.find(e=>e.id===t);Object.assign(r,e),this.onChanged(n)}onChanged(t){const e=t.reduce((t,e)=>(t[e.field+"__"+t.op]=e.value,t),{});this.changed({[this.field||"filter"]:e})}applySuggestion(t){const e=this.data.filter(e=>e.name.includes(t));this.assign(e.length?{search:t,suggestedChips:e}:{})}},class{get TEMPLATE(){return'\n    <div class="docs-demo columns">\n      <div class="column col-9 col-sm-12">\n        <div class="form-horizontal">\n          <FormField ui:each="field of fields" ui:props="{{field}}" data="{{data}}" onChange="{{up}}"/>\n        </div>\n      </div>\n    </div>'}getUp(){return t=>{this.data=a({},this.data,t),this.change&&this.change({data:this.data})}}},class{get TEMPLATE(){return'\n    <ui:fragment ui:if="fieldShown">\n      <ui:tag tag="{{fieldType}}" ui:props="{{fieldProps}}" onChange="{{fieldChange}}"/>\n    </ui:fragment>'}getFieldChange(){return t=>{let{value:e}=t;return this.onChange({[this.id]:e})}}getFieldType(){return u[this.type]||"TextField"}getFieldShown(){return!0}getFieldProps(){const t=(this.data||{})[this.id];return a({},this,{typeSpec:this.typeSpec?this.typeSpec.replace(/\{\{(\w+)\}\}/g,(t,e)=>this.getData()[e]):null,caption:this.id,value:void 0===t?null:t})}},...Object(c.a)('<body>\n\n    <template id="Container">\n        <div class="container bg-gray">\n            <ui:slot />\n        </div>\n    </template>\n\n    <template id="PageRouter">\n        <ui:tag tag="{{page}}" ui:props="{{params}}" />\n    </template>\n\n    <template id="NavTree">\n        <ul class="nav">\n            <li class="nav-item {{item.class}}" ui:each="item of data">\n                <a href="#{{item.id}}">\n                    <span>{{item.name}}</span>\n                    <span ui:if="item.label" class="label label-error">{{item.label}}</span>\n                </a>\n                <NavTree ui:if="item.subs" data="{{item.subs}}" />\n            </li>\n        </ul>\n    </template>\n\n    <template id="Panel">\n        <div class="panel" style="{{style}}">\n            <div class="panel-header">\n                <div class="panel-title">\n                    <ui:slot id="title" />\n                </div>\n            </div>\n            <div class="panel-nav" ui:if="slot:nav">\n                <ui:slot id="nav" />\n            </div>\n            <div class="panel-body">\n                <ui:slot />\n            </div>\n            <div class="panel-footer" ui:if="slot:footer">\n                <ui:slot id="footer" />\n            </div>\n        </div>\n    </template>\n\n    <template id="Card">\n        <div class="card">\n            <div class="card-image" ui:if="image">\n                <img src="{{image}}" class="img-responsive" />\n            </div>\n            <div class="card-header">\n                <a href="#{{id}}">\n                    <h5 class="card-title">{{title}}</h5>\n                </a>\n                <div ui:if="subtitle" class="card-subtitle text-gray">{{subtitle}}</div>\n            </div>\n            <div class="card-body">\n                <ui:slot />\n            </div>\n            <div class="card-footer">\n                <ui:slot id="footer" />\n            </div>\n        </div>\n    </template>\n\n    <template id="Sidebar">\n        <div class="off-canvas off-canvas-sidebar-show">\n            <a class="off-canvas-toggle btn btn-primary btn-action show-lg"\n               href="#sidebar">\n                <i class="icon icon-menu" />\n            </a>\n            <div id="sidebar" class="off-canvas-sidebar">\n                <div class="fixed">\n                    <ui:slot id="aside" />\n                </div>\n            </div>\n            <a class="off-canvas-overlay" href="#"></a>\n            <div class="off-canvas-content">\n                <ui:slot />\n            </div>\n        </div>\n    </template>\n\n    <template id="Navbar">\n        <header class="navbar bg-secondary" style="height:48px">\n            <section class="navbar-section mx-2">\n                <ui:slot />\n            </section>\n            <section class="navbar-center" ui:if="logo">\n                <img src="{{logo}}" alt="" height="40" width="40" />\n            </section>\n            <section class="navbar-section mx-2">\n                <ui:slot id="right" />\n            </section>\n        </header>\n    </template>\n\n    <template id="Chips">\n        <div class="ui mini labels">\n            <span class="chip bg-success:{{tag.selected}} bg-secondary:{{tag.selected|not}} badge:{{tag.selected|not}}"\n                  data-badge="{{tag.count|ifAbove:3}}"\n                  data-id="{{tag.id}}"\n                  click="{{click}}"\n                  ui:each="tag of data">\n                <span>{{tag.name}}<small ui:if="tag.selected2">{{tag.count}}</small></span>\n            </span>\n        </div>\n    </template>\n\n    <template id="Tabs">\n        <ul class="tab tab-block">\n            <li class="tab-item" ui:each="item of data">\n                <a href="#tab?tab={{item.value}}">{{item.name}}</a>\n            </li>\n        </ul>\n    </template>\n\n    <template id="Modal">\n        <div class="modal modal active:{{open}}">\n            <a class="modal-overlay" aria-label="Close" click="{{close}}"></a>\n            <div class="modal-container">\n                <div class="modal-header">\n                    <a class="btn btn-clear float-right" aria-label=":close" click="{{close}}"></a>\n                    <div class="modal-title h5" ui:if="title">{{title}}</div>\n                    <ui:slot id="header" />\n                </div>\n                <div class="modal-body" style="max-height: 70vh;">\n                    <div class="content">\n                        <ui:slot />\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <ui:slot id="footer" />\n                </div>\n            </div>\n        </div>\n    </template>\n</body>','<body id="app">\n    <template id="Toast">\n        <div ui:if="!closed"\n             class="toast toast-primary"\n             style="position:fixed; right:5rem; bottom:1rem; width: 20rem;">\n            <button class="btn btn-clear float-right"\n                    click="->"\n                    data-closed="true"></button>\n            <p>{{message}}</p>\n        </div>\n    </template>\n\n    <template id="SearchBar">\n        <div class="form-autocomplete">\n            \x3c!-- autocomplete input container --\x3e\n            <div class="form-autocomplete-input form-input input-sm has-icon-right">\n                <div class="input-group input-inline">\n                    <input class="form-input" type="search"\n                           placeholder=":kluq_poshuku"\n                           keypress="{{input}}"\n                           value="{{value}}" />\n                </div>\n                <i class="form-icon icon icon-cross" data-value=""\n                   click="{{enter}}"\n                   ui:if="value"></i>\n            </div>\n            <ul class="menu" ui:if="suggestions">\n                <li class="menu-item" ui:each="item of suggestions" data-value="{{item.id}}" click="{{enter}}">\n                    <a>\n                        <div class="tile tile-centered">\n                            <div class="tile-icon">\n                            </div>\n                            <div class="tile-content">\n                                {{item.name}}\n                            </div>\n                        </div>\n                    </a>\n                </li>\n            </ul>\n        </div>\n\n    </template>\n\n    <template id="BigRedButton">\n        <button class="btn tooltip tooltip-left fixed bg-error circle"\n                style="right:1rem; bottom:1rem; width: 2rem;"\n                data="{{data}}"\n                data-tooltip="{{tooltip}}"\n                click="{{action}}">\n            <i class="icon icon-plus"></i>\n        </button>\n    </template>\n\n    <template id="Hero">\n        <div class="hero bg-dark p-0">\n            <div class="hero-body px-2">\n                <h1>{{title}}</h1>\n            </div>\n        </div>\n    </template>\n\n    <template id="IFrame">\n        <iframe width="100%" height="450" frameborder="0"\n                style="border:0"\n                src="{{src}}"\n                allowfullscreen="1"></iframe>`\n    </template>\n\n    <template id="Select">\n        <select class="form-select"\n                change="{{change}}">\n            <option selected="{{selected}}"\n                    value=""\n                    ui:if="!required">...</option>\n            <option ui:each="option of options"\n                    selected="{{selected}}"\n                    value="{{option.id}}">{{optionName}}</option>\n        </select>\n    </template>\n</body>','<body>\n\n    <template id="Box">\n        <div class="container bg-gray">\n            <div class="columns">\n                <div class="column col-6 col-sm-12">\n                    <ui:slot id="1" />\n                </div>\n                <div class="column col-6 col-sm-12 my-2">\n                    <ui:slot id="2" />\n                </div>\n            </div>\n        </div>\n    </template>\n</body>','<body id="user">\n\n  <template id="UserBar">\n    <div class="float-right">\n      <ui:fragment ui:if="isAnonymous">\n        <ui:then>\n          <a click="-> user:login" class="anchor" aria-hidden="true">:login</a>\n        </ui:then>\n        <ui:else>\n          <UserPanel ui:props="<- user:info" />\n        </ui:else>\n      </ui:fragment>\n    </div>\n  </template>\n\n  <template id="UserPanel">\n    <div class="tile tile-centered">\n      <div class="tile-icon">\n        <div class="example-tile-icon" ui:if="photoURL">\n          <figure class="avatar avatar">\n            <img src="{{photoURL}}" alt=":avatar" />\n          </figure>\n        </div>\n      </div>\n      <div class="tile-content">\n        <div class="tile-title" ui:if="displayName">{{displayName}}</div>\n        <a class="tile-subtitle text-gray" href="mailto:{{email}}">{{email}}</a>\n      </div>\n      <div class="tile-action">\n        <div class="dropdown dropdown-right">\n          <a class="btn btn-link dropdown-toggle" tabindex="0"><i class="icon icon-more-vert"></i></a>\n          <ul class="menu">\n            <li class="menu-item" ui:each="item of <-nav://items">\n              <a href="#{{item.id}}">{{item.name}}</a>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </template>\n\n  <template id="UserInfo">\n    <div class="ui raised segment">\n      <a class="ui yellow image label">\n        <i class="jp flag"></i>\n        <span>{{profile.name}}</span>\n        <div class="detail">Citizen</div>\n      </a>\n      <div class="ui divided selection list">\n        <div class="item" each="contact of contacts">\n          <div class="ui {{contact.color}} horizontal label">{{contact.type}}</div>\n          <a href="{{contact.link}}" target="_blank">{{contact.text}}</a>\n        </div>\n      </div>\n    </div>\n  </template>\n</body>','<body id="app">\n    <template id="TextField">\n        <div class="form-group">\n            <div class="col-3 col-sm-12">\n                <label class="form-label" for="input-example-4">{{caption}}</label>\n            </div>\n            <div class="col-9 col-sm-12">\n                <input class="form-input" id="input-example-4" type="text"\n                       placeholder="{{caption}}" value="{{value}}" change="{{onChange}}">\n            </div>\n        </div>\n    </template>\n    <template id="SwitchField">\n        <div class="form-group">\n            <div class="col-9 col-sm-12 col-ml-auto">\n                <label class="form-switch">\n                    <input type="checkbox"\n                           toggle="{{onChange}}"\n                           checked="{{value}}"><i class="form-icon"></i> {{caption}}\n                </label>\n            </div>\n        </div>\n    </template>\n    <template id="TextareaField">\n        <div class="form-group">\n            <div class="col-3 col-sm-12">\n                <label class="form-label" for="input-example-6">{{caption}}</label>\n            </div>\n            <div class="col-9 col-sm-12">\n                <textarea class="form-input" style="min-height: 15vw"\n                          placeholder="{{caption}}"\n                          rows="3" change="{{onChange}}"\n                          value="{{value}}"></textarea>\n            </div>\n        </div>\n    </template>\n    <template id="RadioField">\n        <div class="form-group">\n            <div class="col-3 col-sm-12">\n                <label class="form-label">{{caption}}</label>\n            </div>\n            <div class="col-9 col-sm-12">\n                <label class="form-radio">\n                    <input type="radio" name="gender"><i class="form-icon"></i> Male\n                </label>\n                <label class="form-radio">\n                    <input type="radio" name="gender" checked=""><i class="form-icon"></i> Female\n                </label>\n            </div>\n        </div>\n    </template>\n    <template id="EnumField">\n        <div class="form-group">\n            <div class="col-3 col-sm-12">\n                <label class="form-label">{{caption}}</label>\n            </div>\n            <div class="col-9 col-sm-12">\n                <Select change="{{onChange}}" options="<- res://enum/{{typeSpec}}" />\n            </div>\n        </div>\n    </template>\n    <template id="DictField">\n        <div class="form-group">\n            <div class="col-3 col-sm-12">\n                <label class="form-label">{{caption}}</label>\n            </div>\n            <div class="col-9 col-sm-12">\n                <Select change="{{onChange}}" options="<- db://dict/{{typeSpec}}" />\n            </div>\n        </div>\n    </template>\n    <template id="RefField">\n        <div class="form-group">\n            <div class="col-3 col-sm-12">\n                <label class="form-label">{{caption}}</label>\n            </div>\n            <div class="col-9 col-sm-12">\n                <Select change="{{onChange}}" options="<- {{typeSpec}}" />\n            </div>\n        </div>\n    </template>\n</body>')]},function(t,e,n){"use strict";n.r(e);n(2),n(1),n(3);var r=n(14),i=n(0);function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){a(t,e,n[e])})}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class s{getRoutes(){return this._routes||(this._routes=this.res("routes").map(t=>o({},t,{id:""+t.id,title:""+t.title,places:t.places.split(","),photo:t.photo||"assets/placeholder.png",link:t.link||"//google.com/search?q="+Object(r.a)(t.title)})))}getPlaces(){return this._places||(this._places=this.res("places").map(t=>o({},t,{id:""+t.id,title:""+t.title,tags:[t.tags,t.tags2,t.tags3].filter(Boolean),photo:t.photo||"assets/placeholder.png",link:t.link||"//google.com/search?q="+Object(r.a)(t.title)})))}onToggleTag(t,e){return this.api.local.toggleItemProperty("selectedTags",t,e)}onSelectRoute(t,e){return this.api.local.assign({selectedRoute:t,selectedPlaces:t.places.map(t=>({id:t}))},e)}onTogglePlace(t,e){return this.api.local.toggleArrayElement("selectedPlaces",t,e)}onArrangePlace(t,e){let{id:n,dir:r}=t;return this.api.local.arrangeArrayElement("selectedPlaces",n,r,e)}getSelectedRoute(){return this.api.local.get("selectedRoute")||this.getRoutes()[0]||{}}getSelectedPlaces(){const t=this.getPlaces();return(localStore.get("selectedPlaces")||[]).map(e=>{let{id:n}=e;return t.find(t=>t.id===n)}).filter(Boolean)}getSelectedPlacesIds(){return(localStore.get("selectedPlaces")||[]).map(t=>{let{id:e}=t;return e}).join(",")}getSuggestedPhoto(){const t=this.getPlaces(),e=(localStore.get("selectedPlaces")||[]).map(e=>{let{id:n}=e;return t.find(t=>t.id===n)})[0];return e?e.photo:"https://postim.by/post_photo/19370/xbfblucF1518108503.jpg"}getFilteredPlaces(){const t=localStore.get("selectedTags")||{},e=localStore.get("selectedPlaces")||[],n=Object.keys(t),r=this.getPlaces();return(n.length?r.filter(t=>n.reduce((e,n)=>e&&t.tags.includes(n),!0)):r).map(t=>o({},t,{selected:e.some(e=>e.id===t.id)}))}getFilteredTags(){const t=localStore.get("selectedTags")||{};return Object.values(this.getFilteredPlaces().reduce((e,n)=>(n.tags.forEach(n=>{e[n]||(e[n]={id:n,name:n,selected:!!t[n],count:0}),e[n].count++}),e),{}))}getRouteMapUrl(){const t=this.getSelectedPlaces(),e=t.length;return Object(i.k)({target:"https://www.google.com/maps/embed/v1/directions",params:{mode:"walking",origin:Object(r.a)(e>0?t[0].address:"Драматический театр"),destination:Object(r.a)(e>1?t[e-1].address:"Жилибера парк"),waypoints:e>2&&"".concat((t.slice(1,e-1)||[]).map(t=>{let{address:e}=t;return Object(r.a)(e)}).join("|"))||null,key:"AIzaSyBqTz8FtKj2ghZxmxNnJVicYCpcuHUNRiM"}})}}n.d(e,"GeoService",function(){return s})},function(t,e,n){t.exports=n(81)},function(t,e,n){"use strict";n.r(e),function(t){n(2),n(1);var e=n(76),r=n(78),i=n(68),o=n(77),a=n(79),s=n(37),u=n(70),c=n(71),l=n(72),h=n(73),f=n(0),d=n(74),p=n(75),m=n(14);function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.R=(t=>e=>t[e]||(t[e]=Object(f.c)(t,e)))(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){y(t,e,n[e])})}return t}({},d.a,p.a.result,{reducers:m.b}));const g={},v=()=>{g.done=Object(e.a)(...Object(s.a)(i.a,u.a,h.a,c.a,l.a),...r.a,...Object.values(o),...Object.values(a)).run()};var b;(b=t.hot)?(b.dispose(t=>g.done()),b.accept(),b.data?window.firebase.app().delete().then(v):v()):v()}.call(this,n(38)(t))},function(t,e,n){t.exports=n(24)("native-function-to-string",Function.toString)},function(t,e,n){var r=n(19)("meta"),i=n(13),o=n(15),a=n(11).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(10)(function(){return u(Object.preventExtensions({}))}),l=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[r].w},onFreeze:function(t){return c&&h.NEED&&u(t)&&!o(t,r)&&l(t),t}}},function(t,e,n){var r=n(26),i=n(58),o=n(44);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var r=n(27);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(18),i=n(29),o=n(87);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),l=o(a,c);if(t&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var r=n(30),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(27);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(11),i=n(5),o=n(26);t.exports=n(9)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var r=n(8).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(18),i=n(45).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var r=n(93),i=n(94),o=n(46),a=n(18);t.exports=n(95)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){var r=n(4)("unscopables"),i=Array.prototype;null==i[r]&&n(12)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(25),i=n(21),o=n(16),a=n(12),s=n(46),u=n(96),c=n(41),l=n(97),h=n(4)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,p,m,y,g){u(n,e,p);var v,b,w,E=function(t){if(!f&&t in k)return k[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+" Iterator",T="values"==m,I=!1,k=t.prototype,_=k[h]||k["@@iterator"]||m&&k[m],A=_||E(m),D=m?T?E("entries"):A:void 0,C="Array"==e&&k.entries||_;if(C&&(w=l(C.call(new t)))!==Object.prototype&&w.next&&(c(w,S,!0),r||"function"==typeof w[h]||a(w,h,d)),T&&_&&"values"!==_.name&&(I=!0,A=function(){return _.call(this)}),r&&!g||!f&&!I&&k[h]||a(k,h,A),s[e]=A,s[S]=d,m)if(v={values:T?A:E("values"),keys:y?A:E("keys"),entries:D},g)for(b in v)b in k||o(k,b,v[b]);else i(i.P+i.F*(f||I),e,v);return v}},function(t,e,n){"use strict";var r=n(59),i=n(23),o=n(41),a={};n(12)(a,n(4)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(15),i=n(31),o=n(42)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var r=n(5),i=n(40),o=n(4)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[o])?e:i(n)}},function(t,e,n){var r=n(30),i=n(28);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){var r=n(27),i=n(4)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){"use strict";var r=n(48);n(21)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,n){"use strict";var r=n(10);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){n(9)&&"g"!=/./g.flags&&n(11).f(RegExp.prototype,"flags",{configurable:!0,get:n(33)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";(function(t,e){n(1),n(36),n(6);!function(t,r){"object"==typeof exports&&void 0!==e?e.exports=r():"function"==typeof define&&n(50)?define(r):(t=t||self).firebase=r()}(void 0,function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,n)},n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=r(t[n],e[n]));return t}var i=function(t){function n(e,r){var i=t.call(this,r)||this;return i.code=e,i.name="FirebaseError",Object.setPrototypeOf(i,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,o.prototype.create),i}return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(n,t),n}(Error),o=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,o=e[0]||{},s=this.service+"/"+t,u=this.errors[t],c=u?(r=o,u.replace(a,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",l=this.serviceName+": "+c+" ("+s+").",h=new i(s,l),f=0,d=Object.keys(o);f<d.length;f++){var p=d[f];"_"!==p.slice(-1)&&(p in h&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),h[p]=o[p])}return h},t}(),a=/\{\$([^}]+)}/g,s=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};function u(t,e){var n=new h(t,e);return n.subscribe.bind(n)}var c,l,h=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=f),void 0===r.error&&(r.error=f),void 0===r.complete&&(r.complete=f);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function f(){}(l=c||(c={}))[l.DEBUG=0]="DEBUG",l[l.VERBOSE=1]="VERBOSE",l[l.INFO=2]="INFO",l[l.WARN=3]="WARN",l[l.ERROR=4]="ERROR",l[l.SILENT=5]="SILENT";var d,p=c.INFO,m=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString();switch(e){case c.DEBUG:case c.VERBOSE:console.log.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;case c.INFO:console.info.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;case c.WARN:console.warn.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;case c.ERROR:console.error.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},y=function(){function t(t){this.name=t,this._logLevel=p,this._logHandler=m}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in c))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,c.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,c.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,c.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,c.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,c.ERROR].concat(t))},t}(),g=((d={})["no-app"]="No Firebase App '{$name}' has been created - call Firebase App.initializeApp()",d["bad-app-name"]="Illegal App name: '{$name}",d["duplicate-app"]="Firebase App named '{$name}' already exists",d["app-deleted"]="Firebase App named '{$name}' already deleted",d["duplicate-service"]="Firebase service named '{$name}' already registered",d["invalid-app-argument"]="firebase.{$name}() takes either no argument or a Firebase App instance.",d),v=new o("app","Firebase",g),b="[DEFAULT]",w=[],E=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=r(void 0,t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){w.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){w=w.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,r=Object.keys(t.services_);n<r.length;n++)for(var i=r[n],o=0,a=Object.keys(t.services_[i]);o<a.length;o++){var s=a[o];e.push(t.services_[i][s])}return Promise.all(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=b),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==b?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;r(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(w.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),w=[])},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw v.create("app-deleted",{name:this.name_})},t}();E.prototype.name&&E.prototype.options||E.prototype.delete||console.log("dc");var S=new y("@firebase/app");if("object"==typeof self&&self.self===self&&void 0!==self.firebase){S.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var T=self.firebase.SDK_VERSION;T&&0<=T.indexOf("LITE")&&S.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var I=function t(){var e=function(t){var e={},n={},i={},o={__esModule:!0,initializeApp:function(n,r){(void 0===r&&(r={}),"object"!=typeof r||null===r)&&(r={name:r});var i=r;void 0===i.name&&(i.name=b);var a=i.name;if("string"!=typeof a||!a)throw v.create("bad-app-name",{name:String(a)});if(s(e,a))throw v.create("duplicate-app",{name:a});var u=new t(n,i,o);return c(e[a]=u,"create"),u},app:a,apps:null,SDK_VERSION:"6.2.4",INTERNAL:{registerService:function(e,s,c,l,h){if(void 0===h&&(h=!1),n[e])throw v.create("duplicate-service",{name:e});function f(t){if(void 0===t&&(t=a()),"function"!=typeof t[e])throw v.create("invalid-app-argument",{name:e});return t[e]()}return n[e]=s,l&&(i[e]=l,u().forEach(function(t){l("create",t)})),void 0!==c&&r(f,c),o[e]=f,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._getService.bind(this,e).apply(this,h?t:[])},f},removeApp:function(t){c(e[t],"delete"),delete e[t]},factories:n,useAsService:l}};function a(t){if(!s(e,t=t||b))throw v.create("no-app",{name:t});return e[t]}function u(){return Object.keys(e).map(function(t){return e[t]})}function c(t,e){for(var r=0,o=Object.keys(n);r<o.length;r++){var a=l(0,o[r]);if(null===a)return;i[a]&&i[a](e,t)}}function l(t,e){return"serverAuth"===e?null:e}return o.default=o,Object.defineProperty(o,"apps",{get:u}),a.App=t,o}(E);return e.INTERNAL=n({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){r(e,t)},createSubscribe:u,ErrorFactory:o,deepExtend:r}),e}(),k=I.initializeApp;return I.initializeApp=function(){return function(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(t){return!1}}()&&S.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\n      to false and "main" to true:\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),k.apply(void 0,arguments)},I})}).call(this,n(17),n(38)(t))},function(t,e,n){"use strict";(function(e,r){var i,o;n(62),n(51),n(35),n(49),n(3),n(1),n(36),n(6),n(65),n(2);i=void 0,o=function(t){try{(function(){var n,i;t=t&&t.hasOwnProperty("default")?t.default:t,(i=n||(n={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var o=n.INFO,a=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case n.DEBUG:case n.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(r));break;case n.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(r));break;case n.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(r));break;case n.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(r));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},s=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=a}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in n))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,n.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,n.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,n.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,n.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,n.ERROR].concat(t))},t}(),u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function c(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,p=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return c(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,a=this.errors[t],s=a?(r=i,a.replace(y,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",u=this.serviceName+": "+s+" ("+o+").",c=new p(o,u),l=0,h=Object.keys(i);l<h.length;l++){var f=h[l];"_"!==f.slice(-1)&&(f in c&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),c[f]=i[f])}return c},t}(),y=/\{\$([^}]+)}/g,g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},v=v||{},b=g;function w(t){return"string"==typeof t}function E(t){return"number"==typeof t}function S(t,e){t=t.split("."),e=e||b;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function T(){}function I(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function k(t){return"array"==I(t)}function _(t){var e=I(t);return"array"==e||"object"==e&&"number"==typeof t.length}function A(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),C=0;function N(t,e,n){return t.call.apply(t.bind,arguments)}function O(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?N:O).apply(null,arguments)}function P(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var R=Date.now||function(){return+new Date};function M(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,(t.prototype.constructor=t).yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function L(){this.j=this.j,this.i=this.i}L.prototype.j=!1,L.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[D]||(this[D]=++C))},L.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(w(t))return w(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=w(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function q(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function U(t){return/^[\s\xa0]*$/.test(t)}var V,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function z(t,e){return-1!=t.indexOf(e)}function G(t,e){return t<e?-1:e<t?1:0}t:{var W=b.navigator;if(W){var Q=W.userAgent;if(Q){V=Q;break t}}V=""}function H(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Y(t){var e,n={};for(e in t)n[e]=t[e];return n}var X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<X.length;o++)n=X[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function J(t){return J[" "](t),t}J[" "]=T;var Z,tt,et=z(V,"Opera"),nt=z(V,"Trident")||z(V,"MSIE"),rt=z(V,"Edge"),it=rt||nt,ot=z(V,"Gecko")&&!(z(V.toLowerCase(),"webkit")&&!z(V,"Edge"))&&!(z(V,"Trident")||z(V,"MSIE"))&&!z(V,"Edge"),at=z(V.toLowerCase(),"webkit")&&!z(V,"Edge");function st(){var t=b.document;return t?t.documentMode:void 0}t:{var ut="",ct=(tt=V,ot?/rv:([^\);]+)(\)|;)/.exec(tt):rt?/Edge\/([\d\.]+)/.exec(tt):nt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(tt):at?/WebKit\/(\S+)/.exec(tt):et?/(?:Version)[ \/]?(\S+)/.exec(tt):void 0);if(ct&&(ut=ct?ct[1]:""),nt){var lt=st();if(null!=lt&&lt>parseFloat(ut)){Z=String(lt);break t}}Z=ut}var ht,ft={};function dt(t){return e=t,n=function(){for(var e=0,n=K(String(Z)).split("."),r=K(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=G(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||G(0==a[2].length,0==s[2].length)||G(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e},r=ft,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var pt=b.document;ht=pt&&nt?st()||("CSS1Compat"==pt.compatMode?parseInt(Z,10):5):void 0;var mt=!nt||9<=Number(ht),yt=nt&&!dt("9"),gt=function(){if(!b.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{b.addEventListener("test",T,e),b.removeEventListener("test",T,e)}catch(t){}return t}();function vt(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function bt(t,e){if(vt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ot){t:{try{J(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,this.screenY=r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=w(t.pointerType)?t.pointerType:wt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}vt.prototype.b=function(){this.Ja=!1},M(bt,vt);var wt={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,yt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),St=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++St,this.X=this.Z=!1}function It(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function kt(t){this.src=t,this.a={},this.b=0}function _t(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=j(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(It(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=At(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Ct={};function Nt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(k(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=Ft(r),e&&e[Et]?e.Ba(n,r,A(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(k(e)){for(var o=0;o<e.length;o++)Nt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[Et]?t.Aa(e,n,A(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=A(i)?!!i.capture:!!i;if(a&&!mt)return null;var s,u,c=Lt(t);if(c||(t[Dt]=c=new kt(t)),(n=c.add(e,n,r,a,o)).proxy)return n;if(s=Mt,r=u=mt?function(t){return s.call(u.src,u.listener,t)}:function(t){if(!(t=s.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function xt(t){if(!E(t)&&t&&!t.X){var e=t.src;if(e&&e[Et])_t(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(_t(n,t),0==n.b&&(n.src=null,e[Dt]=null)):It(t)}}}function Pt(t){return t in Ct?Ct[t]:Ct[t]="on"+t}function Rt(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&xt(t),n.call(r,e)}function Mt(t,e){return!!t.X||Rt(t,mt?new bt(e,this):e=new bt(e||S("window.event"),this))}function Lt(t){return(t=t[Dt])instanceof kt?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(t){return"function"==I(t)?t:(t[jt]||(t[jt]=function(e){return t.handleEvent(e)}),t[jt])}function qt(){L.call(this),this.c=new kt(this),(this.J=this).B=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&_t(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ja}M(qt,L),qt.prototype[Et]=!0,(d=qt.prototype).addEventListener=function(t,e,n,r){Nt(this,t,e,n,r)},d.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(k(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=A(i)?!!i.capture:!!i,r=Ft(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=At(a=e.a[n],r,i,o))&&(It(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=Lt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=At(n,r,i,o)),(r=-1<e?n[e]:null)&&xt(r))}(this,t,e,n,r)},d.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(w(t))t=new vt(t,n);else if(t instanceof vt)t.target=t.target||n;else{var i=t;$(t=new vt(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Bt(a,r,!0,t)&&i}if(i=Bt(a=t.a=n,r,!0,t)&&i,i=Bt(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Bt(a=t.a=e[o],r,!1,t)&&i;return i},d.G=function(){if(qt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.B=null},d.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},d.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=b.JSON.stringify;function Vt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kt(){this.b=this.a=null}Vt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var zt,Gt=new Vt(function(){return new Wt},function(t){t.reset()});function Wt(){this.next=this.b=this.a=null}function Qt(t){b.setTimeout(function(){throw t},0)}function Ht(t,e){var n;zt||(n=b.Promise.resolve(void 0),zt=function(){n.then($t)}),Yt||(zt(),Yt=!0),Xt.add(t,e)}Kt.prototype.add=function(t,e){var n=Gt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Kt;function $t(){for(var t;r=n=void 0,r=null,(n=Xt).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Qt(t)}var e=Gt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,r;Yt=!1}function Jt(t,e){qt.call(this),this.b=t||1,this.a=e||b,this.f=x(this.gb,this),this.g=R()}function Zt(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function te(t,e,n){if("function"==I(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:b.setTimeout(t,e||0)}function ee(t,e,n){L.call(this),this.f=null!=n?x(t,n):t,this.c=e,this.b=x(this.ab,this),this.a=[]}function ne(t){t.U=te(t.b,t.c),t.f.apply(null,t.a)}function re(t){L.call(this),this.b=t,this.a={}}M(Jt,qt),(d=Jt.prototype).ba=!1,d.L=null,d.gb=function(){if(this.ba){var t=R()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Zt(this),this.start()))}},d.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=R())},d.G=function(){Jt.N.G.call(this),Zt(this),delete this.a},M(ee,L),(d=ee.prototype).ea=!1,d.U=null,d.Ua=function(t){this.a=arguments,this.U?this.ea=!0:ne(this)},d.G=function(){ee.N.G.call(this),this.U&&(b.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},d.ab=function(){this.U=null,this.ea&&(this.ea=!1,ne(this))},M(re,L);var ie=[];function oe(t,e,n,r){k(n)||(n&&(ie[0]=n.toString()),n=ie);for(var i=0;i<n.length;i++){var o=Nt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){H(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function se(){}re.prototype.G=function(){re.N.G.call(this),ae(this)},re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=new qt;function ce(t){vt.call(this,"serverreachability",t)}function le(t){ue.dispatchEvent(new ce(ue,t))}function he(t){vt.call(this,"statevent",t)}function fe(t){ue.dispatchEvent(new he(ue,t))}function de(t){vt.call(this,"timingevent",t)}function pe(t,e){if("function"!=I(t))throw Error("Fn must not be null and must be a function");return b.setTimeout(function(){t()},e)}M(ce,vt),M(he,vt),M(de,vt);var me={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},ye={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function ge(){}function ve(t){var e;return(e=t.a)||(e=t.a={}),e}function be(){}ge.prototype.a=null;var we,Ee={OPEN:"a",ib:"b",Na:"c",rb:"d"};function Se(){vt.call(this,"d")}function Te(){vt.call(this,"c")}function Ie(){}function ke(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new re(this),this.O=_e,t=it?125:void 0,this.P=new Jt(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}M(Se,vt),M(Te,vt),M(Ie,ge),we=new Ie;var _e=45e3,Ae={},De={};function Ce(t,e,n){t.F=1,t.f=tn(Qe(e)),t.l=n,t.H=!0,Oe(t,null)}function Ne(t,e,n,r){t.F=1,t.f=tn(Qe(e)),t.l=null,t.H=n,Oe(t,r)}function Oe(t,e){t.v=R(),Re(t),t.D=Qe(t.f),Ze(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ee(x(t.Ka,t,t.a),t.J)),oe(t.I,t.a,"readystatechange",t.eb),e=t.h?Y(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),le(1)}function xe(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Pe(t,n);if(i==De){4==e&&(t.c=4,fe(14),r=!1);break}if(i==Ae){t.c=4,fe(15),r=!1;break}qe(t,i)}4==e&&0==n.length&&(t.c=1,fe(16),r=!1),t.b=t.b&&r,r||(Fe(t),je(t))}function Pe(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?De:(n=Number(e.substring(n,r)),isNaN(n)?Ae:(r+=1)+n>e.length?De:(e=e.substr(r,n),t.A=r+n,e))}function Re(t){t.R=R()+t.O,Me(t,t.O)}function Me(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=pe(x(t.bb,t),e)}function Le(t){t.i&&(b.clearTimeout(t.i),t.i=null)}function je(t){t.g.Da()||t.m||t.g.na(t)}function Fe(t){Le(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Zt(t.P),ae(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function qe(t,e){try{t.g.Ga(t,e),le(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(_(t)||w(t))F(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(_(t)||w(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(w(t))return t.split("");if(_(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ue(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ue)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ve(t,e){ze(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t))}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(d=ke.prototype).setTimeout=function(t){this.O=t},d.eb=function(t){t=t.target;var e=this.B;e&&3==Qn(t)?e.Ua():this.Ka(t)},d.Ka=function(t){try{if(t==this.a)t:{var e=Qn(this.a),n=this.a.ya(),r=this.a.T();if(!(e<3||3==e&&!it&&!this.a.aa())){this.m||4!=e||7==n||le(8==n||r<=0?3:2),Le(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=Hn(this.a,"X-HTTP-Initial-Response");if(a&&!U(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,fe(12),Fe(this),je(this);break t}this.s=!0,qe(this,s)}this.H?(xe(this,e,o),it&&this.b&&3==e&&(oe(this.I,this.P,"tick",this.cb),this.P.start())):qe(this,o),4==e&&Fe(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Re(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,fe(12)):(this.c=0,fe(13)),Fe(this),je(this)}}}catch(t){}},d.cb=function(){if(this.a){var t=Qn(this.a),e=this.a.aa();this.A<e.length&&(Le(this),xe(this,t,e),this.b&&4!=t&&Re(this))}},d.cancel=function(){this.m=!0,Fe(this)},d.bb=function(){this.i=null;var t=R();0<=t-this.R?(2!=this.F&&(le(3),fe(17)),Fe(this),this.c=2,je(this)):Me(this,this.R-t)},(d=Ue.prototype).C=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},d.K=function(){return Ke(this),this.a.concat()},d.get=function(t,e){return ze(this.b,t)?this.b[t]:e},d.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},d.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof We?(this.h=void 0!==e?e:t.h,He(this,t.f),this.j=t.j,Ye(this,t.b),Xe(this,t.i),this.a=t.a,$e(this,mn(t.c)),this.g=t.g):t&&(n=String(t).match(Ge))?(this.h=!!e,He(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Xe(this,n[4]),this.a=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.g=en(n[7]||"")):(this.h=!!e,this.c=new ln(null,this.h))}function Qe(t){return new We(t)}function He(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.b=n?en(e,!0):e}function Xe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function $e(t,e,n){var r,i;e instanceof ln?(t.c=e,r=t.c,(i=t.h)&&!r.f&&(hn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=nn(e,un)),t.c=new ln(e,t.h))}function Je(t,e,n){t.c.set(e,n)}function Ze(t,e,n){k(n)||(n=[String(n)]),pn(t.c,e,n)}function tn(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^R()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return w(t)?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?sn:an,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",nn(n,cn)),t.join("")},We.prototype.resolve=function(t){var e=Qe(this),n=!!t.f;n?He(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Ye(e,t.b):n=null!=t.i;var r=t.a;if(n)Xe(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(z(i,"./")||z(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?$e(e,mn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var on=/[#\/\?@]/g,an=/[#\?:]/g,sn=/[#\?]/g,un=/[#\?@]/g,cn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function hn(t){t.a||(t.a=new Ue,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function fn(t,e){hn(t),e=yn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ve(t.a,e))}function dn(t,e){return hn(t),e=yn(t,e),ze(t.a.b,e)}function pn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),B(n)),t.b+=n.length)}function mn(t){var e=new ln;return e.c=t.c,t.a&&(e.a=new Ue(t.a),e.b=t.b),e}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function vn(t){var e=t.a.F.a;if(null!=e)fe(4),e?(fe(10),ar(t.a,t,!1)):(fe(11),ar(t.a,t,!0));else{t.b=new ke(t,void 0,void 0),t.b.h=t.h,e=hr(e=t.a,e.Y()?t.f:null,t.i),fe(4),Ze(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Je(e,n,r),Ne(t.b,e,!1,t.f)}}function bn(){this.a=this.b=null}function wn(){this.a=new Ue}function En(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[D]||(t[D]=++C)):e.charAt(0)+t}function Sn(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||In,t=b.PerformanceNavigationTiming?0<(t=b.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(b.ka&&b.ka.Ea&&b.ka.Ea()&&b.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new wn),this.b=null,this.c=[]}(d=ln.prototype).add=function(t,e){hn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},d.forEach=function(t,e){hn(this),this.a.forEach(function(n,r){F(n,function(n){t.call(e,n,r,this)},this)},this)},d.K=function(){hn(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},d.C=function(t){hn(this);var e=[];if(w(t))dn(this,t)&&(e=q(e,this.a.get(yn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=q(e,t[n])}return e},d.set=function(t,e){return hn(this),this.c=null,dn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},d.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},d.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},M(function(){},function(){}),(d=gn.prototype).M=null,d.$=function(t){return this.a.$(t)},d.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},d.Da=function(){return!1},d.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Hn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Hn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void cr(e,2)}this.f=r[0]}else(e=this.a).m=this.c,cr(e,2)}else 1==this.M&&(this.g?fe(6):"11111"==e?(fe(5),this.g=!0,(!nt||10<=Number(ht))&&(this.c=200,this.b.cancel(),fe(11),ar(this.a,this,!0))):(fe(7),this.g=!1))},d.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,vn(this)):1==this.M&&(this.g?(fe(11),ar(this.a,this,!0)):(fe(10),ar(this.a,this,!1)));else{0==this.M?fe(8):1==this.M&&fe(9);var t=this.a;t.m=this.c,cr(t,2)}},d.Y=function(){return this.a.Y()},d.ma=function(){return this.a.ma()},wn.prototype.add=function(t){this.a.set(En(t),t)},wn.prototype.C=function(){return this.a.C()};var In=10;function kn(t,e){!t.a&&(z(e,"spdy")||z(e,"quic")||z(e,"h2"))&&(t.f=t.g,t.a=new wn,t.b&&(Cn(t,t.b),t.b=null))}function _n(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function An(t){return t.b?1:t.a?t.a.a.c:0}function Dn(t,e){return t.b?t.b==e:!!t.a&&(e=En(e),ze(t.a.a.b,e))}function Cn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=En(e),n=ze(t.a.a.b,n)),n&&Ve(t.a.a,En(e)))}function On(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return B(t.c);var e=t.c;return F(t.a.C(),function(t){e=e.concat(t.j)}),e}function xn(){}function Pn(){this.a=new xn}function Rn(t,e,n){var r=n||"";try{Be(t,function(t,n){var i=t;A(t)&&(i=Ut(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Mn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Tn.prototype.cancel=function(){var t;this.c=On(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(F(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},xn.prototype.stringify=function(t){return b.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return b.JSON.parse(t,void 0)};var Ln=b.JSON.parse;function jn(t){qt.call(this),this.headers=new Ue,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Fn,this.D=this.F=!1}M(jn,qt);var Fn="",qn=/^https?$/i,Bn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Kn(t),Gn(t)}function Kn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function zn(t){if(t.b&&void 0!==v&&(!t.s[1]||4!=Qn(t)||2!=t.T()))if(t.l&&4==Qn(t))te(t.Fa,0,t);else if(t.dispatchEvent("readystatechange"),4==Qn(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(Ge)[1]||null;if(!o&&b.self&&b.self.location){var a=b.self.location.protocol;o=a.substr(0,a.length-1)}i=!qn.test(o?o.toLowerCase():"")}e=i}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.h=6,t.f=t.za()+" ["+t.T()+"]",Kn(t))}finally{Gn(t)}}}function Gn(t,e){if(t.a){Wn(t);var n=t.a,r=t.s[0]?T:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Wn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(b.clearTimeout(t.m),t.m=null)}function Qn(t){return t.a?t.a.readyState:0}function Hn(t,e){return t.a?t.a.getResponseHeader(e):null}function Yn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;var i;if(i="",H(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,w(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(r=t.indexOf("?"))<0||n<r){r=n;var o=""}else o=t.substring(r+1,n);n=(t=[t.substr(0,r),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Je(t,e,n),t}function Xn(t){this.f=[],this.F=new bn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!S("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=S("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Sa=S("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Qa=S("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=S("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ja=new Pn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function $n(t){if(Jn(t),3==t.u){var e=t.P++,n=Qe(t.B);Je(n,"SID",t.H),Je(n,"RID",e),Je(n,"TYPE","terminate"),nr(t,n),(e=new ke(t,e,void 0)).F=2,e.f=tn(Qe(n)),n=!1,b.navigator&&b.navigator.sendBeacon&&(n=b.navigator.sendBeacon(e.f.toString(),"")),!n&&b.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=R(),Re(e)}lr(t)}function Jn(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(b.clearTimeout(t.l),t.l=null),sr(t),t.b.cancel(),t.h&&(E(t.h)&&b.clearTimeout(t.h),t.h=null)}function Zn(t,e){t.f.push(new Sn(t.Ra++,e)),3==t.u&&tr(t)}function tr(t){_n(t.b)||t.h||(t.h=!0,Ht(t.Ia,t),t.A=0)}function er(t,e){var n;n=e?e.W:t.P++;var r=Qe(t.B);Je(r,"SID",t.H),Je(r,"RID",n),Je(r,"AID",t.O),nr(t,r),t.g&&t.i&&Yn(r,t.g,t.i),n=new ke(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Cn(t.b,n),Ce(n,r,e)}function nr(t,e){t.c&&Be({},function(t,n){Je(e,n,t)})}function rr(t,e,n){n=Math.min(t.f.length,n);var r=t.c?x(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),s=!1;else try{Rn(l,a,"req"+c+"_")}catch(t){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function ir(t){t.a||t.l||(t.S=1,Ht(t.Ha,t),t.v=0)}function or(t){return!(t.a||t.l||3<=t.v||(t.S++,t.l=pe(x(t.Ha,t),ur(t,t.v)),t.v++,0))}function ar(t,e,n){var r=e.l;r&&kn(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=hr(t,null,t.ha),tr(t)}function sr(t){null!=t.s&&(b.clearTimeout(t.s),t.s=null)}function ur(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function cr(t,e){if(2==e){var n=null;t.c&&(n=null);var r=x(t.fb,t);n||(n=new We("//www.google.com/images/cleardot.gif"),b.location&&"http"==b.location.protocol||He(n,"https"),tn(n)),function(t,e){var n=new se;if(b.Image){var r=new Image;r.onload=P(Mn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=P(Mn,n,r,"TestLoadImage: error",!1,e),r.onabort=P(Mn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=P(Mn,n,r,"TestLoadImage: timeout",!1,e),b.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else fe(2);t.u=0,t.c&&t.c.ta(e),lr(t),Jn(t)}function lr(t){t.u=0,t.m=-1,t.c&&(0==On(t.b).length&&0==t.f.length||(t.b.c.length=0,B(t.f),t.f.length=0),t.c.sa())}function hr(t,e,n){var r,i,o,a,s,u,c=(r=n)instanceof We?Qe(r):new We(r,void 0);if(""!=c.b)e&&Ye(c,e+"."+c.b),Xe(c,c.i);else{var l,h=b.location;l=e?e+"."+h.hostname:h.hostname,i=h.protocol,o=l,a=+h.port,s=n,u=new We(null,void 0),i&&He(u,i),o&&Ye(u,o),a&&Xe(u,a),s&&(u.a=s),c=u}return t.V&&H(t.V,function(t,e){Je(c,e,t)}),e=t.j,n=t.I,e&&n&&Je(c,e,n),Je(c,"VER",t.wa),nr(t,c),c}function fr(){}function dr(){if(nt&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function pr(t,e){qt.call(this),this.a=new Xn(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=t,n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!U(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!U(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function mr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function yr(){Te.call(this),this.status=1}function gr(t){this.a=t}(d=jn.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ve(this.H):ve(we),this.a.onreadystatechange=x(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ue(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r=w(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:w(t)?t.charAt(e):t[e]}(o.K()),n=b.FormData&&t instanceof b.FormData,!(0<=j(Bn,e))||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Wn(this),0<this.o&&((this.D=(i=this.a,nt&&dt(9)&&E(i.timeout)&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.Ca,this)):this.m=te(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},d.Ca=function(){void 0!==v&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},d.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Gn(this))},d.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Gn(this,!0)),jn.N.G.call(this)},d.Fa=function(){this.j||(this.w||this.l||this.g?zn(this):this.$a())},d.$a=function(){zn(this)},d.T=function(){try{return 2<Qn(this)?this.a.status:-1}catch(t){return-1}},d.za=function(){try{return 2<Qn(this)?this.a.statusText:""}catch(t){return""}},d.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},d.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},d.ya=function(){return this.h},d.Ya=function(){return w(this.f)?this.f:String(this.f)},(d=Xn.prototype).wa=8,d.u=1,d.Da=function(){return 0==this.u},d.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new ke(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?$(r=Y(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&w(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),Je(i=Qe(this.B),"RID",t),Je(i,"CVER",22),this.o&&this.j&&Je(i,"X-HTTP-Session-Id",this.j),nr(this,i),this.g&&r&&Yn(i,this.g,r),Cn(this.b,n),this.W?(Je(i,"$req",e),Je(i,"SID","null"),n.S=!0,Ce(n,i,null)):Ce(n,i,e),this.u=2}}else 3==this.u&&(t?er(this,t):0==this.f.length||_n(this.b)||er(this))},d.Ha=function(){this.l=null,this.a=new ke(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Qe(this.pa);Je(t,"RID","rpc"),Je(t,"SID",this.H),Je(t,"CI",this.ia?"0":"1"),Je(t,"AID",this.O),nr(this,t),Je(t,"TYPE","xmlhttp"),this.g&&this.i&&Yn(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Ne(this.a,t,!0,this.ga)},d.Ga=function(t,e){if(0!=this.u&&(this.a==t||Dn(this.b,t)))if(this.m=t.o,!t.s&&Dn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(k(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;sr(this),this.a.cancel(),this.a=null}or(this),fe(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=pe(x(this.Za,this),6e3));if(An(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else cr(this,11)}else if((t.s||this.a==t)&&sr(this),!U(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&E(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Hn(r,"X-Client-Wire-Protocol"))&&kn(this.b,i),this.j&&(r=Hn(r,"X-HTTP-Session-Id")))&&(this.I=r,Je(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=hr(this,this.Y()?this.ga:null,this.ha),r.s?(Nn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Le(r),Re(r)),this.a=r):ir(this),0<this.f.length&&tr(this)}else"stop"!=r[0]&&"close"!=r[0]||cr(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?cr(this,7):$n(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},d.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,or(this),fe(19))},d.na=function(t){var e,n,r=null;if(this.a==t){sr(this),this.a=null;var i=2}else{if(!Dn(this.b,t))return;r=t.j,Nn(this.b,t),i=1}if(this.m=t.o,0!=this.u)if(t.b)1==i?(r=R()-t.v,ue.dispatchEvent(new de(ue,t.l?t.l.length:0,r,this.A)),tr(this)):ir(this);else{var o=t.c;if(3==o||0==o&&0<this.m||(1!=i||(n=t,An((e=this).b)>=e.b.f-(e.h?1:0)||(e.h?(e.f=n.j.concat(e.f),0):1==e.u||2==e.u||e.A>=(e.Pa?0:e.Qa)||(e.h=pe(x(e.Ia,e,n),ur(e,e.A)),e.A++,0))))&&(2!=i||!or(this)))switch(r&&0<r.length&&(t=this.b,t.c=t.c.concat(r)),o){case 1:cr(this,5);break;case 4:cr(this,10);break;case 3:cr(this,6);break;default:cr(this,2)}}},d.fb=function(t){fe(t?2:1)},d.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new jn(this.La)).F=this.R,t},d.ma=function(){return!!this.c&&!0},d.Y=function(){return this.R},(d=fr.prototype).va=function(){},d.ua=function(){},d.ta=function(){},d.sa=function(){},d.Ta=function(){},dr.prototype.a=function(t,e){return new pr(t,e)},M(pr,qt),(d=pr.prototype).addEventListener=function(t,e,n,r){pr.N.addEventListener.call(this,t,e,n,r)},d.removeEventListener=function(t,e,n,r){pr.N.removeEventListener.call(this,t,e,n,r)},d.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;fe(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new gn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=Yn(e,t.g,t.i)),(t=t.w).i=n,e=hr(t.a,null,t.i),fe(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,vn(t)):(Ze(e,"MODE","init"),!t.a.o&&t.a.j&&Ze(e,"X-HTTP-Session-Id",t.a.j),t.b=new ke(t,void 0,void 0),t.b.h=t.h,Ne(t.b,e,!1,null),t.M=0)},d.close=function(){$n(this.a)},d.Xa=function(t){if(w(t)){var e={};e.__data__=t,Zn(this.a,e)}else this.h?((e={}).__data__=Ut(t),Zn(this.a,e)):Zn(this.a,t)},d.G=function(){this.a.c=null,delete this.f,$n(this.a),delete this.a,pr.N.G.call(this)},M(mr,Se),M(yr,Te),M(gr,fr),gr.prototype.va=function(){this.a.dispatchEvent("a")},gr.prototype.ua=function(t){this.a.dispatchEvent(new mr(t))},gr.prototype.ta=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.sa=function(){this.a.dispatchEvent("b")};var vr=P(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},dr);dr.prototype.createWebChannel=dr.prototype.a,pr.prototype.send=pr.prototype.Xa,pr.prototype.open=pr.prototype.Wa,pr.prototype.close=pr.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,ye.COMPLETE="complete",(be.EventType=Ee).OPEN="a",Ee.CLOSE="b",Ee.ERROR="c",Ee.MESSAGE="d",qt.prototype.listen=qt.prototype.Aa,jn.prototype.listenOnce=jn.prototype.Ba,jn.prototype.getLastError=jn.prototype.Ya,jn.prototype.getLastErrorCode=jn.prototype.ya,jn.prototype.getStatus=jn.prototype.T,jn.prototype.getStatusText=jn.prototype.za,jn.prototype.getResponseJson=jn.prototype.Va,jn.prototype.getResponseText=jn.prototype.aa,jn.prototype.send=jn.prototype.ca;var br,wr,Er={createWebChannelTransport:vr,ErrorCode:me,EventType:ye,WebChannel:be,XhrIo:jn},Sr=Er.createWebChannelTransport,Tr=Er.ErrorCode,Ir=Er.EventType,kr=Er.WebChannel,_r=Er.XhrIo,Ar=t.SDK_VERSION,Dr=new s("@firebase/firestore");function Cr(){return Dr.logLevel===n.DEBUG?br.DEBUG:Dr.logLevel===n.SILENT?br.SILENT:br.ERROR}function Nr(t){switch(t){case br.DEBUG:Dr.logLevel=n.DEBUG;break;case br.ERROR:Dr.logLevel=n.ERROR;break;case br.SILENT:Dr.logLevel=n.SILENT;break;default:Dr.error("Firestore ("+Ar+"): Invalid value passed to `setLogLevel`")}}function Or(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(Dr.logLevel<=n.DEBUG){var o=r.map(Pr);Dr.debug.apply(Dr,["Firestore ("+Ar+") ["+t+"]: "+e].concat(o))}}function xr(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(Dr.logLevel<=n.ERROR){var i=e.map(Pr);Dr.error.apply(Dr,["Firestore ("+Ar+"): "+t].concat(i))}}function Pr(t){if("string"==typeof t)return t;var e=Lr.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function Rr(t){var e="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Mr(t,e){t||Rr(e)}(wr=br||(br={}))[wr.DEBUG=0]="DEBUG",wr[wr.ERROR=1]="ERROR",wr[wr.SILENT=2]="SILENT";var Lr=function(){function t(){}return t.setPlatform=function(e){t.platform&&Rr("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||Rr("Platform not set"),t.platform},t}();function jr(){return Lr.getPlatform().emptyByteString}var Fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qr=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return c(e,t),e}(Error);function Br(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new qr(Fr.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function Ur(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vr(t,e){return void 0!==t?t:e}function Kr(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gr(t){for(var e in Mr(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wr(t,e){if(0!==e.length)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ui(e.length,"argument")+".")}function Qr(t,e,n){if(e.length!==n)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires "+ui(n,"argument")+", but was called with "+ui(e.length,"argument")+".")}function Hr(t,e,n){if(e.length<n)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ui(n,"argument")+", but was called with "+ui(e.length,"argument")+".")}function Yr(t,e,n,r){if(e.length<n||e.length>r)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ui(e.length,"argument")+".")}function Xr(t,e,n,r){ei(t,e,si(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Xr(t,e,n,r)}function Jr(t,e,n,r){ei(t,e,n+" option",r)}function Zr(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function ti(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(ri(u))}var c=ri(r);throw new qr(Fr.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function ei(t,e,n,r){if(!("object"===e?ni(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=ri(r);throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function ni(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ri(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Rr("Unknown wrong type: "+typeof t);if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}function ii(t,e,n){if(void 0===n)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+si(e)+" argument, but it was undefined.")}function oi(t,e,n){zr(e,function(e,r){if(n.indexOf(e)<0)throw new qr(Fr.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function ai(t,e,n,r){var i=ri(r);return new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires its "+si(n)+" argument to be a "+e+", but it was: "+i)}function si(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ui(t,e){return t+" "+e+(1===t?"":"s")}var ci=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return Mr(20===e.length,"Invalid auto ID: "+e),e},t}();function li(t,e){return t<e?-1:e<t?1:0}function hi(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function fi(t){return t+"\0"}function di(){if("undefined"==typeof Uint8Array)throw new qr(Fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function pi(){if(!Lr.getPlatform().base64Available)throw new qr(Fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var mi,yi,gi=function(){function t(t){pi(),this._binaryString=t}return t.fromBase64String=function(e){Qr("Blob.fromBase64String",arguments,1),Xr("Blob.fromBase64String","string",1,e),pi();try{return new t(Lr.getPlatform().atob(e))}catch(e){throw new qr(Fr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(Qr("Blob.fromUint8Array",arguments,1),di(),!(e instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return Qr("Blob.toBase64",arguments,0),pi(),Lr.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){Qr("Blob.toUint8Array",arguments,0),di();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return li(this._binaryString,t._binaryString)},t}(),vi=Br(gi,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),bi=function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},wi="(default)",Ei=function(){function t(t,e){this.projectId=t,this.database=e||wi}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===wi},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return li(this.projectId,t.projectId)||li(this.database,t.database)},t}(),Si=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),Ti="__name__",Ii=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&Rr("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Rr("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):Rr("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,Mr(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return Mr(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return Mr(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return Mr(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(0<=t.indexOf("//"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return 0<t.length}))},e.EMPTY_PATH=new e([]),e}(Ii),_i=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.isValidIdentifier=function(t){return _i.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===Ti},e.keyField=function(){return new e([Ti])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new qr(Fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qr(Fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?a=!a:"."!==s||a?r+=s:o(),i++}if(o(),a)throw new qr(Fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(Ii),Di=function(){function t(e){this.path=e,Mr(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ki.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ki.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ki(e.slice()))},t.fromPathString=function(e){return new t(ki.fromString(e))},t.EMPTY=new t(new ki([])),t}(),Ci=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};(yi=mi||(mi={})).All="all",yi.ListenStreamIdle="listen_stream_idle",yi.ListenStreamConnectionBackoff="listen_stream_connection_backoff",yi.WriteStreamIdle="write_stream_idle",yi.WriteStreamConnectionBackoff="write_stream_connection_backoff",yi.OnlineStateTimeout="online_state_timeout",yi.ClientMetadataRefresh="client_metadata_refresh",yi.LruGarbageCollection="lru_garbage_collection";var Ni=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new qr(Fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),Oi=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw xr("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),Mr(0<=e,"Attempted to schedule an operation with a negative delay of "+e),Mr(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=Ni.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&Rr("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){Mr(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){Mr(t===mi.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==mi.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);Mr(0<=e,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),xi="",Pi="",Ri="",Mi="";function Li(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Fi(e)),e=ji(t.get(n),e);return Fi(e)}function ji(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=xi+Ri;break;case xi:n+=xi+Mi;break;default:n+=o}}return n}function Fi(t){return t+xi+Pi}function qi(t){var e=t.length;if(Mr(2<=e,"Invalid path "+t),2===e)return Mr(t.charAt(0)===xi&&t.charAt(1)===Pi,"Non-empty path "+t+" had length 2"),ki.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(xi,o);switch((a<0||n<a)&&Rr('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case Pi:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case Ri:i+=t.substring(o,a),i+="\0";break;case Mi:i+=t.substring(o,a+1);break;default:Rr('Invalid encoded resource path: "'+t+'"')}o=a+2}return new ki(r)}var Bi=function(){function t(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qr(Fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?li(this.nanoseconds,t.nanoseconds):li(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),Ui=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Bi(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Bi(0,0)),t}(),Vi=function(){function t(t,e){this.comparator=t,this.root=e||zi.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zi.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zi.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Ki(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Ki(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Ki(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Ki(this.root,t,this.comparator,!0)},t}(),Ki=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){Mr(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return 0<this.nodeStack.length},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),zi=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Rr("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw Rr("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw Rr("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Gi=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new zi(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();zi.EMPTY=new Gi;var Wi=function(){function t(t){this.comparator=t,this.data=new Vi(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Qi(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Qi(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Qi=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Hi=new Vi(Di.comparator);function Yi(){return Hi}function Xi(){return Yi()}var $i=new Vi(Di.comparator);function Ji(){return $i}var Zi=new Vi(Di.comparator);function to(){return Zi}var eo=new Wi(Di.comparator);function no(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=eo,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ro=new Wi(li);function io(){return ro}var oo,ao,so=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,Mr(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&Mr(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;Mr(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&Mr(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=s.applyToLocalView(e,e,this.localWriteTime));for(var i=e,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(t)&&(e=s.applyToLocalView(e,i,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},no())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&hi(this.mutations,t.mutations)&&hi(this.baseMutations,t.baseMutations)},t}(),uo=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){Mr(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=to(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),co=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Rr("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),lo=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return Mr(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mo(t).iterate({index:Zo.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=po(n),go(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=po(e),go(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=yo(t),a=mo(t);return a.add({}).next(function(s){Mr("number"==typeof s,"Auto-generated key is not a number");var u=new so(s,e,n,r),c=i.serializer.toDbMutationBatch(i.userId,u);i.documentKeysByBatchId[s]=u.keys();for(var l=[],h=0,f=r;h<f.length;h++){var d=f[h],p=ta.key(i.userId,d.key.path,s);l.push(a.put(c)),l.push(o.put(p,ta.PLACEHOLDER)),l.push(i.indexManager.addToCollectionParentIndex(t,d.key.path.popLast()))}return co.waitFor(l).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return mo(t).get(e).next(function(t){return t?(Mr(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?co.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return mo(t).iterate({index:Zo.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Mr(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mo(t).loadAll(Zo.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ta.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return yo(t).iterate({range:i},function(r,i,a){var s=r[0],u=r[1],c=r[2],l=qi(u);if(s===n.userId&&e.path.isEqual(l))return mo(t).get(c).next(function(t){if(!t)throw Rr("Dangling document-mutation reference found: "+r+" which points to "+c);Mr(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))});a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Wi(li),i=[];return e.forEach(function(e){var o=ta.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=yo(t).iterate({range:a},function(t,i,o){var a=t[0],s=t[1],u=t[2],c=qi(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(s)}),co.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;Mr(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),Mr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=ta.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Wi(li);return yo(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],l=qi(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(t,s)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(mo(t).get(e).next(function(t){if(null===t)throw Rr("Dangling document-mutation reference found, which points to "+e);Mr(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),co.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return fo(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),co.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return co.resolve();var r=IDBKeyRange.lowerBound(ta.prefixForUser(e.userId)),i=[];return yo(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=qi(t[1]);i.push(o)}else r.done()}).next(function(){Mr(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return ho(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return go(t).get(this.userId).next(function(t){return t||new Jo(e.userId,-1,"")})},t}();function ho(t,e,n){var r=ta.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return yo(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()}).next(function(){return a})}function fo(t,e,n){var r=t.store(Zo.store),i=t.store(ta.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(t,e,n){return s++,n.delete()});o.push(u.next(function(){Mr(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=ta.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return co.waitFor(o).next(function(){return c})}function po(t){return t instanceof Uint8Array?(Mr("YES"===r.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function mo(t){return Ca.getStore(t,Zo.store)}function yo(t){return Ca.getStore(t,ta.store)}function go(t){return Ca.getStore(t,Jo.store)}(ao=oo||(oo={}))[ao.QueryCache=0]="QueryCache",ao[ao.SyncEngine=1]="SyncEngine";var vo=function(){function t(t,e){Mr((1&(this.generatorId=t))===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=2,t},t.prototype.after=function(t){return this.seek(t+2),this.next()},t.prototype.seek=function(t){Mr((1&t)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forQueryCache=function(){return new t(oo.QueryCache,2)},t.forSyncEngine=function(){return new t(oo.SyncEngine)},t}(),bo="SimpleDb",wo=function(){function t(e){this.db=e,12.2===t.getIOSVersion(f())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.openOrCreate=function(e,n,r){return Mr(t.isAvailable(),"IndexedDB not supported in current environment."),Or(bo,"Opening database:",e),new co(function(i,o){var a=window.indexedDB.open(e,n);a.onsuccess=function(e){var n=e.target.result;i(new t(n))},a.onblocked=function(){o(new qr(Fr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new qr(Fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(t){Or(bo,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new So(a.transaction);r.createOrUpgrade(n,i,t.oldVersion,Ho).next(function(){Or(bo,"Database upgrade to version "+Ho+" complete")})}}).toPromise()},t.delete=function(t){return Or(bo,"Removing database:",t),Io(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===r.env.USE_MOCK_PERSISTENCE;var e=f(),n=t.getIOSVersion(e),i=0<n&&n<10,o=t.getAndroidVersion(e),a=0<o&&o<4.5;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||i||a)},t.getStore=function(t,e){return t.store(e)},t.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){var r=So.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),co.reject(t)}).toPromise();return i.catch(function(){}),r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),Eo=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return Io(this.dbCursor.delete())},t}(),So=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new Ci,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=_o(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(Or(bo,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return Mr(!!e,"Object store not part of transaction: "+t),new To(e)},t}(),To=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){return Io(void 0!==e?(Or(bo,"PUT",this.store.name,t,e),this.store.put(e,t)):(Or(bo,"PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},t.prototype.add=function(t){return Or(bo,"ADD",this.store.name,t,t),Io(this.store.add(t))},t.prototype.get=function(t){var e=this;return Io(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Or(bo,"GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Or(bo,"DELETE",this.store.name,t),Io(this.store.delete(t))},t.prototype.count=function(){return Or(bo,"COUNT",this.store.name),Io(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){Or(bo,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new co(function(n,r){e.onerror=function(t){var e=_o(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new co(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Eo(i),a=e(i.primaryKey,i.value,o);if(a instanceof co){var s=a.catch(function(t){return o.done(),co.reject(t)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return co.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(Mr(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Io(t){return new co(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=_o(t.target.error);n(e)}})}var ko=!1;function _o(t){var e=wo.getIOSVersion(f());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new qr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ko||(ko=!0,setTimeout(function(){throw r},0)),r}}return t}var Ao=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=vo.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return Ui.fromTimestamp(new Bi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return No(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Do(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return Mr(0<e.targetCount,"Removing from an empty query cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Do(t).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(t,u)))}).next(function(){return co.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return Do(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return Co(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,Ca.getStore(n,sa.store)).put(sa.key,e);var n},t.prototype.saveQueryData=function(t,e){return Do(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Do(t).iterate({range:i,index:oa.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Oo(t);return e.forEach(function(e){var a=Li(e.path);i.push(o.put(new aa(n,a))),i.push(r.referenceDelegate.addReference(t,e))}),co.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Oo(t);return co.forEach(e,function(e){var o=Li(e.path);return co.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Oo(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Oo(t),i=no();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=qi(t[1]),o=new Di(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=Li(e.path),r=IDBKeyRange.bound([n],[fi(n)],!1,!0),i=0;return Oo(t).iterate({index:aa.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return Do(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function Do(t){return Ca.getStore(t,oa.store)}function Co(t){return wo.getStore(t,sa.store).get(sa.key).next(function(t){return Mr(null!==t,"Missing metadata row."),t})}function No(t){return Co(t).next(function(t){return t.highestListenSequenceNumber})}function Oo(t){return Ca.getStore(t,aa.store)}var xo=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return Di.comparator(t.key,e.key)},t}(),Po=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n)||this;return a.data=r,a.proto=o,a.hasLocalMutations=!!i.hasLocalMutations,a.hasCommittedMutations=!!i.hasCommittedMutations,a}return c(e,t),e.prototype.field=function(t){return this.data.field(t)},e.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},e.prototype.value=function(){return this.data.value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.data.isEqual(t.data)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):Rr("Trying to compare documents on fields that don't exist")},e}(xo),Ro=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return c(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(xo),Mo=function(t){function e(e,n){return t.call(this,e,n)||this}return c(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(xo),Lo=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){zr(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return Gr(this.inner)},t}(),jo=function(){function t(){this.changes=Yi(),this.documentSizes=new Lo(function(t){return t.toString()})}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this,r=this.assertChanges().get(e);return r?co.resolve(r):this.getFromCache(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},t.prototype.getEntries=function(t,e){var n=this;return this.getAllFromCache(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},t.prototype.apply=function(t){var e=this.applyChanges(t);return this.changes=null,e},t.prototype.assertChanges=function(){return Mr(null!==this.changes,"Changes have already been applied."),this.changes},t}(),Fo="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",qo=function(){function t(t,e,n){this.serializer=t,this.indexManager=e,this.keepDocumentChangeLog=n,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=wo.getStore(t,fa.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntries=function(t,e,n){var r=[];if(0<e.length){for(var i=Vo(t),o=no(),a=0,s=e;a<s.length;a++){var u=s[a],c=u.key,l=u.doc;r.push(i.put(zo(c),l)),o=o.add(c),r.push(this.indexManager.addToCollectionParentIndex(t,c.path.popLast()))}this.keepDocumentChangeLog&&r.push(Ko(t).put({changes:this.serializer.toDbResourcePaths(o)})),r.push(this.updateSize(t,n))}return co.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=Vo(t),r=zo(e);return n.get(r).next(function(t){return t?n.delete(r).next(function(){return Go(t)}):co.resolve(0)})},t.prototype.getEntry=function(t,e){var n=this;return Vo(t).get(zo(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return Vo(t).get(zo(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:Go(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Xi();return this.forEachDbEntry(t,e,function(t,e){r=e?r.insert(t,n.serializer.fromDbRemoteDocument(e)):r.insert(t,null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=Xi(),i=new Vi(Di.comparator);return this.forEachDbEntry(t,e,function(t,e){i=e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i.insert(t,Go(e))):(r=r.insert(t,null),i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return co.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Vo(t).iterate({range:r},function(t,e,r){for(var a=Di.fromSegments(t);o&&Di.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this;Mr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=Ji(),i=e.path.length+1,o=e.path.toArray(),a=IDBKeyRange.lowerBound(o);return Vo(t).iterate({range:a},function(t,o,a){if(t.length===i){var s=n.serializer.fromDbRemoteDocument(o);e.path.isPrefixOf(s.key.path)?s instanceof Po&&e.matches(s)&&(r=r.insert(s.key,s)):a.done()}}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;Mr(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=no(),r=Yi(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,a=Ko(t);return a.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(a).next(function(){return co.reject(new qr(Fr.DATA_LOSS,Fo))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new Ro(n,Ui.forDeletedDoc());r=r.insert(n,e)}))}),co.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return Ko(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new Uo(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Bo(t).get(ia.key).next(function(t){return Mr(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return Bo(t).put(ia.key,e)},t.prototype.updateSize=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t}();function Bo(t){return Ca.getStore(t,ia.store)}var Uo=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return c(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentCache.serializer.toDbRemoteDocument(n),a=e.documentSizes.get(t);Mr(void 0!==a,"Attempting to change document "+t.toString()+" without having read it first");var s=Go(o);r+=s-a,i.push({key:t,doc:o})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(jo);function Vo(t){return Ca.getStore(t,ra.store)}function Ko(t){return Ca.getStore(t,fa.store)}function zo(t){return t.path.toArray()}function Go(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var Wo=function(){function t(){this.collectionParentIndex=new Qo}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),co.resolve()},t.prototype.getCollectionParents=function(t,e){return co.resolve(this.collectionParentIndex.getEntries(e))},t}(),Qo=function(){function t(){this.index={}}return t.prototype.add=function(t){Mr(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Wi(ki.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.getEntries=function(t){return(this.index[t]||new Wi(ki.comparator)).toArray()},t}(),Ho=8,Yo=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i,o=this;Mr(n<r&&0<=n&&r<=Ho,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&1<=r&&(t.createObjectStore($o.store),(i=t).createObjectStore(Jo.store,{keyPath:Jo.keyPath}),i.createObjectStore(Zo.store,{keyPath:Zo.keyPath,autoIncrement:!0}).createIndex(Zo.userMutationsIndex,Zo.userMutationsKeyPath,{unique:!0}),i.createObjectStore(ta.store),ca(t),t.createObjectStore(ra.store));var a,s=co.resolve();return n<3&&3<=r&&(0!==n&&((a=t).deleteObjectStore(aa.store),a.deleteObjectStore(oa.store),a.deleteObjectStore(sa.store),ca(t)),s=s.next(function(){return t=e.store(sa.store),n=new sa(0,0,Ui.MIN.toTimestamp(),0),t.put(sa.key,n);var t,n})),n<4&&4<=r&&(0!==n&&(s=s.next(function(){return n=t,(r=e).store(Zo.store).loadAll().next(function(t){n.deleteObjectStore(Zo.store),n.createObjectStore(Zo.store,{keyPath:Zo.keyPath,autoIncrement:!0}).createIndex(Zo.userMutationsIndex,Zo.userMutationsKeyPath,{unique:!0});var e=r.store(Zo.store),i=t.map(function(t){return e.put(t)});return co.waitFor(i)});var n,r})),s=s.next(function(){t.createObjectStore(da.store,{keyPath:da.keyPath}),t.createObjectStore(fa.store,{keyPath:"id",autoIncrement:!0})})),n<5&&5<=r&&(s=s.next(function(){return o.removeAcknowledgedMutations(e)})),n<6&&6<=r&&(s=s.next(function(){return t.createObjectStore(ia.store),o.addDocumentGlobal(e)})),n<7&&7<=r&&(s=s.next(function(){return o.ensureSequenceNumbers(e)})),n<8&&8<=r&&(s=s.next(function(){return o.createCollectionParentIndex(t,e)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(ra.store).iterate(function(t,n){e+=Go(n)}).next(function(){var n=new ia(e);return t.store(ia.store).put(ia.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Jo.store),r=t.store(Zo.store);return n.loadAll().next(function(n){return co.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(Zo.userMutationsIndex,i).next(function(r){return co.forEach(r,function(r){Mr(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return fo(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(aa.store),n=t.store(ra.store);return No(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new ki(n),a=[0,Li(o)];r.push(e.get(a).next(function(n){return n?co.resolve():(r=o,e.put(new aa(0,Li(r),t)));var r}))}).next(function(){return co.waitFor(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ua.store,{keyPath:ua.keyPath});var n=e.store(ua.store),r=new Qo,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Li(i)})}};return e.store(ra.store).iterate({keysOnly:!0},function(t,e){var n=new ki(t);return i(n.popLast())}).next(function(){return e.store(ta.store).iterate({keysOnly:!0},function(t,e){t[0];var n=t[1],r=(t[2],qi(n));return i(r.popLast())})})},t}(),Xo=function(t,e){this.seconds=t,this.nanoseconds=e},$o=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}(),Jo=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Zo=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}(),ta=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Li(e)]},t.key=function(t,e,n){return[t,Li(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),ea=function(t,e){this.path=t,this.readTime=e},na=function(t,e){this.path=t,this.version=e},ra=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store="remoteDocuments",t}(),ia=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}(),oa=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),aa=function(){function t(t,e,n){this.targetId=t,this.path=e,Mr(0===t==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),sa=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),ua=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function ca(t){t.createObjectStore(aa.store,{keyPath:aa.keyPath}).createIndex(aa.documentTargetsIndex,aa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(oa.store,{keyPath:oa.keyPath}).createIndex(oa.queryTargetsIndexName,oa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(sa.store)}var la,ha,fa=function(){function t(t){this.changes=t}return t.store="remoteDocumentChanges",t.keyPath="id",t}(),da=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store="clientMetadata",t.keyPath="clientId",t}(),pa=[Jo.store,Zo.store,ta.store,ra.store,oa.store,$o.store,sa.store,aa.store].concat([da.store,fa.store]).concat([ia.store]).concat([ua.store]),ma=function(){function t(){this.collectionParentsCache=new Qo}return t.prototype.addToCollectionParentIndex=function(t,e){if(Mr(e.length%2==1,"Expected a collection path."),this.collectionParentsCache.add(e)){Mr(1<=e.length,"Invalid collection path.");var n=e.lastSegment(),r=e.popLast();return ya(t).put({collectionId:n,parent:Li(r)})}return co.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[fi(e),""],!1,!0);return ya(t).loadAll(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(qi(o.parent))}return n})},t}();function ya(t){return Ca.getStore(t,ua.store)}(ha=la||(la={}))[ha.Listen=0]="Listen",ha[ha.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",ha[ha.LimboResolution=2]="LimboResolution";var ga=function(){function t(t,e,n,r,i,o){void 0===i&&(i=Ui.MIN),void 0===o&&(o=jr()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),va=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Di.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new Ro(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=Di.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version),new Mo(e,n)):Rr("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof Po){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t),n=t.hasCommittedMutations;return new ra(null,null,e,n)}if(t instanceof Ro){var r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);return n=t.hasCommittedMutations,new ra(null,new ea(r,i),null,n)}return t instanceof Mo?(r=t.key.path.toArray(),i=this.toDbTimestamp(t.version),new ra(new na(r,i),null,null,!0)):Rr("Unexpected MaybeDocumment")},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new Xo(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new Bi(t.seconds,t.nanoseconds);return Ui.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.remoteSerializer.toMutation(t)}),i=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Zo(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.remoteSerializer.fromMutation(t)}),r=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),i=Bi.fromMillis(t.localWriteTimeMs);return new so(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(Li(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){for(var e=no(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new Di(qi(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new ga(e,t.targetId,la.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},t.prototype.toDbTarget=function(t){Mr(la.Listen===t.purpose,"Only queries with purpose "+la.Listen+" may be stored, got "+t.purpose);var e,n,i=this.toDbTimestamp(t.snapshotVersion);return e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),n=t.resumeToken instanceof Uint8Array?(Mr("YES"===r.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),t.resumeToken.toString()):t.resumeToken,new oa(t.targetId,t.query.canonicalId(),i,n,t.sequenceNumber,e)},t}();function ba(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=li(n,i);return 0===a?li(r,o):a}var wa=function(){function t(t){this.maxElements=t,this.buffer=new Wi(ba),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ba(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),Ea={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sa=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),Ta=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.gcTask=null}return t.prototype.start=function(){Mr(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Sa.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;Mr(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;Or("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(mi.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(Na)})},t}(),Ia=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return co.resolve(Si.INVALID);var r=new wa(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===Sa.COLLECTION_DISABLED?(Or("LruGarbageCollector","Garbage collection skipped; disabled"),co.resolve(Ea)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Or("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Ea):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,i,o,a,s,u,c,l=this;return o=Date.now(),this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return r=e>l.params.maximumSequenceNumbersToCollect?(Or("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),l.params.maximumSequenceNumbersToCollect):e,a=Date.now(),l.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),l.removeTargets(t,n,e)}).next(function(e){return i=e,u=Date.now(),l.removeOrphanedDocuments(t,n)}).next(function(t){return c=Date.now(),Cr()<=br.DEBUG&&Or("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-o)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-o)+"ms"),co.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),ka="IndexedDbPersistence",_a="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Aa="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Da=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return c(e,t),e}(function(){}),Ca=function(){function t(e,n,r,i,o,a,s){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new qr(Fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.referenceDelegate=new ja(this,a),this.dbName=e+t.MAIN_DATABASE,this.serializer=new va(o),this.document=r.document,this.allowTabSynchronization=void 0!==s,this.queryCache=new Ao(this.referenceDelegate,this.serializer),this.indexManager=new ma,this.remoteDocumentCache=new qo(this.serializer,this.indexManager,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new qr(Fr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof Da)return wo.getStore(t.simpleDbTransaction,e);throw Rr("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e,n,r,i,o,a){return l(this,void 0,void 0,function(){var s;return h(this,function(u){switch(u.label){case 0:return[4,(s=new t(e,n,r,i,o,a)).start()];case 1:return u.sent(),[2,s]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,a,s){return l(this,void 0,void 0,function(){var u;return h(this,function(c){switch(c.label){case 0:return[4,(u=new t(e,n,r,i,o,a,s)).start()];case 1:return c.sent(),[2,u]}})})},t.prototype.start=function(){var t=this;return Mr(!this.started,"IndexedDbPersistence double-started!"),Mr(null!==this.window,"Expected 'window' to be defined"),wo.openOrCreate(this.dbName,Ho,new Yo(this.serializer)).then(function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.startRemoteDocumentCache()}).then(function(){return t.simpleDb.runTransaction("readonly",[sa.store],function(e){return No(e).next(function(e){var n=t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0;t.listenSequence=new Si(e,n)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction("readonly",pa,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return l(e,void 0,void 0,function(){return h(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener(function(n){return l(e,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return l(e,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite",pa,function(e){return xa(e).put(new da(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this;return Oa(t).get($o.key).next(function(t){return co.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return xa(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return l(this,void 0,void 0,function(){var e,n,r=this;return h(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=t.getStore(i,da.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return co.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if(0<(e=e.filter(function(t){return t.clientId!==r.clientId})).length){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,t);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(mi.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return Oa(t).get($o.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new qr(Fr.FAILED_PRECONDITION,Aa);return!1}}return!(!e.networkEnabled||!e.inForeground)||xa(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&Or(ka,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return l(this,void 0,void 0,function(){var t=this;return h(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[$o.store,da.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly",[da.store],function(e){return xa(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return l(this,void 0,void 0,function(){var n;return h(this,function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,wo.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return Mr(this.started,"Cannot initialize MutationQueue before persistence is started."),lo.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getQueryCache=function(){return Mr(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return Mr(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return Mr(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;return Or(ka,"Starting transaction:",t),this.simpleDb.runTransaction("readonly"===e?"readonly":"readwrite",pa,function(i){return"readwrite-primary"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw xr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new qr(Fr.FAILED_PRECONDITION,_a);return n(new Da(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new Da(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return Oa(t).get($o.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new qr(Fr.FAILED_PRECONDITION,Aa)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new $o(this.clientId,this.allowTabSynchronization,Date.now());return Oa(t).put($o.key,e)},t.isAvailable=function(){return wo.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Oa(t);return n.get($o.key).next(function(t){return e.isLocalClient(t)?(Or(ka,"Releasing primary lease."),n.delete($o.key)):co.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(Mr(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(Mr("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return Or(ka,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return xr(ka,"Failed to get zombied client id.",t),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Na(t){return l(this,void 0,void 0,function(){return h(this,function(e){if((n=t).code!==Fr.FAILED_PRECONDITION||n.message!==_a)throw t;var n;return Or(ka,"Unexpectedly lost primary lease"),[2]})})}function Oa(t){return t.store($o.store)}function xa(t){return t.store(da.store)}var Pa,Ra,Ma,La,ja=function(){function t(t,e){this.db=t,this.garbageCollector=new Ia(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getQueryCache().getQueryCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Fa(t,e)},t.prototype.removeReference=function(t,e){return Fa(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Fa(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?co.resolve(!0):(r=e,i=!1,go(n=t).iterateSerial(function(t){return ho(n,t,r).next(function(t){return t&&(i=!0),co.resolve(!t)})}).next(function(){return i}));var n,r,i},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=0,o=[];return this.forEachOrphanedDocument(t,function(a,s){if(s<=e){var u=n.isPinned(t,a).next(function(e){if(!e)return r++,n.removeOrphanedDocument(t,a).next(function(t){i+=t})});o.push(u)}}).next(function(){return co.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(t,-i)}).next(function(){return r})},t.prototype.removeOrphanedDocument=function(t,e){var n,r=0,i=this.db.getRemoteDocumentCache();return co.waitFor([Oo(t).delete((n=e,[0,Li(n.path)])),i.removeEntry(t,e).next(function(t){r+=t})]).next(function(){return r})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Fa(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=Oo(t),i=Si.INVALID;return r.iterate({index:aa.documentTargetsIndex},function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==Si.INVALID&&e(new Di(qi(n)),i),i=s,n=a):i=Si.INVALID}).next(function(){i!==Si.INVALID&&e(new Di(qi(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Fa(t,e){return Oo(t).put((n=e,r=t.currentSequenceNumber,new aa(0,Li(n.path),r)));var n,r}(Ra=Pa||(Pa={}))[Ra.NullValue=0]="NullValue",Ra[Ra.BooleanValue=1]="BooleanValue",Ra[Ra.NumberValue=2]="NumberValue",Ra[Ra.TimestampValue=3]="TimestampValue",Ra[Ra.StringValue=4]="StringValue",Ra[Ra.BlobValue=5]="BlobValue",Ra[Ra.RefValue=6]="RefValue",Ra[Ra.GeoPointValue=7]="GeoPointValue",Ra[Ra.ArrayValue=8]="ArrayValue",Ra[Ra.ObjectValue=9]="ObjectValue",(La=Ma||(Ma={}))[La.Default=0]="Default",La[La.Estimate=1]="Estimate",La[La.Previous=2]="Previous";var qa=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Ma.Estimate,n);case"previous":return new t(Ma.Previous,n);case"none":case void 0:return new t(Ma.Default,n);default:return Rr("fromSnapshotOptions() called with invalid options.")}},t}(),Ba=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return Mr(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),li(this.typeOrder,t.typeOrder)},t}(),Ua=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=Pa.NullValue,e.internalValue=null,e}return c(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Ba),Va=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.BooleanValue,n}return c(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?li(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Ba),Ka=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.NumberValue,n}return c(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue)<(r=t.internalValue)?-1:r<n?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(t);var n,r},e}(Ba);function za(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Ga,Wa,Qa=function(t){function e(e){return t.call(this,e)||this}return c(e,t),e.prototype.isEqual=function(t){return t instanceof e&&za(this.internalValue,t.internalValue)},e}(Ka),Ha=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return c(e,t),e.prototype.isEqual=function(t){return t instanceof e&&za(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Ka),Ya=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.StringValue,n}return c(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?li(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ba),Xa=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.TimestampValue,n}return c(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof $a?-1:this.defaultCompareTo(t)},e}(Ba),$a=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=Pa.TimestampValue,r}return c(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Ma.Estimate?new Xa(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Ma.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Xa?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Ba),Ja=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.BlobValue,n}return c(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ba),Za=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=Pa.RefValue,r}return c(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId)},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:Di.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Ba),ts=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.GeoPointValue,n}return c(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ba),es=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.ObjectValue,n}return c(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=li(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return li(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(Mr(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(Mr(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){Mr(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e&&n.internalValue.get(t)||void 0}),n},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Vi(li)),e}(Ba),ns=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Pa.ArrayValue,n}return c(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.contains=function(t){for(var e=0,n=this.internalValue;e<n.length;e++)if(n[e].isEqual(t))return!0;return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return li(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return"["+this.internalValue.map(function(t){return t.toString()}).join(",")+"]"},e}(Ba),rs=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Wi(Ai.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.applyTo=function(t){var e=es.EMPTY;return this.fields.forEach(function(n){if(n.isEmpty())return t;var r=t.field(n);void 0!==r&&(e=e.set(n,r))}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),is=function(){function t(t,e){this.field=t,this.transform=e}return Object.defineProperty(t.prototype,"isIdempotent",{get:function(){return this.transform.isIdempotent},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),os=function(t,e){this.version=t,this.transformResults=e};(Wa=Ga||(Ga={}))[Wa.Set=0]="Set",Wa[Wa.Patch=1]="Patch",Wa[Wa.Transform=2]="Transform",Wa[Wa.Delete=3]="Delete";var as=function(){function t(t,e){this.updateTime=t,this.exists=e,Mr(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Po&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Po:(Mr(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),ss=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&Mr(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Po?t.version:Ui.MIN},t}(),us=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Ga.Set,i}return c(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),Mr(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Po(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ss.getPostMutationVersion(t);return new Po(this.key,r,this.value,{hasLocalMutations:!0})},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldMask",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(ss),cs=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Ga.Patch,o}return c(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Mr(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new Mo(this.key,e.version);var n=this.patchDocument(t);return new Po(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=ss.getPostMutationVersion(t),i=this.patchDocument(t);return new Po(this.key,r,i,{hasLocalMutations:!0})},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Po?t.data:es.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=void 0!==r?t.set(n,r):t.delete(n)}}),t},e}(ss),ls=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Ga.Transform,r.precondition=as.exists(!0),r}return c(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Mr(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new Mo(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data,r);return new Po(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new Po(this.key,r.version,o,{hasLocalMutations:!0})},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){for(var t=0,e=this.fieldTransforms;t<e.length;t++)if(!e[t].isIdempotent)return!1;return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldMask",{get:function(){var t=new Wi(Ai.comparator);return this.fieldTransforms.forEach(function(e){return t=t.add(e.field)}),new rs(t)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&hi(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){Mr(t instanceof Po,"Unknown MaybeDocument type "+t);var e=t;return Mr(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];Mr(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Po&&(a=t.field(i.field)||null),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform,s=null;e instanceof Po&&(s=e.field(o.field)||null),n.push(a.applyToLocalView(s,t))}return n},e.prototype.transformObject=function(t,e){Mr(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(ss),hs=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Ga.Delete,r}return c(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),Mr(null==e.transformResults,"Transform results received by DeleteMutation."),new Ro(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&Mr(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Ro(this.key,Ui.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},Object.defineProperty(e.prototype,"isIdempotent",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldMask",{get:function(){return null},enumerable:!0,configurable:!0}),e}(ss),fs=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].applyToLocalView(e,t);return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Xi();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].applyToLocalView(t,e);r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Yi();return i.forEach(function(t,e){e||(e=new Ro(t,Ui.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new Di(e)).next(function(t){var e=Ji();return t instanceof Po&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e){var n=this;Mr(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var r=e.collectionGroup,i=Ji();return this.indexManager.getCollectionParents(t,r).next(function(o){return co.forEach(o,function(o){var a=e.asCollectionQueryAtPath(o.child(r));return n.getDocumentsMatchingCollectionQuery(t,a).next(function(t){t.forEach(function(t,e){i=i.insert(t,e)})})}).next(function(){return i})})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(t){for(var r=0,i=t;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;if(e.path.isImmediateParentOf(c.path)){var l=n.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);n=h instanceof Po?n.insert(c,h):n.remove(c)}}}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t}(),ds=function(){function t(){this.refsByKey=new Wi(ps.compareByKey),this.refsByTarget=new Wi(ps.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new ps(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new ps(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=Di.EMPTY,r=new ps(n,t),i=new ps(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=Di.EMPTY,n=new ps(e,t),r=new ps(e,t+1),i=no();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new ps(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),ps=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return Di.comparator(t.key,e.key)||li(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return li(t.targetOrBatchId,e.targetOrBatchId)||Di.comparator(t.key,e.key)},t}(),ms=function(){function t(t,e){this.persistence=t,this.localViewReferences=new ds,this.queryDataByTarget={},Mr(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new fs(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager())}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new fs(e.remoteDocuments,e.mutationQueue,e.persistence.getIndexManager()),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=[],o=[],a=no(),s=0,u=r;s<u.length;s++){var c=u[s];i.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var d=0,p=t;d<p.length;d++){c=p[d],o.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++)f=y[m],a=a.add(f.key)}return e.localDocuments.getDocuments(n,a).next(function(t){return{affectedDocuments:t,removedBatchIds:i,addedBatchIds:o}})})})},t.prototype.localWrite=function(t){var e=this,n=Bi.now(),r=t.reduce(function(t,e){return t.add(e.key)},no());return this.persistence.runTransaction("Locally write mutations","readwrite",function(i){return e.localDocuments.getDocuments(i,r).next(function(r){for(var o=[],a=0,s=t;a<s.length;a++){var u=s[a],c=r.get(u.key);if(!u.isIdempotent){var l=u.fieldMask;if(l){var h=c instanceof Po?l.applyTo(c.data):es.EMPTY;o.push(new cs(u.key,h,l,as.exists(!0)))}}}return e.mutationQueue.addMutationBatch(i,n,o,t).next(function(t){var e=t.applyToLocalDocumentSet(r);return{batchId:t.batchId,changes:e}})})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):co.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return Mr(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var o=[],a=no();Kr(e.targetChanges,function(r,s){var u=n.queryDataByTarget[r];if(u){s.addedDocuments.forEach(function(t){a=a.add(t)}),s.modifiedDocuments.forEach(function(t){a=a.add(t)}),o.push(n.queryCache.removeMatchingKeys(i,s.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,s.addedDocuments,r)}));var c=s.resumeToken;if(0<c.length){var l=u;u=u.copy({resumeToken:c,snapshotVersion:e.snapshotVersion}),n.queryDataByTarget[r]=u,t.shouldPersistQueryData(l,u,s)&&o.push(n.queryCache.updateQueryData(i,u))}}});var s=Yi(),u=no();e.documentUpdates.forEach(function(t,e){u=u.add(t)}),o.push(r.getEntries(i,u).next(function(t){e.documentUpdates.forEach(function(u,c){var l=t.get(u);null==l||c.version.isEqual(Ui.MIN)||a.has(c.key)&&!l.hasPendingWrites||0<=c.version.compareTo(l.version)?(r.addEntry(c),s=s.insert(u,c)):Or("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.resolvedLimboDocuments.has(u)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))})}));var c=e.snapshotVersion;if(!c.isEqual(Ui.MIN)){var l=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(t){return Mr(0<=c.compareTo(t),"Watch stream reverted to previous snapshot?? "+c+" < "+t),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(l)}return co.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(i,s)})})},t.shouldPersistQueryData=function(t,e,n){return 0!==e.resumeToken.length&&(0===t.resumeToken.length||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||0<n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size)},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return co.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),co.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,co.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new ga(t,i,la.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return Mr(!e.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+t),e.queryDataByTarget[r.targetId]=r})})},t.prototype.releaseQuery=function(t,e){var n=this,r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release query",r,function(r){return n.queryCache.getQueryData(r,t).next(function(i){Mr(null!=i,"Tried to release nonexistent query: "+t);var o=i.targetId,a=n.queryDataByTarget[o],s=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?co.resolve():co.forEach(s,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,a)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=co.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,a=e.docVersions.get(r);Mr(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o):Mr(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction("Get query data","readonly",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),ys=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=jr(),this.batchesByDocumentKey=new Wi(ps.compareByKey)}return t.prototype.checkEmpty=function(t){return co.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");Mr(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return Mr(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,co.resolve()},t.prototype.getLastStreamToken=function(t){return co.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,co.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){Mr(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&Mr(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new so(i,e,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new ps(u.key,i)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast())}return co.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return co.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return Mr(null!=n,"Failed to find local mutation batch."),co.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return co.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getAllMutationBatches=function(t){return co.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new ps(e,0),i=new ps(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){Mr(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);Mr(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),co.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Wi(li);return e.forEach(function(t){var e=new ps(t,0),i=new ps(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){Mr(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),co.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){Mr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;Di.isDocumentKey(i)||(i=i.child(""));var o=new ps(new Di(i),0),a=new Wi(li);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)},o),co.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Mr(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return co.forEach(e.mutations,function(i){var o=new ps(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new ps(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return co.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&Mr(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),co.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return Mr(0<=n&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return Mr(n.batchId===t,"If found batch must match"),n},t}(),gs=function(){function t(t){this.persistence=t,this.queries=new Lo(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Ui.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ds,this.targetCount=0,this.targetIdGenerator=vo.forQueryCache()}return t.prototype.getTargetCount=function(t){return co.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),co.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return co.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return co.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,co.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),co.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return Mr(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,co.resolve()},t.prototype.updateQueryData=function(t,e){return Mr(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),co.resolve()},t.prototype.removeQueryData=function(t,e){return Mr(0<this.targetCount,"Removing a target from an empty cache"),Mr(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,co.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=e&&!n[s.targetId]&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),co.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return co.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return co.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return Rr("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),co.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),co.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),co.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return co.resolve(n)},t.prototype.containsKey=function(t,e){return co.resolve(this.references.containsKey(e))},t}(),vs=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new Vi(Di.comparator),this.newDocumentChanges=no(),this.size=0}return t.prototype.addEntries=function(t,e,n){for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i],s=a.maybeDocument.key;this.docs=this.docs.insert(s,a),this.newDocumentChanges=this.newDocumentChanges.add(s),r.push(this.indexManager.addToCollectionParentIndex(t,s.path.popLast()))}return this.size+=n,co.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=this.docs.get(e);return n?(this.docs=this.docs.remove(e),this.size-=n.size,co.resolve(n.size)):co.resolve(0)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return co.resolve(n?n.maybeDocument:null)},t.prototype.getSizedEntry=function(t,e){return co.resolve(this.docs.get(e))},t.prototype.getEntries=function(t,e){var n=this,r=Xi();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),co.resolve(r)},t.prototype.getSizedEntries=function(t,e){var n=this,r=Xi(),i=new Vi(Di.comparator);return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null),i=i.insert(t,e?e.size:0)}),co.resolve({maybeDocuments:r,sizeMap:i})},t.prototype.getDocumentsMatchingQuery=function(t,e){Mr(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var n=Ji(),r=new Di(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value.maybeDocument;if(!e.path.isPrefixOf(a.path))break;s instanceof Po&&e.matches(s)&&(n=n.insert(s.key,s))}return co.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return co.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=Yi();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new Ro(t,Ui.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=no(),co.resolve(n)},t.prototype.newChangeBuffer=function(){return new bs(this.sizer,this)},t.prototype.getSize=function(t){return co.resolve(this.size)},t}(),bs=function(t){function e(e,n){var r=t.call(this)||this;return r.sizer=e,r.documentCache=n,r}return c(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentSizes.get(t);Mr(void 0!==o,"Attempting to change document "+t.toString()+" without having read it first");var a=e.sizer(n);r+=a-o,i.push({maybeDocument:n,size:a})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(jo),ws=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new Si(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new gs(this),this.indexManager=new Wo,this.remoteDocumentCache=new vs(this.indexManager,function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n,r){return new t(e,function(t){return new Ts(t,new va(n),r)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new Ss(t)})},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return l(this,void 0,void 0,function(){return h(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new ys(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new Es(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return co.or((n=this.mutationQueues,r=[],zr(n,function(t,e){return r.push(e)}),r).map(function(n){return function(){return n.containsKey(t,e)}}));var n,r},t}(),Es=function(t){this.currentSequenceNumber=t},Ss=function(){function t(t){this.persistence=t}return t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),co.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),co.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),co.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache();return co.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(e){return e?co.resolve():n.removeEntry(t,r).next(function(){})})})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return co.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return co.resolve(n.inMemoryPins.containsKey(e))}])},t}(),Ts=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.orphanedSequenceNumbers=new Lo(function(t){return Li(t.path)}),this.garbageCollector=new Ia(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return co.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getQueryCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return co.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?co.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache();return i.forEachDocumentKey(t,function(o){return n.isPinned(t,o,e).next(function(e){return e?co.resolve():(r++,i.removeEntry(t,o).next())})}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),co.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),co.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),co.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),co.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Rr("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return co.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return co.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return co.resolve(void 0!==t&&n<t)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),Is=Number,ks=Is.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),_s=Is.MAX_SAFE_INTEGER||Math.pow(2,53)-1,As=Is.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function Ds(t){return null==t}function Cs(t){return As(t)&&t<=_s&&ks<=t}var Ns,Os,xs=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);0<this.currentBaseMs&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),Ps="PersistentStream";(Os=Ns||(Ns={}))[Os.Initial=0]="Initial",Os[Os.Starting=1]="Starting",Os[Os.Open=2]="Open",Os[Os.Error=3]="Error",Os[Os.Backoff=4]="Backoff";var Rs,Ms,Ls,js,Fs=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Ns.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new xs(t,e,1e3,1.5,6e4)}return t.prototype.isStarted=function(){return this.state===Ns.Starting||this.state===Ns.Open||this.state===Ns.Backoff},t.prototype.isOpen=function(){return this.state===Ns.Open},t.prototype.start=function(){this.state!==Ns.Error?(Mr(this.state===Ns.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(Ns.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){Mr(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Ns.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return l(this,void 0,void 0,function(){return h(this,function(t){return this.isOpen()?[2,this.close(Ns.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return l(this,void 0,void 0,function(){return h(this,function(n){switch(n.label){case 0:return Mr(this.isStarted(),"Only started streams should be closed."),Mr(t===Ns.Error||Ds(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==Ns.Error?this.backoff.reset():e&&e.code===Fr.RESOURCE_EXHAUSTED?(xr(e.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===Fr.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;Mr(this.state===Ns.Initial,"Must be in initial state to auth"),this.state=Ns.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new qr(Fr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;Mr(this.state===Ns.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return Mr(e.state===Ns.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=Ns.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;Mr(this.state===Ns.Error,"Should only perform backoff when in Error state"),this.state=Ns.Backoff,this.backoff.backoffAndRun(function(){return l(t,void 0,void 0,function(){return h(this,function(t){return Mr(this.state===Ns.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Ns.Initial,this.start(),Mr(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return Mr(this.isStarted(),"Can't handle server close on non-started stream"),Or(Ps,"close with error: "+t),this.stream=null,this.close(Ns.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(Or(Ps,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),qs=function(t){function e(e,n,r,i,o){var a=t.call(this,e,mi.ListenStreamConnectionBackoff,mi.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return c(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Fs),Bs=function(t){function e(e,n,r,i,o){var a=t.call(this,e,mi.WriteStreamConnectionBackoff,mi.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a}return c(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(Mr(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return Mr(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){Mr(this.isOpen(),"Writing handshake requires an opened stream"),Mr(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;Mr(this.isOpen(),"Writing mutations requires an opened stream"),Mr(this.handshakeComplete_,"Handshake must be complete before writing mutations"),Mr(0<this.lastStreamToken.length,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(Fs),Us=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new Bs(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new qs(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Yi();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);Mr(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===Fr.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),Vs=function(){function t(t){this.datastore=t,this.readVersions=to(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e;if(t instanceof Po)e=t.version;else{if(!(t instanceof Ro))throw Rr("Document in a transaction was a "+t.constructor.name);e=Ui.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new qr(Fr.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):0<this.mutations.length?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){t instanceof Ro||t instanceof Po?e.recordVersion(t):Rr("Document in a transaction was a "+t.constructor.name)}),t})},t.prototype.write=function(t){if(this.committed)throw new qr(Fr.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?as.updateTime(e):as.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(Ui.forDeletedDoc()))throw new qr(Fr.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?as.updateTime(e):as.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new hs(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,Ui.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}();(Ms=Rs||(Rs={}))[Ms.Unknown=0]="Unknown",Ms[Ms.Online=1]="Online",Ms[Ms.Offline=2]="Offline",(js=Ls||(Ls={}))[js.RemoteStore=0]="RemoteStore",js[js.SharedClientState=1]="SharedClientState";var Ks,zs,Gs=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=Rs.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Rs.Unknown),Mr(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(mi.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,Mr(t.state===Rs.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(Rs.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===Rs.Online?(this.setAndBroadcast(Rs.Unknown),Mr(0===this.watchStreamFailures,"watchStreamFailures must be 0"),Mr(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,1<=this.watchStreamFailures&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(Rs.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===Rs.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(xr(e),this.shouldWarnClientIsOffline=!1):Or("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function Ws(t){switch(t){case Fr.OK:return Rr("Treated status OK as error");case Fr.CANCELLED:case Fr.UNKNOWN:case Fr.DEADLINE_EXCEEDED:case Fr.RESOURCE_EXHAUSTED:case Fr.INTERNAL:case Fr.UNAVAILABLE:case Fr.UNAUTHENTICATED:return!1;case Fr.INVALID_ARGUMENT:case Fr.NOT_FOUND:case Fr.ALREADY_EXISTS:case Fr.PERMISSION_DENIED:case Fr.FAILED_PRECONDITION:case Fr.ABORTED:case Fr.OUT_OF_RANGE:case Fr.UNIMPLEMENTED:case Fr.DATA_LOSS:return!0;default:return Rr("Unknown status code: "+t)}}function Qs(t){if(void 0===t)return xr("GRPC error has no .code"),Fr.UNKNOWN;switch(t){case Ks.OK:return Fr.OK;case Ks.CANCELLED:return Fr.CANCELLED;case Ks.UNKNOWN:return Fr.UNKNOWN;case Ks.DEADLINE_EXCEEDED:return Fr.DEADLINE_EXCEEDED;case Ks.RESOURCE_EXHAUSTED:return Fr.RESOURCE_EXHAUSTED;case Ks.INTERNAL:return Fr.INTERNAL;case Ks.UNAVAILABLE:return Fr.UNAVAILABLE;case Ks.UNAUTHENTICATED:return Fr.UNAUTHENTICATED;case Ks.INVALID_ARGUMENT:return Fr.INVALID_ARGUMENT;case Ks.NOT_FOUND:return Fr.NOT_FOUND;case Ks.ALREADY_EXISTS:return Fr.ALREADY_EXISTS;case Ks.PERMISSION_DENIED:return Fr.PERMISSION_DENIED;case Ks.FAILED_PRECONDITION:return Fr.FAILED_PRECONDITION;case Ks.ABORTED:return Fr.ABORTED;case Ks.OUT_OF_RANGE:return Fr.OUT_OF_RANGE;case Ks.UNIMPLEMENTED:return Fr.UNIMPLEMENTED;case Ks.DATA_LOSS:return Fr.DATA_LOSS;default:return Rr("Unknown status code: "+t)}}(zs=Ks||(Ks={}))[zs.OK=0]="OK",zs[zs.CANCELLED=1]="CANCELLED",zs[zs.UNKNOWN=2]="UNKNOWN",zs[zs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zs[zs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zs[zs.NOT_FOUND=5]="NOT_FOUND",zs[zs.ALREADY_EXISTS=6]="ALREADY_EXISTS",zs[zs.PERMISSION_DENIED=7]="PERMISSION_DENIED",zs[zs.UNAUTHENTICATED=16]="UNAUTHENTICATED",zs[zs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zs[zs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zs[zs.ABORTED=10]="ABORTED",zs[zs.OUT_OF_RANGE=11]="OUT_OF_RANGE",zs[zs.UNIMPLEMENTED=12]="UNIMPLEMENTED",zs[zs.INTERNAL=13]="INTERNAL",zs[zs.UNAVAILABLE=14]="UNAVAILABLE",zs[zs.DATA_LOSS=15]="DATA_LOSS";var Hs,Ys,Xs,$s,Js=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Di.comparator(e.key,n.key)}:function(t,e){return Di.comparator(t.key,e.key)},this.keyedMap=Ji(),this.sortedSet=new Vi(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();(Ys=Hs||(Hs={}))[Ys.Added=0]="Added",Ys[Ys.Removed=1]="Removed",Ys[Ys.Modified=2]="Modified",Ys[Ys.Metadata=3]="Metadata",($s=Xs||(Xs={}))[$s.Local=0]="Local",$s[$s.Synced=1]="Synced";var Zs,tu,eu=function(){function t(){this.changeMap=new Vi(Di.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Hs.Added&&n.type===Hs.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Hs.Metadata&&n.type!==Hs.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Hs.Modified&&n.type===Hs.Modified?this.changeMap=this.changeMap.insert(e,{type:Hs.Modified,doc:t.doc}):t.type===Hs.Modified&&n.type===Hs.Added?this.changeMap=this.changeMap.insert(e,{type:Hs.Added,doc:t.doc}):t.type===Hs.Removed&&n.type===Hs.Added?this.changeMap=this.changeMap.remove(e):t.type===Hs.Removed&&n.type===Hs.Modified?this.changeMap=this.changeMap.insert(e,{type:Hs.Removed,doc:n.doc}):t.type===Hs.Added&&n.type===Hs.Removed?this.changeMap=this.changeMap.insert(e,{type:Hs.Modified,doc:t.doc}):Rr("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),nu=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Hs.Added,doc:t})}),new t(e,n,Js.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ru=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=iu.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(Ui.MIN,i,io(),Yi(),no())},t}(),iu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(jr(),n,no(),no(),no())},t}(),ou=function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r},au=function(t,e){this.targetId=t,this.existenceFilter=e};(tu=Zs||(Zs={}))[tu.NoChange=0]="NoChange",tu[tu.Added=1]="Added",tu[tu.Removed=2]="Removed",tu[tu.Current=3]="Current",tu[tu.Reset=4]="Reset";var su=function(t,e,n,r){void 0===n&&(n=jr()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},uu=function(){function t(){this.pendingResponses=0,this.documentChanges=hu(),this._resumeToken=jr(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){0<t.length&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=no(),e=no(),n=no();return this.documentChanges.forEach(function(r,i){switch(i){case Hs.Added:t=t.add(r);break;case Hs.Modified:e=e.add(r);break;case Hs.Removed:n=n.add(r);break;default:Rr("Encountered invalid change type: "+i)}}),new iu(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=hu()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),cu=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Yi(),this.pendingDocumentTargetMapping=lu(),this.pendingTargetResets=new Wi(li)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof Po?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof Ro&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.removeDocumentFromTarget(r,t.key,t.newDoc)},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case Zs.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case Zs.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case Zs.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),Mr(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Zs.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case Zs.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:Rr("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){0<t.targetIds.length?t.targetIds.forEach(e):Kr(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new Di(i.path);this.removeDocumentFromTarget(e,o,new Ro(o,Ui.forDeletedDoc()))}else Mr(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};Kr(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new Di(o.query.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new Ro(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=no();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===la.LimboResolution||(i=!1)}),i&&(r=r.add(t))});var i=new ru(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Yi(),this.pendingDocumentTargetMapping=lu(),this.pendingTargetResets=new Wi(li),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Hs.Modified:Hs.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Hs.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new uu),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Wi(li),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;Mr(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new uu,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function lu(){return new Vi(Di.comparator)}function hu(){return new Vi(Di.comparator)}var fu="RemoteStore",du=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(t){n.enqueueAndForget(function(){return l(o,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(Or(fu,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new Gs(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return l(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Rs.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Rs.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),0<this.writePipeline.length&&(Or(fu,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return Or(fu,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(Rs.Unknown),[2]}})})},t.prototype.listen=function(t){Mr(!Ur(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){Mr(Ur(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),Gr(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Rs.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){Mr(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new cu(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!Gr(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return l(this,void 0,void 0,function(){var t=this;return h(this,function(e){return Kr(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return l(this,void 0,void 0,function(){return h(this,function(e){return void 0===t&&Mr(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(Rs.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return l(this,void 0,void 0,function(){var n;return h(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Rs.Online),t instanceof su&&t.state===Zs.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof ou?this.watchChangeAggregator.handleDocumentChange(t):t instanceof au?this.watchChangeAggregator.handleExistenceFilter(t):(Mr(t instanceof su,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(Ui.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),0<=e.compareTo(n)?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;Mr(!t.isEqual(Ui.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return Kr(n.targetChanges,function(n,r){if(0<r.resumeToken.length){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:jr()}),e.sendUnwatchRequest(t);var r=new ga(n.query,t,la.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;Mr(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return l(e,void 0,void 0,function(){return h(this,function(e){return Ur(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return l(this,void 0,void 0,function(){var t,e;return h(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){Mr(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},t.prototype.startWriteStream=function(){Mr(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return l(this,void 0,void 0,function(){return h(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}}).catch(Na)},t.prototype.onMutationResult=function(t,e){var n=this;Mr(0<this.writePipeline.length,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=uo.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return l(this,void 0,void 0,function(){var e=this;return h(this,function(n){return void 0===t&&Mr(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&0<this.writePipeline.length?[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]:[2]})})},t.prototype.handleHandshakeError=function(t){return l(this,void 0,void 0,function(){return h(this,function(e){return Ws(t.code)?(Or(fu,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=jr(),[2,this.localStore.setLastStreamToken(jr()).catch(Na)]):[2]})})},t.prototype.handleWriteError=function(t){return l(this,void 0,void 0,function(){var e,n=this;return h(this,function(r){return Ws(i=t.code)&&i!==Fr.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new Vs(this.datastore)},t.prototype.restartNetwork=function(){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Rs.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.handleCredentialChange=function(){return l(this,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(Or(fu,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.applyPrimaryState=function(t){return l(this,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return(this.isPrimary=t)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(Rs.Unknown),e.label=4;case 4:return[2]}})})},t}(),pu=function(){function t(t,e){if(Qr("GeoPoint",arguments,2),Xr("GeoPoint","number",1,t),Xr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new qr(Fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qr(Fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return li(this._lat,t._lat)||li(this._long,t._long)},t}(),mu=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[ku]:this.memoizedOrderBy=[new Iu(t),ku];else{Mr(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field.");for(var n=!(this.memoizedOrderBy=[]),r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Su.ASCENDING;this.memoizedOrderBy.push(a===Su.ASCENDING?ku:_u)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){Mr(null==this.getInequalityFilterField()||!(e instanceof gu)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),Mr(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){Mr(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();this.isCollectionGroupQuery()&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";Ds(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.isCollectionGroupQuery()&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Ds(this.limit)||(t+=", limit: "+this.limit),0<this.explicitOrderBy.length&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return Mr(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!Ds(this.limit)},t.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof gu&&n.isInequality())return n.field}return null},t.prototype.findFilterOperator=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof gu&&0<=t.indexOf(r.op))return r.op}return null},t.prototype.isDocumentQuery=function(){return Di.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):Di.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){Mr(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),yu=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return Rr("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),gu=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return c(e,t),e.create=function(t,n,r){if(t.isKeyField())return Mr(r instanceof Za,"Comparing on key, but filter value not a RefValue"),Mr(n!==yu.ARRAY_CONTAINS&&n!==yu.ARRAY_CONTAINS_ANY&&n!==yu.IN,"'"+n.toString()+"' queries don't make sense on document keys."),new vu(t,n,r);if(r.isEqual(Ua.INSTANCE)){if(n!==yu.EQUAL)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new e(t,n,r)}if(r.isEqual(Ha.NAN)){if(n!==yu.EQUAL)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new e(t,n,r)}return n===yu.ARRAY_CONTAINS?new bu(t,r):n===yu.IN?(Mr(r instanceof ns,"IN filter has invalid value: "+r.toString()),new wu(t,r)):n===yu.ARRAY_CONTAINS_ANY?(Mr(r instanceof ns,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new Eu(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case yu.LESS_THAN:return t<0;case yu.LESS_THAN_OR_EQUAL:return t<=0;case yu.EQUAL:return 0===t;case yu.GREATER_THAN:return 0<t;case yu.GREATER_THAN_OR_EQUAL:return 0<=t;default:return Rr("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return 0<=[yu.LESS_THAN,yu.LESS_THAN_OR_EQUAL,yu.GREATER_THAN,yu.GREATER_THAN_OR_EQUAL].indexOf(this.op)},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(function(){}),vu=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return c(e,t),e.prototype.matches=function(t){var e=this.value,n=Di.comparator(t.key,e.key);return this.matchesComparison(n)},e}(gu),bu=function(t){function e(e,n){return t.call(this,e,yu.ARRAY_CONTAINS,n)||this}return c(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof ns&&e.contains(this.value)},e}(gu),wu=function(t){function e(e,n){return t.call(this,e,yu.IN,n)||this}return c(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return void 0!==n&&e.contains(n)},e}(gu),Eu=function(t){function e(e,n){return t.call(this,e,yu.ARRAY_CONTAINS_ANY,n)||this}return c(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return n instanceof ns&&n.internalValue.some(function(t){return e.contains(t)})},e}(gu),Su=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),Tu=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},t.prototype.sortsBeforeDocument=function(t,e){Mr(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())Mr(o instanceof Za,"Bound has a non-key value where the key path is being used."),n=Di.comparator(o.key,e.key);else{var a=e.field(i.field);Mr(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Su.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),Iu=function(){function t(t,e){this.field=t,void 0===e&&(e=Su.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Po.compareByKey(t,e):Po.compareByField(this.field,t,e);switch(this.dir){case Su.ASCENDING:return n;case Su.DESCENDING:return-1*n;default:return Rr("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),ku=new Iu(Ai.keyField(),Su.ASCENDING),_u=new Iu(Ai.keyField(),Su.DESCENDING),Au=function(){function t(){this.isIdempotent=!0}return t.prototype.applyToLocalView=function(t,e){return new $a(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Du=function(){function t(t){this.elements=t,this.isIdempotent=!0}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=Ou(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new ns(e)},t.prototype.isEqual=function(e){return e instanceof t&&hi(e.elements,this.elements)},t}(),Cu=function(){function t(t){this.elements=t,this.isIdempotent=!0}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=Ou(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new ns(e)},t.prototype.isEqual=function(e){return e instanceof t&&hi(e.elements,this.elements)},t}(),Nu=function(){function t(t){this.operand=t,this.isIdempotent=!1}return t.prototype.applyToLocalView=function(t,e){if(t instanceof Qa&&this.operand instanceof Qa){var n=t.internalValue+this.operand.internalValue;return new Qa(n)}return t instanceof Ka?(n=t.internalValue+this.operand.internalValue,new Ha(n)):this.operand},t.prototype.applyToRemoteDocument=function(t,e){return Mr(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function Ou(t){return t instanceof ns?t.internalValue.slice():[]}var xu,Pu,Ru=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),Mu=((xu={})[Su.ASCENDING.name]="ASCENDING",xu[Su.DESCENDING.name]="DESCENDING",xu),Lu=((Pu={})[yu.LESS_THAN.name]="LESS_THAN",Pu[yu.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",Pu[yu.GREATER_THAN.name]="GREATER_THAN",Pu[yu.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",Pu[yu.EQUAL.name]="EQUAL",Pu[yu.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",Pu[yu.IN.name]="IN",Pu[yu.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",Pu),ju=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fu(t,e){Mr(!Ds(t),e+" is missing")}function qu(t){return"number"==typeof t?t:"string"==typeof t?Number(t):Rr("can't parse "+t)}var Bu=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Fr.UNKNOWN:Qs(t.code);return new qr(e,t.message||"")},t.prototype.toInt32Value=function(t){return Ds(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return Ds(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);Mr(!!t,"Cannot deserialize null or undefined timestamp.");var e=qu(t.seconds||"0"),n=t.nanos||0;return new Bi(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=ju.exec(t);if(Mr(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Bi(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(Mr(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),gi.fromBase64String(t)):(Mr(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),gi.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return Mr(!!t,"Trying to deserialize version that isn't set"),Ui.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=ki.fromString(t);return Mr(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return Mr(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),Mr(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new Di(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?ki.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new ki(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new ki(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return Mr(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Ua)return{nullValue:"NULL_VALUE"};if(t instanceof Va)return{booleanValue:t.value()};if(t instanceof Qa)return{integerValue:""+t.value()};if(t instanceof Ha){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Ya?{stringValue:t.value()}:t instanceof es?{mapValue:this.toMapValue(t)}:t instanceof ns?{arrayValue:this.toArrayValue(t)}:t instanceof Xa?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof ts?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Ja?{bytesValue:this.toBytes(t.value())}:t instanceof Za?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:Rr("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Ua.INSTANCE;if("booleanValue"in t)return Va.of(t.booleanValue);if("integerValue"in t)return new Qa(qu(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Ha.NAN;if("Infinity"===t.doubleValue)return Ha.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Ha.NEGATIVE_INFINITY}return new Ha(t.doubleValue)}if("stringValue"in t)return new Ya(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){Fu(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new ns(n.map(function(t){return e.fromValue(t)}))}if("timestampValue"in t)return Fu(t.timestampValue,"timestampValue"),new Xa(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){Fu(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new ts(new pu(r,i))}if("bytesValue"in t){Fu(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Ja(o)}if("referenceValue"in t){Fu(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new Ei(a.get(1),a.get(3)),u=new Di(this.extractLocalPathFromResourceName(a));return new Za(s,u)}return Rr("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return Mr(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){return new Po(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasCommittedMutations:!!e})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=es.EMPTY;return zr(n,function(t,n){r=r.set(new Ai([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){Mr(!!t.found,"Tried to deserialize a found document from a missing document."),Fu(t.found.name,"doc.found.name"),Fu(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new Po(e,n,r,{},t.found)},t.prototype.fromMissing=function(t){Mr(!!t.missing,"Tried to deserialize a missing document from a found document."),Mr(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new Ro(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):Rr("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Zs.Added:return"ADD";case Zs.Current:return"CURRENT";case Zs.NoChange:return"NO_CHANGE";case Zs.Removed:return"REMOVE";case Zs.Reset:return"RESET";default:return Rr("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof au)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof ou){if(t.newDoc instanceof Po){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof Ro)return e=t.newDoc,{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof su){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return Ks.OK;switch(t){case Fr.OK:return Ks.OK;case Fr.CANCELLED:return Ks.CANCELLED;case Fr.UNKNOWN:return Ks.UNKNOWN;case Fr.DEADLINE_EXCEEDED:return Ks.DEADLINE_EXCEEDED;case Fr.RESOURCE_EXHAUSTED:return Ks.RESOURCE_EXHAUSTED;case Fr.INTERNAL:return Ks.INTERNAL;case Fr.UNAVAILABLE:return Ks.UNAVAILABLE;case Fr.UNAUTHENTICATED:return Ks.UNAUTHENTICATED;case Fr.INVALID_ARGUMENT:return Ks.INVALID_ARGUMENT;case Fr.NOT_FOUND:return Ks.NOT_FOUND;case Fr.ALREADY_EXISTS:return Ks.ALREADY_EXISTS;case Fr.PERMISSION_DENIED:return Ks.PERMISSION_DENIED;case Fr.FAILED_PRECONDITION:return Ks.FAILED_PRECONDITION;case Fr.ABORTED:return Ks.ABORTED;case Fr.OUT_OF_RANGE:return Ks.OUT_OF_RANGE;case Fr.UNIMPLEMENTED:return Ks.UNIMPLEMENTED;case Fr.DATA_LOSS:return Ks.DATA_LOSS;default:return Rr("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return Rr("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e;if("targetChange"in t){Fu(t.targetChange,"targetChange");var n=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=t.targetChange.resumeToken||this.emptyByteString(),o=t.targetChange.cause,a=o&&this.fromRpcStatus(o);e=new su(n,r,i,a||null)}else if("documentChange"in t){Fu(t.documentChange,"documentChange"),Fu(t.documentChange.document,"documentChange.name"),Fu(t.documentChange.document.name,"documentChange.document.name"),Fu(t.documentChange.document.updateTime,"documentChange.document.updateTime");var s=t.documentChange,u=this.fromName(s.document.name),c=this.fromVersion(s.document.updateTime),l=this.fromFields(s.document.fields||{}),h=new Po(u,c,l,{},s.document),f=s.targetIds||[],d=s.removedTargetIds||[];e=new ou(f,d,h.key,h)}else if("documentDelete"in t){Fu(t.documentDelete,"documentDelete"),Fu(t.documentDelete.document,"documentDelete.document");var p=t.documentDelete;u=this.fromName(p.document),c=p.readTime?this.fromVersion(p.readTime):Ui.forDeletedDoc(),h=new Ro(u,c),d=p.removedTargetIds||[],e=new ou([],d,h.key,h)}else if("documentRemove"in t){Fu(t.documentRemove,"documentRemove"),Fu(t.documentRemove.document,"documentRemove");var m=t.documentRemove;u=this.fromName(m.document),d=m.removedTargetIds||[],e=new ou([],d,u,null)}else{if(!("filter"in t))return Rr("Unknown change type "+JSON.stringify(t));Fu(t.filter,"filter"),Fu(t.filter.targetId,"filter.targetId");var y=t.filter,g=y.count||0,v=new Ru(g),b=y.targetId;e=new au(b,v)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Zs.NoChange:"ADD"===t?Zs.Added:"REMOVE"===t?Zs.Removed:"CURRENT"===t?Zs.Current:"RESET"===t?Zs.Reset:Rr("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return Ui.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ui.MIN:e.readTime?this.fromVersion(e.readTime):Ui.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof us)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof hs)e={delete:this.toName(t.key)};else if(t instanceof cs)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof ls))return Rr("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):as.NONE;if(t.update){Fu(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new cs(r,i,o,n)}return new us(r,i,n)}if(t.delete)return r=this.fromName(t.delete),new hs(r,n);if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return Mr(!0===n.exists,'Transforms only support precondition "exists == true"'),new ls(r,a)}return Rr("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return Mr(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Rr("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?as.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?as.exists(t.exists):as.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e),i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new os(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&0<t.length?(Mr(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof Au)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Du)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof Cu)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof Nu)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw Rr("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)Mr("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=Au.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Du(r.map(function(t){return e.fromValue(t)}))}else if("removeAllFromArray"in t)r=t.removeAllFromArray.values||[],n=new Cu(r.map(function(t){return e.fromValue(t)}));else if("increment"in t){var i=this.fromValue(t.increment);Mr(i instanceof Ka,"NUMERIC_ADD transform requires a NumberValue"),n=new Nu(i)}else Rr("Unknown transform proto: "+JSON.stringify(t));var o=Ai.fromServerFormat(t.fieldPath);return new is(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;Mr(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return mu.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(Mr(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(Mr(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){Mr(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new mu(e,i,s,a,u,c,l)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case la.Listen:return null;case la.ExistenceFilterMismatch:return"existence-filter-mismatch";case la.LimboResolution:return"limbo-document";default:return Rr("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,0<t.resumeToken.length&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof gu?e.toUnaryOrFieldFilter(t):Rr("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):Rr("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new Tu(r,n)},t.prototype.toDirection=function(t){return Mu[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return Su.ASCENDING;case"DESCENDING":return Su.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return Lu[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return yu.EQUAL;case"GREATER_THAN":return yu.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return yu.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return yu.LESS_THAN;case"LESS_THAN_OR_EQUAL":return yu.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return yu.ARRAY_CONTAINS;case"IN":return yu.IN;case"ARRAY_CONTAINS_ANY":return yu.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Rr("Unspecified operator");default:return Rr("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return Ai.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new Iu(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return gu.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===yu.EQUAL){if(t.value.isEqual(Ha.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(Ua.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return gu.create(e,yu.EQUAL,Ha.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return gu.create(n,yu.EQUAL,Ua.INSTANCE);case"OPERATOR_UNSPECIFIED":return Rr("Unspecified filter");default:return Rr("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return Ai.fromServerFormat(t)});return rs.fromArray(e)},t}(),Uu=function(){this.listeners=[]},Vu=function(){function t(t){this.syncEngine=t,this.queries=new Lo(function(t){return t.canonicalId()}),this.onlineState=Rs.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new Uu,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return l(this,void 0,void 0,function(){var e,n,r,i;return h(this,function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&0<=(i=r.listeners.indexOf(t))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(r);o.viewSnap=r}}},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++)i[r].applyOnlineStateChange(t)})},t}(),Ku=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=Rs.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(Mr(0<t.docChanges.length||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Hs.Metadata&&e.push(i)}t=new nu(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(Mr(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Rs.Offline;return this.options.waitForSyncWhenOnline&&n?(Mr(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Rs.Offline},t.prototype.shouldRaiseEvent=function(t){if(0<t.docChanges.length)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){Mr(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=nu.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),zu=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){for(var r=no(),i=no(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Hs.Added:r=r.add(s.doc.key);break;case Hs.Removed:i=i.add(s.doc.key)}}return new t(e,r,i)},t}(),Gu=function(t){this.key=t},Wu=function(t){this.key=t},Qu=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=no(),this.mutatedKeys=no(),this.documentSet=new Js(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new eu,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var c=i.get(t),l=e instanceof Po?e:null;l&&(Mr(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var h=!!c&&n.mutatedKeys.has(c.key),f=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;c&&l?c.data.isEqual(l.data)?h!==f&&(r.track({type:Hs.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(c,l)||(r.track({type:Hs.Modified,doc:l}),d=!0,u&&0<n.query.docComparator(l,u)&&(s=!0)):!c&&l?(r.track({type:Hs.Added,doc:l}),d=!0):c&&!l&&(r.track({type:Hs.Removed,doc:c}),d=!0,u&&(s=!0)),d&&(o=l?(a=a.add(l),f?o.add(t):o.delete(t)):(a=a.delete(t),o.delete(t)))}),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:Hs.Removed,doc:c})}return Mr(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;Mr(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return n=t.type,i=e.type,(o=function(t){switch(t){case Hs.Added:return 1;case Hs.Modified:case Hs.Metadata:return 2;case Hs.Removed:return 0;default:return Rr("Unknown ChangeType: "+t)}})(n)-o(i)||r.query.docComparator(t.doc,e.doc);var n,i,o}),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Xs.Synced:Xs.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new nu(this.query,t.documentSet,i,o,t.mutatedKeys,s===Xs.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Rs.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new eu,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return Mr(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=no(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Wu(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Gu(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=no();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return nu.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Xs.Local)},t}(),Hu="SyncEngine",Yu=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Xu=function(t){this.key=t},$u=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Lo(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Vi(Di.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new ds,this.mutationUserCallbacks={},this.limboTargetIdGenerator=vo.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Rs.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){Mr(null!==t,"SyncEngine listener cannot be null"),Mr(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return l(this,void 0,void 0,function(){var e,n,r,i,o;return h(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){var n=this,r=t.query;return this.localStore.executeQuery(r).then(function(i){return n.localStore.remoteDocumentKeys(t.targetId).then(function(o){var a=new Qu(r,o),s=a.computeDocChanges(i),u=iu.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&n.onlineState!==Rs.Offline),c=a.applyChanges(s,!0===n.isPrimary,u);Mr(0===c.limboChanges.length,"View returned limbo docs before target ack from the server."),Mr(!!c.snapshot,"applyChanges for new view should always return a snapshot");var l=new Yu(r,t.targetId,a);return n.queryViewsByQuery.set(r,l),n.queryViewsByTarget[t.targetId]=l,c.snapshot})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){var e=this;return this.localStore.executeQuery(t.query).then(function(n){return e.localStore.remoteDocumentKeys(t.targetId).then(function(r){return l(e,void 0,void 0,function(){var e;return h(this,function(i){return e=t.view.synchronizeWithPersistedState(n,r),this.isPrimary&&this.updateTrackedLimbos(t.targetId,e.limboChanges),[2,e]})})})})},t.prototype.unlisten=function(t){return l(this,void 0,void 0,function(){var e,n=this;return h(this,function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),Mr(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){n.sharedClientState.clearQueryState(e.targetId),n.remoteStore.unlisten(e.targetId),n.removeAndCleanupQuery(e)}).catch(Na)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.sharedClientState.addPendingMutation(t.batchId),n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),Mr(0<=e,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!Ds(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(e){return Promise.reject(n.wrapUpdateFunctionError(e))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),this.localStore.applyRemoteEvent(t).then(function(n){return zr(t.targetChanges,function(t,n){var r=e.limboResolutionsByTarget[Number(t)];r&&(Mr(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),0<n.addedDocuments.size?r.receivedDocument=!0:0<n.modifiedDocuments.size?Mr(r.receivedDocument,"Received change for limbo target document without add."):0<n.removedDocuments.size&&(Mr(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),e.emitNewSnapsAndNotifyLocalStore(n,t)}).catch(Na)},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===Ls.RemoteStore||!this.isPrimary&&e===Ls.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);Mr(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,a,s,u=this;return h(this,function(c){switch(c.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new Vi(Di.comparator)).insert(r,new Ro(r,Ui.forDeletedDoc())),o=no().add(r),a=new ru(Ui.MIN,{},new Wi(li),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return Mr(!!(s=this.queryViewsByTarget[t]),"Unknown targetId: "+t),[4,this.localStore.releaseQuery(s.query,!1).then(function(){return u.removeAndCleanupQuery(s)}).catch(Na)];case 2:c.sent(),this.syncEngineListener.onWatchError(s.query,e),c.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return l(this,void 0,void 0,function(){var r;return h(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(Or(Hu,"Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):Rr("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){var e=this;this.assertSubscribed("applySuccessfulWrite()");var n=t.batch.batchId;return this.processUserCallback(n,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.sharedClientState.updateMutationState(n,"acknowledged"),e.emitNewSnapsAndNotifyLocalStore(t)}).catch(Na)},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(r){return n.sharedClientState.updateMutationState(t,"rejected",e),n.emitNewSnapsAndNotifyLocalStore(r)}).catch(Na)},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Vi(li)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(Mr(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){e.limboDocumentRefs.containsKey(t)||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Gu?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof Wu?(Or(Hu,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):Rr("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){Or(Hu,"New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=mu.atPath(e.path);this.limboResolutionsByTarget[n]=new Xu(e),this.remoteStore.listen(new ga(r,n,la.LimboResolution,Si.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o=this;return h(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=zu.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){Mr(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return l(this,void 0,void 0,function(){var e,n;return h(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?[4,this.localStore.handleUserChange(t)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return l(this,void 0,void 0,function(){var e,n,r,i,o,a,s,u=this;return h(this,function(c){switch(c.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return c.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=c.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),Kr(this.queryViewsByTarget,function(t,e){u.sharedClientState.isLocalQueryTarget(t)?a.push(t):s=s.then(function(){return u.unlisten(e.query)}),u.remoteStore.unlisten(e.targetId)}),[4,s]);case 4:return c.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return c.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;Kr(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Vi(Di.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){for(var e=this,n=Promise.resolve(),r=[],i=[],o=function(t){n=n.then(function(){return l(e,void 0,void 0,function(){var e,n,o,a;return h(this,function(s){switch(s.label){case 0:return(n=this.queryViewsByTarget[t])?[4,this.localStore.releaseQuery(n.query,!0)]:[3,4];case 1:return s.sent(),[4,this.localStore.allocateQuery(n.query)];case 2:return e=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(n)];case 3:return(o=s.sent()).snapshot&&i.push(o.snapshot),[3,8];case 4:return Mr(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(t)];case 5:return Mr(!!(a=s.sent()),"Query data for target "+t+" not found"),[4,this.localStore.allocateQuery(a)];case 6:return e=s.sent(),[4,this.initializeViewAndComputeSnapshot(e,!1)];case 7:s.sent(),s.label=8;case 8:return r.push(e),[2]}})})})},a=0,s=t;a<s.length;a++)o(s[a]);return n.then(function(){return e.syncEngineListener.onWatchChange(i),r})},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return l(this,void 0,void 0,function(){var r,i=this;return h(this,function(o){switch(o.label){case 0:if(this.isPrimary)return Or(Hu,"Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[t])return[3,5];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,2]}return[3,4];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(n){return l(i,void 0,void 0,function(){var r;return h(this,function(i){switch(i.label){case 0:return r=ru.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(n,r)];case 1:return i.sent(),[2]}})})},function(t){return l(i,void 0,void 0,function(){var e;return h(this,function(n){switch(n.label){case 0:return(r=t).code!==Fr.DATA_LOSS||r.message!==Fo?[3,2]:(e=[],Kr(this.queryViewsByTarget,function(t){return e.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e)]);case 1:return n.sent(),[3,3];case 2:throw t;case 3:return[2]}var r})})})];case 2:return r=this.queryViewsByTarget[t],this.removeAndCleanupQuery(r),[4,this.localStore.releaseQuery(r.query,!0)];case 3:return o.sent(),this.syncEngineListener.onWatchError(r.query,n),[3,5];case 4:Rr("Unexpected target state: "+e),o.label=5;case 5:return[2]}})})},t.prototype.applyActiveTargetsChange=function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,f=this;return h(this,function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,d.label=1;case 1:return n<r.length?(l=r[n],Mr(!this.queryViewsByTarget[l],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(l)]):[3,6];case 2:return Mr(!!(i=d.sent()),"Query data for active target "+l+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return o=d.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:d.sent(),this.remoteStore.listen(o),d.label=5;case 5:return n++,[3,1];case 6:a=function(t){var e;return h(this,function(n){switch(n.label){case 0:return(e=s.queryViewsByTarget[t])?[4,s.localStore.releaseQuery(e.query,!1).then(function(){f.remoteStore.unlisten(t),f.removeAndCleanupQuery(e)}).catch(Na)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},s=this,u=0,c=e,d.label=7;case 7:return u<c.length?(l=c[u],[5,a(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?no().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:no()},t}(),Ju=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Zu="SharedClientState",tc="firestore_clients",ec="firestore_mutations",nc="firestore_targets",rc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,Mr(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new qr(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(xr(Zu,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ic=function(){function t(t,e,n){this.targetId=t,this.state=e,Mr(void 0!==(this.error=n)==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new qr(r.error.code,r.error.message)),i?new t(e,r.state,o):(xr(Zu,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),oc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=io(),a=0;i&&a<r.activeTargetIds.length;++a)i=Cs(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(xr(Zu,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ac=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&n.onlineState in Rs&&"string"==typeof n.clientId?new t(n.clientId,Rs[n.onlineState]):(xr(Zu,"Failed to parse online state: "+e),null)},t}(),sc=function(){function t(){this.activeTargetIds=io()}return t.prototype.addQueryTarget=function(t){Mr(!this.activeTargetIds.has(t),"Target with ID '"+t+"' already active."),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),uc=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new qr(Fr.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey="firestore_sequence_number_"+r,this.activeClients[this.localClientId]=new sc,this.clientStateKeyRe=new RegExp("^"+tc+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+ec+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+nc+"_"+a+"_(\\d+)$"),this.onlineStateKey="firestore_online_state_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return l(this,void 0,void 0,function(){var t,e,n,r,i,o,a,s,u,c,l,f=this;return h(this,function(h){switch(h.label){case 0:return Mr(!this.started,"WebStorageSharedClientState already started"),Mr(null!==this.syncEngine,"syncEngine property must be set before calling start()"),Mr(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=oc.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)l=c[u],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return f.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=io();return zr(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=ic.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Or(Zu,"READ",t,e),e},t.prototype.setItem=function(t,e){Or(Zu,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Or(Zu,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(Or(Zu,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return l(e,void 0,void 0,function(){var e,n,r,i,o,a;return h(this,function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(Mr(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(t){var e=Si.INVALID;if(null!=t)try{var n=JSON.parse(t);Mr("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){xr(Zu,"Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Si.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new rc(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:Rs[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new ic(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return Mr(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),tc+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return nc+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=ec+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return Mr(null!==n,"Cannot parse client state key '"+t+"'"),oc.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);Mr(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return rc.fromWebStorageEntry(new Ju(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);Mr(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return ic.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return ac.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return l(this,void 0,void 0,function(){return h(this,function(e){return t.user.uid!==this.currentUser.uid?(Or(Zu,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(t){return l(n,void 0,void 0,function(){return h(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return l(n,void 0,void 0,function(){return h(this,function(e){return i.has(t)||a.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}(),cc=function(){function t(){this.localState=new sc,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new sc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),lc="FirestoreClient",hc=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return Sa.withCacheSize(this.cacheSizeBytes)},t}(),fc=function(){},dc=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=ci.newId(),this._clientShutdown=!1}return t.prototype.start=function(t){var e=this;this.verifyNotShutdown();var n=new Ci,r=new Ci,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof hc?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof qr?t.code===Fr.FAILED_PRECONDITION||t.code===Fr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.verifyNotShutdown=function(){if(this._clientShutdown)throw new qr(Fr.FAILED_PRECONDITION,"The client has already been shutdown.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Ca.buildStoragePrefix(this.databaseInfo),i=new Bu(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return l(n,void 0,void 0,function(){var n,o;return h(this,function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!uc.isAvailable(this.platform))throw new qr(Fr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return o=e.lruParams(),e.synchronizeTabs?(this.sharedClientState=new uc(this.asyncQueue,this.platform,r,this.clientId,t),[4,Ca.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=a.sent(),[3,4];case 2:return this.sharedClientState=new cc,[4,Ca.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=a.sent(),a.label=4;case 4:return[2,(this.persistence=n).referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=ws.createEagerPersistence(this.clientId),this.sharedClientState=new cc,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return Or(lc,"Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return l(n,void 0,void 0,function(){var n,i,o,a,s,u=this;return h(this,function(c){switch(c.label){case 0:return this.localStore=new ms(this.persistence,t),e&&(this.lruScheduler=new Ta(e,this.asyncQueue,this.localStore)),n=this.platform.newConnectivityMonitor(),i=this.platform.newSerializer(this.databaseInfo.databaseId),o=new Us(this.asyncQueue,r,this.credentials,i),a=function(t){return u.syncEngine.applyOnlineStateChange(t,Ls.RemoteStore)},s=function(t){return u.syncEngine.applyOnlineStateChange(t,Ls.SharedClientState)},this.remoteStore=new du(this.localStore,o,this.asyncQueue,a,n),this.syncEngine=new $u(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=s,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new Vu(this.syncEngine),[4,this.sharedClientState.start()];case 1:return c.sent(),[4,this.remoteStore.start()];case 2:return c.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return l(u,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return c.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return l(u,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return[4,this.shutdown()];case 1:return t.sent(),[2]}})})})];case 4:return c.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),Or(lc,"Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.enqueue(function(){return l(t,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this._clientShutdown?[3,4]:(this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()]);case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:t.sent(),this.credentials.removeChangeListener(),this._clientShutdown=!0,t.label=4;case 4:return[2]}})})})},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotShutdown();var i=new Ku(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.verifyNotShutdown(),this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof Po)return t;if(t instanceof Ro)return null;throw new qr(Fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=no(),r=new Qu(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this;this.verifyNotShutdown();var n=new Ci;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},Object.defineProperty(t.prototype,"clientShutdown",{get:function(){return this._clientShutdown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return l(e,void 0,void 0,function(){return h(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),pc=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),mc=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new qr(Fr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+ui(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(Xr("FieldPath","string",n,t[n]),0===t[n].length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ai(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ai("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(Ai.keyField().canonicalString()),t}(),yc=new RegExp("[~\\*/\\[\\]]"),gc=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}},vc=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){Mr(!this.changeListener,"Can only call setChangeListener() once."),(this.changeListener=t)(Ju.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){Mr(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),bc=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;Mr(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new qr(Fr.ABORTED,"getToken aborted due to token change.");return n?(Mr("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new gc(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){Mr(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){Mr(null!=this.tokenListener,"removeChangeListener() called twice"),Mr(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return Mr(null===t||"string"==typeof t,"Received invalid UID: "+t),new Ju(t)},t}(),wc=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Ju.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),Ec=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new wc(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Ju.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Sc(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Tc,Ic,kc=function(){function t(t){this._methodName=t}return t.delete=function(){return Wr("FieldValue.delete",arguments),_c.instance},t.serverTimestamp=function(){return Wr("FieldValue.serverTimestamp",arguments),Ac.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hr("FieldValue.arrayUnion",arguments,1),new Dc(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hr("FieldValue.arrayRemove",arguments,1),new Cc(t)},t.increment=function(t){return Xr("FieldValue.increment","number",1,t),Qr("FieldValue.increment",arguments,1),new Nc(t)},t.prototype.isEqual=function(t){return this===t},t}(),_c=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return c(e,t),e.instance=new e,e}(kc),Ac=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return c(e,t),e.instance=new e,e}(kc),Dc=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return c(e,t),e}(kc),Cc=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return c(e,t),e}(kc),Nc=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return c(e,t),e}(kc),Oc=Br(kc,"Use FieldValue.<field>() instead."),xc=/^__.*__$/,Pc=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new cs(t,this.data,this.fieldMask,e)):n.push(new us(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ls(t,this.fieldTransforms)),n},t}(),Rc=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new cs(t,this.data,this.fieldMask,e)];return 0<this.fieldTransforms.length&&n.push(new ls(t,this.fieldTransforms)),n},t}();function Mc(t){switch(t){case Tc.Set:case Tc.MergeSet:case Tc.Update:return!0;case Tc.Argument:return!1;default:throw Rr("Unexpected case for UserDataSource: "+t)}}(Ic=Tc||(Tc={}))[Ic.Set=0]="Set",Ic[Ic.Update=1]="Update",Ic[Ic.MergeSet=2]="MergeSet",Ic[Ic.Argument=3]="Argument";var Lc=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new qr(Fr.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(Mc(this.dataSource)&&xc.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),jc=function(t,e){this.databaseId=t,this.key=e},Fc=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new Lc(Tc.Set,t,Ai.EMPTY_PATH);Bc("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new Pc(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new Lc(Tc.MergeSet,t,Ai.EMPTY_PATH);Bc("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Wi(Ai.comparator),u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof mc)h=l._internalPath;else{if("string"!=typeof l)throw Rr("Expected stringOrFieldPath to be a string or a FieldPath");h=Vc(t,l)}if(!r.contains(h))throw new qr(Fr.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}i=rs.fromSet(s),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=rs.fromArray(r.fieldMask),o=r.fieldTransforms;return new Pc(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new Lc(Tc.Update,t,Ai.EMPTY_PATH);Bc("Data must be an object, but it was:",r,e);var i=new Wi(Ai.comparator),o=es.EMPTY;zr(e,function(e,a){var s=Vc(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof _c)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=rs.fromSet(i);return new Rc(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new Lc(Tc.Update,t,Ai.EMPTY_PATH),o=[Uc(t,e)],a=[n];if(r.length%2!=0)throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Uc(t,r[s])),a.push(r[s+1]);var u=new Wi(Ai.comparator),c=es.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof _c)u=u.add(l);else{var d=this.parseData(f,h);null!=d&&(u=u.add(l),c=c.set(l,d))}}var p=rs.fromSet(u);return new Rc(c,p,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new Lc(Tc.Argument,t,Ai.EMPTY_PATH),r=this.parseData(e,n);return Mr(null!=r,"Parsed data should not be null."),Mr(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Kc(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(qc(t=this.runPreConverter(t,e)))return Bc("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof kc)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new Vi(li);return Gr(t)?e.path&&0<e.path.length&&e.fieldMask.push(e.path):zr(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new es(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Ua.INSTANCE),n.push(s),r++}return new ns(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Mc(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof _c){if(e.dataSource!==Tc.MergeSet)throw e.dataSource===Tc.Update?(Mr(0<e.path.length,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof Ac)e.fieldTransforms.push(new is(e.path,Au.instance));else if(t instanceof Dc){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new Du(n);e.fieldTransforms.push(new is(e.path,r))}else if(t instanceof Cc){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new Cu(n);e.fieldTransforms.push(new is(e.path,i))}else if(t instanceof Nc){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new Nu(o);e.fieldTransforms.push(new is(e.path,a))}else Rr("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Ua.INSTANCE;if("number"==typeof t)return Cs(t)?new Qa(t):new Ha(t);if("boolean"==typeof t)return Va.of(t);if("string"==typeof t)return new Ya(t);if(t instanceof Date)return new Xa(Bi.fromDate(t));if(t instanceof Bi)return new Xa(new Bi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof pu)return new ts(t);if(t instanceof gi)return new Ja(t);if(t instanceof jc)return new Za(t.databaseId,t.key);throw e.createError("Unsupported field value: "+ri(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new Lc(Tc.Argument,t,Ai.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function qc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Bi||t instanceof pu||t instanceof gi||t instanceof jc||t instanceof kc)}function Bc(t,e,n){if(!qc(n)||!ni(n)){var r=ri(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Uc(t,e){if(e instanceof mc)return e._internalPath;if("string"==typeof e)return Vc(t,e);throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Vc(t,e){try{return function(t){if(0<=t.search(yc))throw new qr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(mc.bind.apply(mc,[void 0].concat(t.split("."))))}catch(e){throw new qr(Fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=Kc(e);throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Kc(t){return t instanceof Error?t.message:t.toString()}var zc=Sa.COLLECTION_DISABLED,Gc=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new qr(Fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Jr("settings","non-empty string","host",t.host),this.host=t.host,Zr("settings","boolean","ssl",t.ssl),this.ssl=Vr(t.ssl,!0);if(oi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Zr("settings","object","credentials",t.credentials),this.credentials=t.credentials,Zr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?xr("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&xr("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Vr(t.timestampsInSnapshots,!0),Zr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Sa.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==zc&&t.cacheSizeBytes<Sa.MINIMUM_CACHE_SIZE_BYTES)throw new qr(Fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Sa.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}Zr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Wc=function(){},Qc=function(){function t(e){var n=this;this._queue=new Oi,this.INTERNAL={delete:function(){return l(n,void 0,void 0,function(){return h(this,function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.shutdown()];case 1:return t.sent(),[2]}})})}};var r=new Wc;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new bc(i)}else{var o=e;if(!o.projectId)throw new qr(Fr.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new Ei(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new vc}r.settings=new Gc({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(Qr("Firestore.settings",arguments,1),Xr("Firestore.settings","object",1,t),Ur(t,"persistence"))throw new qr(Fr.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Gc(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new qr(Fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this._config.settings=e).credentials&&(this._config.credentials=function(t){if(!t)return new vc;switch(t.type){case"gapi":var e=t.client;return Mr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Ec(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new qr(Fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new qr(Fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=Vr(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new hc(this._config.settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=Ca.buildStoragePrefix(this.makeDatabaseInfo()),n=new Ci;return this._queue.enqueueAndForget(function(){return l(t,void 0,void 0,function(){var t;return h(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientShutdown)throw new qr(Fr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Ca.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new fc),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new bi(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl,this._config.settings.forceLongPolling)},t.prototype.configureClient=function(t){var e=this;Mr(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),Mr(!this._firestoreClient,"configureClient() called multiple times");var n=this.makeDatabaseInfo();return this._dataConverter=new Fc(function(t){if(t instanceof Xc){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new qr(Fr.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new jc(e._config.databaseId,t._key)}return t}),this._firestoreClient=new dc(Lr.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!Ur(e,"projectId"))throw new qr(Fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new qr(Fr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ei(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new qr(Fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return Qr("Firestore.collection",arguments,1),Xr("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new nl(ki.fromString(t),this)},t.prototype.doc=function(t){return Qr("Firestore.doc",arguments,1),Xr("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),Xc.forPath(ki.fromString(t),this)},t.prototype.collectionGroup=function(t){if(Qr("Firestore.collectionGroup",arguments,1),Xr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new tl(new mu(ki.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return Qr("Firestore.runTransaction",arguments,1),Xr("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Hc(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Yc(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(Cr()){case br.DEBUG:return"debug";case br.ERROR:return"error";case br.SILENT:return"silent";default:return Rr("Unknown log level: "+Cr())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(Qr("Firestore.setLogLevel",arguments,1),Xr("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Nr(br.DEBUG);break;case"error":Nr(br.ERROR);break;case"silent":Nr(br.SILENT);break;default:throw new qr(Fr.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),Hc=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;Qr("Transaction.get",arguments,1);var n=al("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Rr("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof Ro)return new Jc(e._firestore,n._key,null,!1,!1);if(r instanceof Po)return new Jc(e._firestore,n._key,r,!1,!1);throw Rr("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){Yr("Transaction.set",arguments,2,3);var r=al("Transaction.set",t,this._firestore),i=(n=rl("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return i="string"==typeof e||e instanceof mc?(Hr("Transaction.update",arguments,3),r=al("Transaction.update",t,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(Qr("Transaction.update",arguments,2),r=al("Transaction.update",t,this._firestore),this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){Qr("Transaction.delete",arguments,1);var e=al("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Yc=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){Yr("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=al("WriteBatch.set",t,this._firestore),i=(n=rl("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,as.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),i="string"==typeof e||e instanceof mc?(Hr("WriteBatch.update",arguments,3),r=al("WriteBatch.update",t,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(Qr("WriteBatch.update",arguments,2),r=al("WriteBatch.update",t,this._firestore),this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,as.exists(!0))),this},t.prototype.delete=function(t){Qr("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=al("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new hs(e._key,as.NONE)),this},t.prototype.commit=function(){return l(this,void 0,void 0,function(){return h(this,function(t){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new qr(Fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Xc=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new qr(Fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new Di(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new nl(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(Qr("DocumentReference.collection",arguments,1),Xr("DocumentReference.collection","non-empty string",1,t),!t)throw new qr(Fr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ki.fromString(t);return new nl(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ai("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){Yr("DocumentReference.set",arguments,1,2);var n=(e=rl("DocumentReference.set",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,as.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof mc?(Hr("DocumentReference.update",arguments,2),this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(Qr("DocumentReference.update",arguments,1),this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,as.exists(!0)))},t.prototype.delete=function(){return Qr("DocumentReference.delete",arguments,0),this._firestoreClient.write([new hs(this._key,as.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Sc(t[i])||(oi("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Zr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=Sc(t[i])?t[i]:(Xr("DocumentReference.onSnapshot","function",i,t[i]),$r("DocumentReference.onSnapshot","function",i+1,t[i+1]),$r("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new pc({next:function(t){if(e.next){Mr(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Jc(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(mu.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return Yr("DocumentReference.get",arguments,0,1),ol("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new Jc(e.firestore,e._key,t,!0,t instanceof Po&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new qr(Fr.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new qr(Fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),$c=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Jc=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return Yr("DocumentSnapshot.data",arguments,0,1),t=il("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,qa.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(Yr("DocumentSnapshot.get",arguments,1,2),e=il("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(Uc("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,qa.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Xc(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new $c(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw ai("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof es)return this.convertObject(t,e);if(t instanceof ns)return this.convertArray(t,e);if(t instanceof Za){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||xr("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Xc(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Zc=function(t){function e(e,n,r,i,o){return t.call(this,e,n,r,i,o)||this}return c(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return Mr("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Jc),tl=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){Qr("Query.where",arguments,3),ii("Query.where",3,r),"in"!==n&&"array-contains-any"!==n&&function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new qr(Fr.INVALID_ARGUMENT,"Invalid value "+ri(r)+" provided to function Query.where() for its "+si(2)+" argument. Acceptable values: "+e.join(", "))}(0,["<","<=","==",">=",">","array-contains"],0,n);var i,o=Uc("Query.where",e),a=yu.fromString(n);if(o.isKeyField()){if(a===yu.ARRAY_CONTAINS||a===yu.ARRAY_CONTAINS_ANY||a===yu.IN)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+a.toString()+"' queries on FieldPath.documentId().");if("string"==typeof r){if(""===r)throw new qr(Fr.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==r.indexOf("/"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid third parameter to Query.where(). When querying a collection by FieldPath.documentId(), the value provided must be a plain document ID, but '"+r+"' contains a slash.");var s=this._query.path.child(ki.fromString(r));if(!Di.isDocumentKey(s))throw new qr(Fr.INVALID_ARGUMENT,"Invalid third parameter to Query.where(). When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+s+"' is not because it has an odd number of segments ("+s.length+").");i=new Za(this.firestore._databaseId,new Di(s))}else{if(!(r instanceof Xc))throw new qr(Fr.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+ri(r)+".");var u=r;i=new Za(this.firestore._databaseId,u._key)}}else{if(a===yu.IN||a===yu.ARRAY_CONTAINS_ANY){if(!Array.isArray(r)||0===r.length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+a.toString()+"' filters.");if(10<r.length)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. '"+a.toString()+"' filters support a maximum of 10 elements in the value array.")}i=this.firestore._dataConverter.parseQueryValue("Query.where",r)}var c=gu.create(o,a,i);return this.validateNewFilter(c),new t(this._query.addFilter(c),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(Yr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=Su.ASCENDING;else{if("desc"!==n)throw new qr(Fr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Su.DESCENDING}if(null!==this._query.startAt)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Uc("Query.orderBy",e),o=new Iu(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(Qr("Query.limit",arguments,1),Xr("Query.limit","number",1,e),e<=0)throw new qr(Fr.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Hr("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Hr("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Hr("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Hr("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ai("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(ii(t,1,e),e instanceof Jc){if(0<n.length)throw new qr(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new qr(Fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Za(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(s instanceof $a)throw new qr(Fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(void 0===s){var u=a.field.canonicalString();throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Tu(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new qr(Fr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(ki.fromString(a));if(!Di.isDocumentKey(s))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new Di(s);i.push(new Za(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new Tu(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Sc(t[i])||(oi("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Zr("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=Sc(t[i])?t[i]:(Xr("Query.onSnapshot","function",i,t[i]),$r("Query.onSnapshot","function",i+1,t[i+1]),$r("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new pc({next:function(t){e.next&&e.next(new el(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return Yr("Query.get",arguments,0,1),ol("Query.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new el(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new qr(Fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.validateNewFilter=function(t){if(t instanceof gu){var e=[yu.ARRAY_CONTAINS,yu.ARRAY_CONTAINS_ANY],n=[yu.IN,yu.ARRAY_CONTAINS_ANY],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new qr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new qr(Fr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new qr(Fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),el=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new $c(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Yr("QuerySnapshot.forEach",arguments,1,2),Xr("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new tl(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(oi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Zr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new qr(Fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Zc(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return Mr(e.type===Hs.Added,"Invalid event type for first snapshot"),Mr(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Hs.Metadata}).map(function(e){var r=new Zc(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==Hs.Added&&(Mr(0<=(i=o.indexOf(e.doc.key)),"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Hs.Removed&&(a=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case Hs.Added:return"added";case Hs.Modified:case Hs.Metadata:return"modified";case Hs.Removed:return"removed";default:return Rr("Unknown change type: "+t)}}(e.type),doc:r,oldIndex:i,newIndex:a}})}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ai("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Zc(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();["length","forEach","map"].concat("undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(el.prototype.docChanges,t,{get:function(){return function(){throw new qr(Fr.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var nl=function(t){function e(e,n){var r=t.call(this,mu.atPath(e),n)||this;if(e.length%2!=1)throw new qr(Fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return c(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Xc(new Di(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(Yr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=ci.newId()),Xr("CollectionReference.doc","non-empty string",1,t),""===t)throw new qr(Fr.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=ki.fromString(t);return Xc.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){Qr("CollectionReference.add",arguments,1),Xr("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(tl);function rl(t,e){if(void 0===e)return{merge:!1};if(oi(t,e,["merge","mergeFields"]),Zr(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ri(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new qr(Fr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+ri(r[o]))}(t,e,n,r,i)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof mc}),void 0!==e.mergeFields&&void 0!==e.merge)throw new qr(Fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function il(t,e){return void 0===e?{}:(oi(t,e,["serverTimestamps"]),ti(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ol(t,e){$r(t,"object",1,e),e&&(oi(t,e,["source"]),ti(t,0,"source",e.source,["default","server","cache"]))}function al(t,e,n){if(e instanceof Xc){if(e.firestore!==n)throw new qr(Fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}var sl=Br(Qc,"Use firebase.firestore() instead."),ul=Br(Hc,"Use firebase.firestore().runTransaction() instead."),cl=Br(Yc,"Use firebase.firestore().batch() instead."),ll=Br(Xc,"Use firebase.firestore().doc() instead."),hl=Br(Jc),fl=Br(Zc),dl=Br(tl),pl=Br(el),ml=Br(nl,"Use firebase.firestore().collection() instead."),yl={Firestore:sl,GeoPoint:pu,Timestamp:Bi,Blob:vi,Transaction:ul,WriteBatch:cl,DocumentReference:ll,DocumentSnapshot:hl,Query:dl,QueryDocumentSnapshot:fl,QuerySnapshot:pl,CollectionReference:ml,FieldPath:mc,FieldValue:Oc,setLogLevel:Qc.setLogLevel,CACHE_SIZE_UNLIMITED:zc};var gl=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),vl="ConnectivityMonitor",bl=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){Or(vl,"Network connectivity changed: AVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++)(0,e[t])(0)},t.prototype.onNetworkUnavailable=function(){Or(vl,"Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.callbacks;t<e.length;t++)(0,e[t])(1)},t.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),wl=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){Mr(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){Mr(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){Mr(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){Mr(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){Mr(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){Mr(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),El="Connection",Sl={BatchGetDocuments:"batchGet",Commit:"commit"},Tl="gl-js/ fire/"+Ar,Il=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=Tl},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,a){var s=new _r;s.listenOnce(Ir.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Tr.NO_ERROR:var e=s.getResponseJson();Or(El,"XHR received:",JSON.stringify(e)),o(e);break;case Tr.TIMEOUT:Or(El,'RPC "'+t+'" timed out'),a(new qr(Fr.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:var n=s.getStatus();Or(El,'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),0<n?a(new qr(function(t){switch(t){case 200:return Fr.OK;case 400:return Fr.INVALID_ARGUMENT;case 401:return Fr.UNAUTHENTICATED;case 403:return Fr.PERMISSION_DENIED;case 404:return Fr.NOT_FOUND;case 409:return Fr.ABORTED;case 416:return Fr.OUT_OF_RANGE;case 429:return Fr.RESOURCE_EXHAUSTED;case 499:return Fr.CANCELLED;case 500:return Fr.UNKNOWN;case 501:return Fr.UNIMPLEMENTED;case 503:return Fr.UNAVAILABLE;case 504:return Fr.DEADLINE_EXCEEDED;default:return 200<=t&&t<300?Fr.OK:400<=t&&t<500?Fr.FAILED_PRECONDITION:500<=t&&t<600?Fr.INTERNAL:Fr.UNKNOWN}}(n),"Server responded with status "+s.getStatusText())):(Or(El,'RPC "'+t+'" failed'),a(new qr(Fr.UNAVAILABLE,"Connection failed.")));break;default:Rr('RPC "'+t+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{Or(El,'RPC "'+t+'" completed.')}});var u=JSON.stringify(e);Or(El,"XHR sending: ",i+" "+u);var c={"Content-Type":"text/plain"};r.modifyHeadersForRequest(c,n),s.send(i,"POST",u,c,15)})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Sr(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),"object"==typeof navigator&&"ReactNative"===navigator.product||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");Or(El,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,u=!1,c=new wl({sendFn:function(t){u?Or(El,"Not sending because WebChannel is closed:",t):(s||(Or(El,"Opening WebChannel transport."),a.open(),s=!0),Or(El,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),l=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(kr.EventType.OPEN,function(){u||Or(El,"WebChannel transport opened.")}),l(kr.EventType.CLOSE,function(){u||(u=!0,Or(El,"WebChannel transport closed"),c.callOnClose())}),l(kr.EventType.ERROR,function(t){u||(u=!0,Or(El,"WebChannel transport errored:",t),c.callOnClose(new qr(Fr.UNAVAILABLE,"The operation could not be completed")))}),l(kr.EventType.MESSAGE,function(t){if(!u){var e=t.data[0];Mr(!!e,"Got a webchannel message without data.");var n=e,r=n.error||n[0]&&n[0].error;if(r){Or(El,"WebChannel received error:",r);var i=r.status,o=function(t){var e=Ks[i];if(void 0!==e)return Qs(e)}(),s=r.message;void 0===o&&(o=Fr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),u=!0,c.callOnClose(new qr(o,s)),a.close()}else Or(El,"WebChannel received:",e),c.callOnMessage(e)}}),setTimeout(function(){c.callOnOpen()},0),c},t.prototype.makeUrl=function(t){var e=Sl[t];Mr(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),kl=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new Il(t))},t.prototype.newConnectivityMonitor=function(){return bl.isAvailable()?new bl:new gl},t.prototype.newSerializer=function(t){return new Bu(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();Lr.setPlatform(new kl),function(t){t.INTERNAL.registerService("firestore",function(t){return new Qc(t)},function(t){Mr(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(yl))}(t)}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore - be sure to load firebase-app.js first.")}},"object"==typeof exports&&void 0!==t?o(n(66)):"function"==typeof define&&n(50)?define(["@firebase/app"],o):o((i=i||self).firebase)}).call(this,n(17),n(64))},function(t,e,n){var r=n(13),i=n(108).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){var r=n(13),i=n(5),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(54)(Function.call,n(60).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){"use strict";var r=n(8),i=n(11),o=n(9),a=n(4)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(67),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){try{return u.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=l(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var h=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var d="FirebaseError",p=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=d,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?y(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new p(i,s),c=0,l=Object.keys(r);c<l.length;c++){var h=l[c];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},t}();function y(t,e){return t.replace(g,function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"})}var g=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(t){return JSON.parse(t)}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var b=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=v(c(o[0])||""),n=v(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},w=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},E=function(t,e){return w(e,function(e,n){t[e]=n}),t},S=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},T=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var I=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=k),void 0===r.error&&(r.error=k),void 0===r.complete&&(r.complete=k);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function k(){}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e.CONSTANTS=i,e.Deferred=h,e.ErrorFactory=m,e.FirebaseError=p,e.Sha1=T,e.assert=o,e.assertionError=a,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}},e.base64=u,e.base64Decode=c,e.base64Encode=function(t){var e=s(t);return u.encodeByteArray(e,!0)},e.clone=function(t){return E({},t)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new I(t,e);return n.subscribe.bind(n)},e.decode=b,e.deepCopy=
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t){return l(void 0,t)},e.deepExtend=l,e.errorPrefix=_,e.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0},e.extend=E,e.findKey=S,e.findValue=function(t,e,n){var r=S(t,e,n);return r&&t[r]},e.forEach=w,e.getAnyKey=function(t){for(var e in t)return e},e.getCount=function(t){var e=0;for(var n in t)e++;return e},e.getUA=f,e.getValues=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},e.isAdmin=function(t){var e=b(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(t){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isNonNullObject=function(t){return"object"==typeof t&&null!==t},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isValidFormat=function(t){var e=b(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=b(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=b(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=v,e.map=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},e.querystring=function(t){var e=[];return w(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},e.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;o(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(_(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(_(t,e,r)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(_(t,e,r)+"must be a valid firebase namespace.")}}).call(this,n(17))},function(t,e,n){"use strict";n.r(e),n.d(e,"LogLevel",function(){return r}),n.d(e,"Logger",function(){return s}),n.d(e,"setLogLevel",function(){return u});
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var r,i=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));var o=r.INFO,a=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case r.DEBUG:case r.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case r.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},s=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=a,i.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,r.ERROR].concat(t))},t}();
/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function u(t){i.forEach(function(e){e.logLevel=t})}},function(t,e,n){"use strict";(function(e){var r,i;n(51),n(1),n(35),n(49),n(6),n(36),n(3),n(65),n(2);r=void 0,i=function(t){try{(function(){t=t&&t.hasOwnProperty("default")?t.default:t,function(){var n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i="undefined"!=typeof window&&window===this?this:void 0!==e&&null!=e?e:this;function o(t){var e,n,r="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return r?r.call(t):{next:(e=t,n=0,function(){return n<e.length?{done:!1,value:e[n++]}:{done:!0}})}}!function(t,e){if(e){var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in n||(n[a]={}),n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var a=i.setTimeout;n.prototype.c=function(t){a(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.o),reject:t(this.g)}},e.prototype.o=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.u(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.l(t):this.h(t)}},e.prototype.l=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.m()},e.prototype.m=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.u=function(t){var e=this.f();t.Ja(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){o(e)}}:e}var i,o,a=new e(function(t,e){i=t,o=e});return this.Ja(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ja=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=o(t),a=i.next();!a.done;a=i.next())r(a.value).Ja(e,n)})},e.all=function(t){var n=o(t),i=n.next();return i.done?r([]):new e(function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}for(var a=[],s=0;a.push(void 0),s++,r(i.value).Ja(o(a.length-1),e),!(i=n.next()).done;);})},e});var a=a||{},s=this;function u(t){return"string"==typeof t}function c(t){return"boolean"==typeof t}var l=/^[\w+\/_-]+[=]{0,2}$/,h=null;function f(){}function d(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function p(t){return null===t}function m(t){return"array"==d(t)}function y(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function g(t){return"function"==d(t)}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var b="closure_uid_"+(1e9*Math.random()>>>0),w=0;function E(t,e,n){return t.call.apply(t.bind,arguments)}function S(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function T(t,e,n){return(T=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:S).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var k=Date.now||function(){return+new Date};function _(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,(t.prototype.constructor=t).cd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function A(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function D(t){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function C(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");D.call(this,n+t[r])}function N(t,e){throw new C("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function O(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function x(t,e){t.f(e),t.b<100&&(t.b++,e.next=t.a,t.a=e)}function P(){this.b=this.a=null}_(D,Error),D.prototype.name="CustomError",_(C,D),C.prototype.name="AssertionError",O.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var R=new O(function(){return new M},function(t){t.reset()});function M(){this.next=this.b=this.a=null}P.prototype.add=function(t,e){var n=R.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},M.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},M.prototype.reset=function(){this.next=this.b=this.a=null};var L=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(u(t))return u(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=u(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},F=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=u(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=u(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function B(t,e){return 0<=L(t,e)}function U(t,e){var n;return(n=0<=(e=L(t,e)))&&Array.prototype.splice.call(t,e,1),n}function V(t,e){!function(t,e){for(var n=u(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length})}function K(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var G,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Q=/&/g,H=/</g,Y=/>/g,X=/"/g,$=/'/g,J=/\x00/g,Z=/[\x00&<>"']/;function tt(t,e){return-1!=t.indexOf(e)}function et(t,e){return t<e?-1:e<t?1:0}t:{var nt=s.navigator;if(nt){var rt=nt.userAgent;if(rt){G=rt;break t}}G=""}function it(t){return tt(G,t)}function ot(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function at(t){for(var e in t)return!1;return!0}function st(t){var e,n={};for(e in t)n[e]=t[e];return n}var ut,ct,lt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ht(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<lt.length;o++)n=lt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ft(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function dt(t){return Z.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Q,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(H,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Y,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(X,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace($,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(J,"&#0;"))),t}function pt(t){s.setTimeout(function(){throw t},0)}function mt(t,e){ct||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);ct=function(){t.then(vt)}}else ct=function(){var t=vt;!g(s.setImmediate)||s.Window&&s.Window.prototype&&!it("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(ut||(ut=function(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!it("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=T(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0===t||it("Trident")||it("MSIE"))return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){s.setTimeout(t,0)};var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}()),ut(t)):s.setImmediate(t)}}(),yt||(ct(),yt=!0),gt.add(t,e)}var yt=!1,gt=new P;function vt(){for(var t;n=e=void 0,n=null,(e=gt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){pt(t)}x(R,t)}var e,n;yt=!1}function bt(t,e){if(this.a=wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,function(t){xt(n,Et,t)},function(t){if(!(t instanceof qt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}xt(n,St,t)})}catch(t){xt(this,St,t)}}var wt=0,Et=2,St=3;function Tt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Tt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var It=new O(function(){return new Tt},function(t){t.reset()});function kt(t,e,n){var r=It.get();return r.g=t,r.b=e,r.f=n,r}function _t(t){if(t instanceof bt)return t;var e=new bt(f);return xt(e,Et,t),e}function At(t){return new bt(function(e,n){n(t)})}function Dt(t,e,n){Pt(t,e,n,null)||mt(I(e,t))}function Ct(t){return new bt(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Eb:!0,value:o}:{Eb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Dt(t[o],I(i,o,!0),I(i,o,!1));else e(r)})}function Nt(t,e){t.b||t.a!=Et&&t.a!=St||Rt(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ot(t,e,n,r){var i=kt(null,null,null);return i.a=new bt(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(n){o(n)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof qt?o(e):t(i)}catch(e){o(e)}}:o}),Nt(i.a.c=t,i),i.a}function xt(t,e,n){var r,i;t.a==wt&&(t===n&&(e=St,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Pt(n,t.Lc,t.Mc,t)||(t.i=n,t.a=e,t.c=null,Rt(t),e!=St||n instanceof qt||(i=n,(r=t).g=!0,mt(function(){r.g&&Ft.call(null,i)}))))}function Pt(t,e,n,r){if(t instanceof bt)return Nt(t,kt(e||f,n||null,r)),!0;if(A(t))return t.then(e,n,r),!0;if(v(t))try{var i=t.then;if(g(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Rt(t){t.h||(t.h=!0,mt(t.Xb,t))}function Mt(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Lt(t,e,n,r){if(n==St&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,jt(e,n,r);else try{e.c?e.g.call(e.f):jt(e,n,r)}catch(t){Ft.call(null,t)}x(It,e)}function jt(t,e,n){e==Et?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}bt.prototype.then=function(t,e,n){return Ot(this,g(t)?t:null,g(e)?e:null,n)},bt.prototype.$goog_Thenable=!0,(n=bt.prototype).ia=function(t,e){return(t=kt(t,t,e)).c=!0,Nt(this,t),this},n.s=function(t,e){return Ot(this,null,t,e)},n.cancel=function(t){this.a==wt&&mt(function(){!function t(e,n){if(e.a==wt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==wt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Mt(r),Lt(r,o,St,n)))}e.c=null}else xt(e,St,n)}(this,new qt(t))},this)},n.Lc=function(t){this.a=wt,xt(this,Et,t)},n.Mc=function(t){this.a=wt,xt(this,St,t)},n.Xb=function(){for(var t;t=Mt(this);)Lt(this,t,this.a,this.i);this.h=!1};var Ft=pt;function qt(t){D.call(this,t)}function Bt(){this.qa=this.qa,this.ja=this.ja}_(qt,D);var Ut=0;function Vt(t){t.qa||(t.qa=!0,t.va(),0==Ut)||t[b]||(t[b]=++w)}function Kt(t){return Kt[" "](t),t}Bt.prototype.qa=!(qt.prototype.name="cancel"),Bt.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Kt[" "]=f;var zt,Gt,Wt=it("Opera"),Qt=it("Trident")||it("MSIE"),Ht=it("Edge"),Yt=Ht||Qt,Xt=it("Gecko")&&!(tt(G.toLowerCase(),"webkit")&&!it("Edge"))&&!(it("Trident")||it("MSIE"))&&!it("Edge"),$t=tt(G.toLowerCase(),"webkit")&&!it("Edge");function Jt(){var t=s.document;return t?t.documentMode:void 0}t:{var Zt="",te=(Gt=G,Xt?/rv:([^\);]+)(\)|;)/.exec(Gt):Ht?/Edge\/([\d\.]+)/.exec(Gt):Qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Gt):$t?/WebKit\/(\S+)/.exec(Gt):Wt?/(?:Version)[ \/]?(\S+)/.exec(Gt):void 0);if(te&&(Zt=te?te[1]:""),Qt){var ee=Jt();if(null!=ee&&ee>parseFloat(Zt)){zt=String(ee);break t}}zt=Zt}var ne,re={};function ie(t){return e=t,n=function(){for(var e=0,n=W(String(zt)).split("."),r=W(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=et(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||et(0==a[2].length,0==s[2].length)||et(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e},r=re,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var oe=s.document;ne=oe&&Qt?Jt()||("CSS1Compat"==oe.compatMode?parseInt(zt,10):5):void 0;var ae=Object.freeze||function(t){return t},se=!Qt||9<=Number(ne),ue=Qt&&!ie("9"),ce=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",f,e),s.removeEventListener("test",f,e)}catch(t){}return t}();function le(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function he(t,e){if(le.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{Kt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,this.screenY=r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=u(t.pointerType)?t.pointerType:fe[t.pointerType]||"",(this.a=t).defaultPrevented&&this.preventDefault()}}le.prototype.preventDefault=function(){this.Kb=!1},_(he,le);var fe=ae({2:"touch",3:"pen",4:"mouse"});he.prototype.preventDefault=function(){he.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ue)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}},he.prototype.f=function(){return this.a};var de="closure_listenable_"+(1e6*Math.random()|0),pe=0;function me(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Na=i,this.key=++pe,this.oa=this.Ia=!1}function ye(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.Na=null}function ge(t){this.src=t,this.a={},this.b=0}function ve(t,e){var n=e.type;n in t.a&&U(t.a[n],e)&&(ye(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function be(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.Na==r)return i}return-1}ge.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=be(t,e,r,i);return-1<a?(e=t[a],n||(e.Ia=!1)):((e=new me(e,this.src,o,!!r,i)).Ia=n,t.push(e)),e};var we="closure_lm_"+(1e6*Math.random()|0),Ee={};function Se(t,e,n,r,i){if(r&&r.once)Ie(t,e,n,r,i);else if(m(e))for(var o=0;o<e.length;o++)Se(t,e[o],n,r,i);else n=Pe(n),t&&t[de]?Me(t,e,n,v(r)?!!r.capture:!!r,i):Te(t,e,n,!1,r,i)}function Te(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a,s,u=v(i)?!!i.capture:!!i,c=Oe(t);if(c||(t[we]=c=new ge(t)),!(n=c.add(e,n,r,u,o)).proxy)if(a=Ne,r=s=se?function(t){return a.call(s.src,s.listener,t)}:function(t){if(!(t=a.call(s.src,s.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)ce||(i=u),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ae(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function Ie(t,e,n,r,i){if(m(e))for(var o=0;o<e.length;o++)Ie(t,e[o],n,r,i);else n=Pe(n),t&&t[de]?Le(t,e,n,v(r)?!!r.capture:!!r,i):Te(t,e,n,!0,r,i)}function ke(t,e,n,r,i){if(m(e))for(var o=0;o<e.length;o++)ke(t,e[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=Pe(n),t&&t[de]?(t=t.m,(e=String(e).toString())in t.a&&-1<(n=be(o=t.a[e],n,r,i))&&(ye(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Oe(t))&&(e=t.a[e.toString()],t=-1,e&&(t=be(e,n,r,i)),(n=-1<t?e[t]:null)&&_e(n))}function _e(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[de])ve(e.m,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ae(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Oe(e))?(ve(n,t),0==n.b&&(n.src=null,e[we]=null)):ye(t)}}}function Ae(t){return t in Ee?Ee[t]:Ee[t]="on"+t}function De(t,e,n,r){var i=!0;if((t=Oe(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=Ce(o,r),i=i&&!1!==o)}return i}function Ce(t,e){var n=t.listener,r=t.Na||t.src;return t.Ia&&_e(t),n.call(r,e)}function Ne(t,e){if(t.oa)return!0;if(se)return Ce(t,new he(e,this));if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new he(r=e,this),n=!0,!(r.keyCode<0||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=De(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=De(r[i],t,!1,e),n=n&&o}return n}function Oe(t){return(t=t[we])instanceof ge?t:null}var xe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pe(t){return g(t)?t:(t[xe]||(t[xe]=function(e){return t.handleEvent(e)}),t[xe])}function Re(){Bt.call(this),this.m=new ge(this),(this.Qb=this).Va=null}function Me(t,e,n,r,i){t.m.add(String(e),n,!1,r,i)}function Le(t,e,n,r,i){t.m.add(String(e),n,!0,r,i)}function je(t,e,n,r){if(!(e=t.m.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.Na||a.src;a.Ia&&ve(t.m,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Kb}function Fe(t,e,n){if(g(t))n&&(t=T(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=T(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function qe(t){var e=null;return new bt(function(n,r){-1==(e=Fe(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw s.clearTimeout(e),t})}function Be(t){if(t.S&&"function"==typeof t.S)return t.S();if(u(t))return t.split("");if(y(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Ue(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(y(t)||u(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Ve(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ve)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}_(Re,Bt),Re.prototype[de]=!0,Re.prototype.addEventListener=function(t,e,n,r){Se(this,t,e,n,r)},Re.prototype.removeEventListener=function(t,e,n,r){ke(this,t,e,n,r)},Re.prototype.dispatchEvent=function(t){var e,n=this.Va;if(n)for(e=[];n;n=n.Va)e.push(n);n=this.Qb;var r=t.type||t;if(u(t))t=new le(t,n);else if(t instanceof le)t.target=t.target||n;else{var i=t;ht(t=new le(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=je(a,r,!0,t)&&i}if(i=je(a=t.b=n,r,!0,t)&&i,i=je(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=je(a=t.b=e[o],r,!1,t)&&i;return i},Re.prototype.va=function(){if(Re.qb.va.call(this),this.m){var t,e=this.m;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ye(n[r]);delete e.a[t],e.b--}}this.Va=null},(n=Ve.prototype).S=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},n.U=function(){return Ke(this),this.a.concat()},n.clear=function(){this.b={},this.c=this.a.length=0},n.get=function(t,e){return ze(this.b,t)?this.b[t]:e},n.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},n.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.b=this.i=this.f="",this.m=null,this.g=this.c="",this.h=!1,t instanceof We?(this.h=void 0!==e?e:t.h,Qe(this,t.f),this.i=t.i,this.b=t.b,He(this,t.m),this.c=t.c,Ye(this,mn(t.a)),this.g=t.g):t&&(n=String(t).match(Ge))?(this.h=!!e,Qe(this,n[1]||"",!0),this.i=tn(n[2]||""),this.b=tn(n[3]||"",!0),He(this,n[4]),this.c=tn(n[5]||"",!0),Ye(this,n[6]||"",!0),this.g=tn(n[7]||"")):(this.h=!!e,this.a=new cn(null,this.h))}function Qe(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function He(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ye(t,e,n){var r,i;e instanceof cn?(t.a=e,r=t.a,(i=t.h)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=en(e,sn)),t.a=new cn(e,t.h))}function Xe(t,e,n){t.a.set(e,n)}function $e(t,e){return t.a.get(e)}function Je(t){return t instanceof We?new We(t):new We(t,void 0)}function Ze(t,e){var n=new We(null,void 0);return Qe(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return u(t)?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?an:on,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",en(n,un)),t.join("")},We.prototype.resolve=function(t){var e=new We(this),n=!!t.f;n?Qe(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.m;var r=t.c;if(n)He(e,t.m);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(tt(i,"./")||tt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?Ye(e,mn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var rn=/[#\/\?@]/g,on=/[#\?:]/g,an=/[#\?]/g,sn=/[#\?@]/g,un=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(t){t.a||(t.a=new Ve,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function hn(t){var e=Ue(t);if(void 0===e)throw Error("Keys are undefined");var n=new cn(null,void 0);t=Be(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];m(o)?pn(n,i,o):n.add(i,o)}return n}function fn(t,e){ln(t),e=yn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function dn(t,e){return ln(t),e=yn(t,e),ze(t.a.b,e)}function pn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function mn(t){var e=new cn;return e.c=t.c,t.a&&(e.a=new Ve(t.a),e.b=t.b),e}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(n=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},n.clear=function(){this.a=this.c=null,this.b=0},n.forEach=function(t,e){ln(this),this.a.forEach(function(n,r){j(n,function(n){t.call(e,n,r,this)},this)},this)},n.U=function(){ln(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},n.S=function(t){ln(this);var e=[];if(u(t))dn(this,t)&&(e=K(e,this.a.get(yn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=K(e,t[n])}return e},n.set=function(t,e){return ln(this),this.c=null,dn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},n.get=function(t,e){return t&&0<(t=this.S(t)).length?String(t[0]):e},n.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var gn=!Qt||9<=Number(ne);function vn(t,e){this.a=t===En&&e||"",this.b=wn}function bn(t){return t instanceof vn&&t.constructor===vn&&t.b===wn?t.a:(N("expected object of type Const, got '"+t+"'"),"type_error:Const")}vn.prototype.na=!0,vn.prototype.ma=function(){return this.a},vn.prototype.toString=function(){return"Const{"+this.a+"}"};var wn={},En={};function Sn(){this.a="",this.b=An}function Tn(t){return t instanceof Sn&&t.constructor===Sn&&t.b===An?t.a:(N("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function In(t,e){var n,r,i=bn(t);if(!_n.test(i))throw Error("Invalid TrustedResourceUrl format: "+i);return n=t=i.replace(kn,function(t,n){if(!Object.prototype.hasOwnProperty.call(e,n))throw Error('Found marker, "'+n+'", in format string, "'+i+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[n])instanceof vn?bn(t):encodeURIComponent(String(t))}),(r=new Sn).a=n,r}Sn.prototype.na=!0,Sn.prototype.ma=function(){return this.a.toString()},Sn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kn=/%{(\w+)}/g,_n=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^\/\\]|[^:\/\\%]+\/|[^:\/\\%]*[?#]|about:blank#)/i,An={};function Dn(){this.a="",this.b=xn}function Cn(t){return t instanceof Dn&&t.constructor===Dn&&t.b===xn?t.a:(N("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}Dn.prototype.na=!0,Dn.prototype.ma=function(){return this.a.toString()},Dn.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Nn=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function On(t){return t instanceof Dn?t:(t="object"==typeof t&&t.na?t.ma():String(t),Nn.test(t)||(t="about:invalid#zClosurez"),Pn(t))}var xn={};function Pn(t){var e=new Dn;return e.a=t,e}function Rn(){this.a="",this.b=Mn}Pn("about:blank"),Rn.prototype.na=!0,Rn.prototype.ma=function(){return this.a.toString()},Rn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Mn={};function Ln(t){var e=new Rn;return e.a=t,e}function jn(t){var e=document;return u(t)?e.getElementById(t):t}function Fn(t,e){ot(e,function(e,n){e&&"object"==typeof e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:qn.hasOwnProperty(n)?t.setAttribute(qn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}Ln("<!DOCTYPE html>"),Ln(""),Ln("<br>");var qn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Bn(t){if(t&&"number"==typeof t.length){if(v(t))return"function"==typeof t.item||"string"==typeof t.item;if(g(t))return"function"==typeof t.item}return!1}function Un(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(m(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),Gn(i,r),r.push(":"),t(e,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Gn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Vn,t,e),e.join("")}function Vn(){}var Kn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},zn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Gn(t,e){e.push('"',t.replace(zn,function(t){var e=Kn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Kn[t]=e),e}),'"')}function Wn(){var t=hr();return Qt&&!!ne&&11==ne||/Edge\/\d+/.test(t)}function Qn(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function Hn(t,e){e=e||s.window;var n="about:blank";t&&(n=Cn(On(t)).toString()),e.location.href=n}function Yn(t){return!!((t=(t||hr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Xn(t){t=t||s.window;try{t.close()}catch(t){}}function $n(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=hr().toLowerCase(),r&&(e.target=r,tt(n,"crios/")&&(e.target="_blank")),ur(hr())==ar&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Dn?n:On(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var a,s=i.join(",");if((it("iPhone")&&!it("iPod")&&!it("iPad")||it("iPad")||it("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=r.document.createElement("A"),e instanceof Dn||e instanceof Dn||(e="object"==typeof e&&e.na?e.ma():String(e),Nn.test(e)||(e="about:invalid#zClosurez"),e=Pn(e)),s.href=Cn(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=Cn(e).toString(),s&&(Yt&&tt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t=Ln('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+dt(t)+'">'),s.document.write((a=t)instanceof Rn&&a.constructor===Rn&&a.b===Mn?a.a:(N("expected object of type SafeHtml, got '"+a+"' of type "+d(a)),"type_error:SafeHtml")),s.document.close())):(s=r.open(Cn(e).toString(),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var Jn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zn=/^[^@]+@[^@]+$/;function tr(){var t=null;return new bt(function(e){"complete"==s.document.readyState?e():(t=function(){e()},Ie(window,"load",t))}).s(function(e){throw ke(window,"load",t),e})}function er(t){return t=t||hr(),!("file:"!==yr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function nr(){var t=s.window;try{return!(!t||t==t.top)}catch(t){return!1}}function rr(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function ir(){return t.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":t.INTERNAL.hasOwnProperty("node")?"Node":rr()?"Worker":"Browser"}function or(){var t=ir();return"ReactNative"===t||"Node"===t}var ar="Firefox",sr="Chrome";function ur(t){var e=t.toLowerCase();return tt(e,"opera/")||tt(e,"opr/")||tt(e,"opios/")?"Opera":tt(e,"iemobile")?"IEMobile":tt(e,"msie")||tt(e,"trident/")?"IE":tt(e,"edge/")?"Edge":tt(e,"firefox/")?ar:tt(e,"silk/")?"Silk":tt(e,"blackberry")?"Blackberry":tt(e,"webos")?"Webos":!tt(e,"safari/")||tt(e,"chrome/")||tt(e,"crios/")||tt(e,"android")?!tt(e,"chrome/")&&!tt(e,"crios/")||tt(e,"edge/")?tt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":sr:"Safari"}var cr={Sc:"FirebaseCore-web",Uc:"FirebaseUI-web"};function lr(t,e){e=e||[];var n,r=[],i={};for(n in cr)i[cr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=ir())?r=ur(i=hr()):"Worker"===r&&(r=ur(i=hr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function hr(){return s.navigator&&s.navigator.userAgent||""}function fr(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function dr(){try{var t=s.localStorage,e=Er();if(t)return t.setItem(e,"1"),t.removeItem(e),!Wn()||!!s.indexedDB}catch(t){return rr()&&!!s.indexedDB}return!1}function pr(){return(mr()||"chrome-extension:"===yr()||er())&&!or()&&dr()&&!rr()}function mr(){return"http:"===yr()||"https:"===yr()}function yr(){return s.location&&s.location.protocol||null}function gr(t){return!Yn(t=t||hr())&&ur(t)!=ar}function vr(t){return void 0===t?null:Un(t)}function br(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function wr(t){if(null!==t)return JSON.parse(t)}function Er(t){return t||Math.floor(1e9*Math.random()).toString()}function Sr(t){return"Safari"!=ur(t=t||hr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Tr(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Ir(t,e){if(e<t)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=hr(),e=ir(),this.b=Yn(t)||"ReactNative"===e}function kr(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function _r(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Ar(){return!(!fr("fireauth.oauthhelper",s)&&!fr("fireauth.iframe",s))}Ir.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!mr()&&"chrome-extension:"!==yr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Dr,Cr={};function Nr(t){Cr[t]||(Cr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Or={};Object.defineProperty(Or,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Or,"abcd",{configurable:!0,enumerable:!0,value:2}),Dr=2==Or.abcd}catch(n){Dr=!1}function xr(t,e,n){Dr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Pr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&xr(t,n,e[n])}function Rr(t){var e={};return Pr(e,t),e}function Mr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)xr(e,n,Mr(t[n]));return e}function Lr(t){var e={},n=t[Fr],r=t[qr];if(!(t=t[Br])||t!=jr&&!n)throw Error("Invalid provider user info!");e[Vr]=r||null,e[Ur]=n||null,xr(this,zr,t),xr(this,Kr,Mr(e))}var jr="EMAIL_SIGNIN",Fr="email",qr="newEmail",Br="requestType",Ur="email",Vr="fromEmail",Kr="data",zr="operation";function Gr(t,e){this.code=Qr+t,this.message=e||Hr[t]||""}function Wr(t){var e=t&&t.code;return e?new Gr(e.substring(Qr.length),t.message):null}_(Gr,Error),Gr.prototype.w=function(){return{code:this.code,message:this.message}},Gr.prototype.toJSON=function(){return this.w()};var Qr="auth/",Hr={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Yr(t){var e=t[ti];if(void 0===e)throw new Gr("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Gr("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Xr];if(n&&"object"==typeof n){e=n[ri];var r=n[ei];if(n=n[ni],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new Gr("argument-error",ei+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Gr("argument-error",ni+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Gr("argument-error",ri+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Gr("missing-android-pkg-name")}}else if(void 0!==n)throw new Gr("argument-error",Xr+" property must be a non null object when specified.");if(this.f=null,(e=t[Zr])&&"object"==typeof e){if("string"==typeof(e=e[ii])&&e.length)this.f=e;else if(void 0!==e)throw new Gr("argument-error",ii+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Gr("argument-error",Zr+" property must be a non null object when specified.");if(void 0!==(e=t[Jr])&&"boolean"!=typeof e)throw new Gr("argument-error",Jr+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[$r])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Gr("argument-error",$r+" property must be a non empty string when specified.");this.i=t||null}var Xr="android",$r="dynamicLinkDomain",Jr="handleCodeInApp",Zr="iOS",ti="url",ei="installApp",ni="minimumVersion",ri="packageName",ii="bundleId";function oi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var ai=null,si=null;function ui(t){this.c=t.sub,this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function ci(t){return(t=li(t))&&t.sub&&t.iss&&t.aud&&t.exp?new ui(t):null}function li(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=si[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!ai){ai={},si={};for(var t=0;t<65;t++)ai[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),62<=(si[ai[t]]=t)&&(si["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}(t))}catch(t){}return null}ui.prototype.f=function(){return this.b};var hi,fi={Yc:{ab:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},$c:{ab:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ad:{ab:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function di(t){for(var e in fi)if(fi[e].id===t)return{firebaseEndpoint:(t=fi[e]).ab,secureTokenEndpoint:t.ib};return null}hi=di("__EID__")?"__EID__":void 0;var pi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),mi=["client_id","response_type","scope","redirect_uri","state"],yi={Tc:{Oa:"locale",Ba:500,Aa:600,Pa:"facebook.com",hb:mi},Vc:{Oa:null,Ba:500,Aa:620,Pa:"github.com",hb:mi},Wc:{Oa:"hl",Ba:515,Aa:680,Pa:"google.com",hb:mi},bd:{Oa:"lang",Ba:485,Aa:705,Pa:"twitter.com",hb:pi}};function gi(t){for(var e in yi)if(yi[e].Pa==t)return yi[e];return null}function vi(t){var e={};e["facebook.com"]=Ti,e["google.com"]=ki,e["github.com"]=Ii,e["twitter.com"]=_i;var n=t&&t[wi];try{if(n)return e[n]?new e[n](t):new Si(t);if(void 0!==t[bi])return new Ei(t)}catch(t){}return null}var bi="idToken",wi="providerId";function Ei(t){var e=t[wi];if(!e&&t[bi]){var n=ci(t[bi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),xr(this,"providerId",e),xr(this,"isNewUser",n)}function Si(t){Ei.call(this,t),xr(this,"profile",Mr((t=wr(t.rawUserInfo||"{}"))||{}))}function Ti(t){if(Si.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ii(t){if(Si.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");xr(this,"username",this.profile&&this.profile.login||null)}function ki(t){if(Si.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function _i(t){if(Si.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");xr(this,"username",t.screenName||null)}function Ai(t){this.a=Je(t)}function Di(t){var e=Je(t),n=$e(e,"link"),r=$e(Je(n),"link");return $e(Je(e=$e(e,"deep_link_id")),"link")||e||r||n||t}function Ci(){}function Ni(t,e){return t.then(function(t){if(t[va]){var n=ci(t[va]);if(!n||e!=n.c)throw new Gr("user-mismatch");return t}throw new Gr("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==Qr+"user-not-found"?new Gr("user-mismatch"):t})}function Oi(t,e){if(!e)throw new Gr("internal-error","failed to construct a credential");this.a=e,xr(this,"providerId",t),xr(this,"signInMethod",t)}function xi(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Pi(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Oi(t.providerId,t.pendingToken)}catch(t){}return null}function Ri(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&xr(this,"idToken",e.idToken),e.accessToken&&xr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&xr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Gr("internal-error","failed to construct a credential");xr(this,"accessToken",e.oauthToken),xr(this,"secret",e.oauthTokenSecret)}xr(this,"providerId",t),xr(this,"signInMethod",n)}function Mi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:hn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Li(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new Ri(t.providerId,e,t.signInMethod)}catch(t){}}return null}function ji(t,e){this.Dc=e||[],Pr(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.cb=(gi(t)||{}).Oa||null,this.$a=null}function Fi(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Gr("argument-error",'SAML provider IDs must be prefixed with "saml."');ji.call(this,t,[])}function qi(t){ji.call(this,t,mi),this.a=[]}function Bi(){qi.call(this,"facebook.com")}function Ui(t){if(!t)throw new Gr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new Bi).credential({accessToken:e})}function Vi(){qi.call(this,"github.com")}function Ki(t){if(!t)throw new Gr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new Vi).credential({accessToken:e})}function zi(){qi.call(this,"google.com"),this.ua("profile")}function Gi(t,e){var n=t;return v(t)&&(n=t.idToken,e=t.accessToken),(new zi).credential({idToken:n,accessToken:e})}function Wi(){ji.call(this,"twitter.com",pi)}function Qi(t,e){var n=t;if(v(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Gr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Ri("twitter.com",n,"twitter.com")}function Hi(t,e,n){this.a=t,this.c=e,xr(this,"providerId","password"),xr(this,"signInMethod",n===Xi.EMAIL_LINK_SIGN_IN_METHOD?Xi.EMAIL_LINK_SIGN_IN_METHOD:Xi.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Yi(t){return t&&t.email&&t.password?new Hi(t.email,t.password,t.signInMethod):null}function Xi(){Pr(this,{providerId:"password",isOAuthProvider:!1})}function $i(t,e){if(!(e=Ji(e)))throw new Gr("argument-error","Invalid email link!");return new Hi(t,e,Xi.EMAIL_LINK_SIGN_IN_METHOD)}function Ji(t){var e=$e((t=new Ai(t=Di(t))).a,"oobCode")||null;return"signIn"===($e(t.a,"mode")||null)&&e?e:null}function Zi(t){if(!(t.Ta&&t.Sa||t.Fa&&t.$))throw new Gr("internal-error");this.a=t,xr(this,"providerId","phone"),xr(this,"signInMethod","phone")}function to(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return j(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new Zi(e)}return null}function eo(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ta,code:t.a.Sa}}function no(e){try{this.a=e||t.auth()}catch(e){throw new Gr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Pr(this,{providerId:"phone",isOAuthProvider:!1})}function ro(t,e){if(!t)throw new Gr("missing-verification-id");if(!e)throw new Gr("missing-verification-code");return new Zi({Ta:t,Sa:e})}function io(t){if(t.temporaryProof&&t.phoneNumber)return new Zi({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Gi(o,n);case"facebook.com":return Ui(n);case"github.com":return Ki(n);case"twitter.com":return Qi(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new Oi(e,a):new Ri(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new qi(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function oo(t){if(!t.isOAuthProvider)throw new Gr("invalid-oauth-provider")}function ao(t,e,n,r,i,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.h=o||null,this.a=i||null,!this.g&&!this.a)throw new Gr("invalid-auth-event");if(this.g&&this.a)throw new Gr("invalid-auth-event");if(this.g&&!this.f)throw new Gr("invalid-auth-event")}function so(t){return(t=t||{}).type?new ao(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Wr(t.error),t.postBody):null}function uo(){this.b=null,this.a=[]}_(Si,Ei),_(Ti,Si),_(Ii,Si),_(ki,Si),_(_i,Si),Oi.prototype.la=function(t){return La(t,xi(this))},Oi.prototype.b=function(t,e){var n=xi(this);return n.idToken=e,ja(t,n)},Oi.prototype.f=function(t,e){return Ni(Fa(t,xi(this)),e)},Oi.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Ri.prototype.la=function(t){return La(t,Mi(this))},Ri.prototype.b=function(t,e){var n=Mi(this);return n.idToken=e,ja(t,n)},Ri.prototype.f=function(t,e){return Ni(Fa(t,Mi(this)),e)},Ri.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},ji.prototype.Da=function(t){return this.zb=st(t),this},_(Fi,ji),_(qi,ji),qi.prototype.ua=function(t){return B(this.a,t)||this.a.push(t),this},qi.prototype.Fb=function(){return z(this.a)},qi.prototype.credential=function(t,e){var n;if(!(n=v(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Gr("argument-error","credential failed: must provide the ID token and/or the access token.");return new Ri(this.providerId,n,this.providerId)},_(Bi,qi),xr(Bi,"PROVIDER_ID","facebook.com"),xr(Bi,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),_(Vi,qi),xr(Vi,"PROVIDER_ID","github.com"),xr(Vi,"GITHUB_SIGN_IN_METHOD","github.com"),_(zi,qi),xr(zi,"PROVIDER_ID","google.com"),xr(zi,"GOOGLE_SIGN_IN_METHOD","google.com"),_(Wi,ji),xr(Wi,"PROVIDER_ID","twitter.com"),xr(Wi,"TWITTER_SIGN_IN_METHOD","twitter.com"),Hi.prototype.la=function(t){return this.signInMethod==Xi.EMAIL_LINK_SIGN_IN_METHOD?ds(t,Wa,{email:this.a,oobCode:this.c}):ds(t,cs,{email:this.a,password:this.c})},Hi.prototype.b=function(t,e){return this.signInMethod==Xi.EMAIL_LINK_SIGN_IN_METHOD?ds(t,Qa,{idToken:e,email:this.a,oobCode:this.c}):ds(t,rs,{idToken:e,email:this.a,password:this.c})},Hi.prototype.f=function(t,e){return Ni(this.la(t),e)},Hi.prototype.w=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Pr(Xi,{PROVIDER_ID:"password"}),Pr(Xi,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Pr(Xi,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Zi.prototype.la=function(t){return t.Ua(eo(this))},Zi.prototype.b=function(t,e){var n=eo(this);return n.idToken=e,ds(t,hs,n)},Zi.prototype.f=function(t,e){var n=eo(this);return n.operation="REAUTH",Ni(t=ds(t,fs,n),e)},Zi.prototype.w=function(){var t={providerId:"phone"};return this.a.Ta&&(t.verificationId=this.a.Ta),this.a.Sa&&(t.verificationCode=this.a.Sa),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},no.prototype.Ua=function(t,e){var n=this.a.c;return _t(e.verify()).then(function(r){if(!u(r))throw new Gr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return(i=n,o={phoneNumber:t,recaptchaToken:r},ds(i,es,o)).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new Gr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}var i,o})},Pr(no,{PROVIDER_ID:"phone"}),Pr(no,{PHONE_SIGN_IN_METHOD:"phone"}),ao.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.i&&t.push(this.i),t.join("-")},ao.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,error:this.a&&this.a.w()}};var co,lo=null;function ho(t){var e="unauthorized-domain",n=void 0,r=Je(t);t=r.b,"chrome-extension"==(r=r.f)?n=ft("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=ft("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Gr.call(this,e,n)}function fo(t,e,n){Gr.call(this,t,n),(t=e||{}).Ab&&xr(this,"email",t.Ab),t.$&&xr(this,"phoneNumber",t.$),t.credential&&xr(this,"credential",t.credential)}function po(t){if(t.code){var e=t.code||"";0==e.indexOf(Qr)&&(e=e.substring(Qr.length));var n={credential:io(t)};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Gr(e,t.message||void 0);return new fo(e,n,t.message)}return null}function mo(){}function yo(t){return t.c||(t.c=t.b())}function go(){}function vo(t){if(t.f||"undefined"!=typeof XMLHttpRequest||"undefined"==typeof ActiveXObject)return t.f;for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function bo(){}function wo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=T(this.dc,this),this.a.onerror=T(this.Gb,this),this.a.onprogress=T(this.ec,this),this.a.ontimeout=T(this.ic,this)}function Eo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function So(t,e,n){this.reset(t,e,n,void 0,void 0)}function To(t){this.f=t,this.b=this.c=this.a=null}function Io(t,e){this.name=t,this.value=e}uo.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=fr("universalLinks.subscribe",s))&&t(null,this.b))},uo.prototype.unsubscribe=function(t){V(this.a,function(e){return e==t})},_(ho,Gr),_(fo,Gr),fo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.w();return e&&ht(t,e),t},fo.prototype.toJSON=function(){return this.w()},mo.prototype.c=null,_(go,mo),go.prototype.a=function(){var t=vo(this);return t?new ActiveXObject(t):new XMLHttpRequest},go.prototype.b=function(){var t={};return vo(this)&&(t[0]=!0,t[1]=!0),t},co=new go,_(bo,mo),bo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new wo;throw Error("Unsupported browser")},bo.prototype.b=function(){return{}},(n=wo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},n.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},n.abort=function(){this.a.abort()},n.setRequestHeader=function(){},n.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},n.dc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Eo(this,4)},n.Gb=function(){this.status=500,this.response=this.responseText="",Eo(this,4)},n.ic=function(){this.Gb()},n.ec=function(){this.status=200,Eo(this,1)},n.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},So.prototype.a=null,So.prototype.reset=function(t,e,n,r,i){delete this.a},Io.prototype.toString=function(){return this.name};var ko=new Io("SEVERE",1e3),_o=new Io("WARNING",900),Ao=new Io("CONFIG",700),Do=new Io("FINE",500);To.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(N("Root logger has no level set."),null)}(this).value)for(g(e)&&(e=e()),t=new So(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Co,No={},Oo=null;function xo(t){var e;if(Oo||(Oo=new To(""),(No[""]=Oo).c=Ao),!(e=No[t])){e=new To(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=xo(t.substr(0,n))).b||(n.b={}),(n.b[r]=e).a=n,No[t]=e}return e}function Po(t,e){t&&t.log(Do,e,void 0)}function Ro(t){this.f=t}function Mo(t){Re.call(this),this.u=t,this.readyState=Lo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.o="GET",this.g="",this.a=!1,this.h=xo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}_(Ro,mo),Ro.prototype.a=function(){return new Mo(this.f)},Ro.prototype.b=(Co={},function(){return Co}),_(Mo,Re);var Lo=0;function jo(t){t.c.read().then(t.cc.bind(t)).catch(t.Ma.bind(t))}function Fo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,qo(t)}function qo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Bo(t){Re.call(this),this.headers=new Ve,this.D=t||null,this.c=!1,this.A=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Uo,this.v=this.O=!1}(n=Mo.prototype).open=function(t,e){if(this.readyState!=Lo)throw this.abort(),Error("Error reopening a connection");this.o=t,this.g=e,this.readyState=1,qo(this)},n.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.o,credentials:void 0,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.g,e)).then(this.hc.bind(this),this.Ma.bind(this))},n.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Fo(this,!1)),this.readyState=Lo},n.hc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,qo(this)),this.a&&(this.readyState=3,qo(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.fc.bind(this),this.Ma.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,jo(this)):t.text().then(this.gc.bind(this),this.Ma.bind(this)))))},n.cc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Fo(this,!0):qo(this),3==this.readyState&&jo(this)}},n.gc=function(t){this.a&&(this.response=this.responseText=t,Fo(this,!0))},n.fc=function(t){this.a&&(this.response=t,Fo(this,!0))},n.Ma=function(t){var e=this.h;e&&e.log(_o,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&Fo(this,!0)},n.setRequestHeader=function(t,e){this.i.append(t,e)},n.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(_o,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},n.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(_o,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},_(Bo,Re);var Uo="";Bo.prototype.b=xo("goog.net.XhrIo");var Vo=/^https?$/i,Ko=["POST","PUT"];function zo(t){return"content-type"==t.toLowerCase()}function Go(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Wo(t),Ho(t)}function Wo(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Qo(t){if(t.c&&void 0!==a)if(t.A[1]&&4==Xo(t)&&2==$o(t))Po(t.b,Jo(t,"Local request error detected and ignored"));else if(t.i&&4==Xo(t))Fe(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==Xo(t)){Po(t.b,Jo(t,"Request complete")),t.c=!1;try{var e,n=$o(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Ge)[1]||null;if(!o&&s.self&&s.self.location){var u=s.self.location.protocol;o=u.substr(0,u.length-1)}i=!Vo.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Xo(t)?t.a.statusText:""}catch(e){Po(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+$o(t)+"]",Wo(t)}}finally{Ho(t)}}}function Ho(t,e){if(t.a){Yo(t);var n=t.a,r=t.A[0]?f:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(ko,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Yo(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(s.clearTimeout(t.u),t.u=null)}function Xo(t){return t.a?t.a.readyState:0}function $o(t){try{return 2<Xo(t)?t.a.status:-1}catch(t){return-1}}function Jo(t,e){return e+" ["+t.N+" "+t.l+" "+$o(t)+"]"}function Zo(t){var e=la;this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.l=this.A=this.i=!1,this.h=0,this.b=null,this.m=0}function ta(t,e,n){t.a=!0,t.c=n,t.f=!e,ia(t)}function ea(t){if(t.a){if(!t.l)throw new oa(t);t.l=!1}}function na(t,e,n,r){t.g.push([e,n,r]),t.a&&ia(t)}function ra(t){return q(t.g,function(t){return g(t[1])})}function ia(t){if(t.h&&t.a&&ra(t)){var e=t.h,n=ua[e];n&&(s.clearTimeout(n.a),delete ua[e]),t.h=0}t.b&&(t.b.m--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var u=o.call(i||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(A(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,ra(t)||(n=!0)}}t.c=e,r&&(u=T(t.o,t,!0),r=T(t.o,t,!1),e instanceof Zo?(na(e,u,r),e.A=!0):e.then(u,r)),n&&(e=new sa(e),ua[e.a]=e,t.h=e.a)}function oa(){D.call(this)}function aa(){D.call(this)}function sa(t){this.a=s.setTimeout(T(this.c,this),0),this.b=t}(n=Bo.prototype).Ga=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Po(this.b,Jo(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},n.abort=function(){this.a&&this.c&&(Po(this.b,Jo(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ho(this))},n.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ho(this,!0)),Bo.qb.va.call(this)},n.Jb=function(){this.qa||(this.I||this.i||this.f?Qo(this):this.wc())},n.wc=function(){Qo(this)},n.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Uo:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ko,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(t){return Po(this.b,"Can not get response: "+t.message),null}},Zo.prototype.cancel=function(t){if(this.a)this.c instanceof Zo&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.m--,e.m<=0&&e.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(t=new aa(this),ea(this),ta(this,!1,t))}},Zo.prototype.o=function(t,e){this.i=!1,ta(this,t,e)},Zo.prototype.then=function(t,e,n){var r,i,o=new bt(function(t,e){r=t,i=e});return na(this,r,function(t){t instanceof aa?o.cancel():i(t)}),o.then(t,e,n)},Zo.prototype.$goog_Thenable=!0,_(oa,D),oa.prototype.message="Deferred has already fired",oa.prototype.name="AlreadyCalledError",_(aa,D),aa.prototype.message="Deferred was canceled",aa.prototype.name="CanceledError",sa.prototype.c=function(){throw delete ua[this.a],this.b};var ua={};function ca(t){var e,n,r,i,o,a=document,u=Tn(t).toString(),c=document.createElement("SCRIPT"),f={Lb:c,Ga:void 0},d=new Zo(f);return e=window.setTimeout(function(){ha(c,!0);var t=new pa(da,"Timeout reached for loading script "+u);ea(d),ta(d,!1,t)},5e3),f.Ga=e,c.onload=c.onreadystatechange=function(){c.readyState&&"loaded"!=c.readyState&&"complete"!=c.readyState||(ha(c,!1,e),ea(d),ta(d,!0,null))},c.onerror=function(){ha(c,!0,e);var t=new pa(fa,"Error while loading script "+u);ea(d),ta(d,!1,t)},ht(f={},{type:"text/javascript",charset:"UTF-8"}),Fn(c,f),r=t,(n=c).src=Tn(r),null===h&&(h=(r=(r=s.document).querySelector&&r.querySelector("script[nonce]"))&&(r=r.nonce||r.getAttribute("nonce"))&&l.test(r)?r:""),(r=h)&&n.setAttribute("nonce",r),(i=a,(o=(i||document).getElementsByTagName("HEAD"))&&0!=o.length?o[0]:i.documentElement).appendChild(c),d}function la(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&ha(t,!0,this.Ga)}}function ha(t,e,n){null!=n&&s.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var fa=0,da=1;function pa(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),D.call(this,n),this.code=t}function ma(t){this.f=t}function ya(e,n,r){if(this.b=e,e=n||{},this.i=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||ba,this.f=st(e.secureTokenHeaders||wa),this.g=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=e.firebaseTimeout||Ea,this.a=st(e.firebaseHeaders||Sa),r&&(this.a["X-Client-Version"]=r,this.f["X-Client-Version"]=r),r="Node"==ir(),!(r=s.XMLHttpRequest||r&&t.INTERNAL.node&&t.INTERNAL.node.XMLHttpRequest)&&!rr())throw new Gr("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,rr()?this.c=new Ro(self):or()?this.c=new ma(r):this.c=new bo}_(pa,D),_(ma,mo),ma.prototype.a=function(){return new this.f},ma.prototype.b=function(){return{}};var ga,va="idToken",ba=new Ir(3e4,6e4),wa={"Content-Type":"application/x-www-form-urlencoded"},Ea=new Ir(3e4,6e4),Sa={"Content-Type":"application/json"};function Ta(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ia(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function ka(t,e,n,r,i,o,a){var u;(t=!((u=ur(u=hr())!=sr?null:(u=u.match(/\sChrome\/(\d+)/i))&&2==u.length?parseInt(u[1],10):null)&&u<30||Qt&&ne&&!(9<ne))||rr()?T(t.o,t):(ga||(ga=new bt(function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(s[Aa]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},na(ca(In(_a,{onload:Aa})),null,function(){e(Error("CORS_UNSUPPORTED"))},void 0))}(t,e)})),T(t.l,t)))(e,n,r,i,o,a)}ya.prototype.o=function(t,e,n,r,i,o){if(rr()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new Gr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Bo(this.c);if(o){a.g=Math.max(0,o);var c=setTimeout(function(){a.dispatchEvent("timeout")},o)}Me(a,"complete",function(){c&&clearTimeout(c);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Po(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),Le(a,"ready",function(){c&&clearTimeout(c),Vt(this)}),Le(a,"timeout",function(){c&&clearTimeout(c),Vt(this),e&&e(null)}),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.N=n,t.G=!1,t.c=!0,t.a=t.D?t.D.a():co.a(),t.A=t.D?yo(t.D):yo(co),t.a.onreadystatechange=T(t.Jb,t);try{Po(t.b,Jo(t,"Opening Xhr")),t.I=!0,t.a.open(n,String(e),!0),t.I=!1}catch(e){return Po(t.b,Jo(t,"Error opening Xhr: "+e.message)),void Go(t,e)}e=r||"";var o,a=new Ve(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(y(t)||u(t))j(t,e,void 0);else for(var n=Ue(t),r=Be(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){a.set(e,t)}),i=function(t){t:{for(var e=zo,n=t.length,r=u(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:u(t)?t.charAt(e):t[e]}(a.U()),r=s.FormData&&e instanceof s.FormData,!B(Ko,n)||i||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{Yo(t),0<t.g&&(t.v=(o=t.a,Qt&&ie(9)&&"number"==typeof o.timeout&&void 0!==o.ontimeout),Po(t.b,Jo(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=T(t.Ga,t)):t.u=Fe(t.Ga,t.g,t)),Po(t.b,Jo(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){Po(t.b,Jo(t,"Send error: "+e.message)),Go(t,e)}}(a,t,n,r,i)};var _a=new vn(En,"https://apis.google.com/js/client.js?onload=%{onload}"),Aa="__fcb"+Math.floor(1e6*Math.random()).toString();function Da(t){if(!u(t=t.email)||!Zn.test(t))throw new Gr("invalid-email")}function Ca(t){"email"in t&&Da(t)}function Na(t){if(!t[va])throw new Gr("internal-error")}function Oa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Gr("internal-error")}else{if(!t.sessionInfo)throw new Gr("missing-verification-id");if(!t.code)throw new Gr("missing-verification-code")}}ya.prototype.l=function(t,e,n,r,i){var o=this;ga.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},ya.prototype.ob=function(){return ds(this,is,{})},ya.prototype.rb=function(t,e){return ds(this,ns,{idToken:t,email:e})},ya.prototype.sb=function(t,e){return ds(this,rs,{idToken:t,password:e})};var xa={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Pa(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Gr("internal-error")}function Ra(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&dn(t=new cn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function Ma(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=po(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=po(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=po(t)):t.errorMessage&&(e=ps(t.errorMessage)),e)throw e;if(!t[va])throw new Gr("internal-error")}function La(t,e){return e.returnIdpCredential=!0,ds(t,os,e)}function ja(t,e){return e.returnIdpCredential=!0,ds(t,ss,e)}function Fa(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ds(t,as,e)}function qa(t){if(!t.oobCode)throw new Gr("invalid-action-code")}(n=ya.prototype).tb=function(t,e){var n={idToken:t},r=[];return ot(xa,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),ds(this,ns,n)},n.kb=function(t,e){return ht(t={requestType:"PASSWORD_RESET",email:t},e),ds(this,$a,t)},n.lb=function(t,e){return ht(t={requestType:"EMAIL_SIGNIN",email:t},e),ds(this,Ya,t)},n.jb=function(t,e){return ht(t={requestType:"VERIFY_EMAIL",idToken:t},e),ds(this,Xa,t)},n.Ua=function(t){return ds(this,ls,t)},n.Za=function(t,e){return ds(this,ts,{oobCode:t,newPassword:e})},n.Ka=function(t){return ds(this,Ua,{oobCode:t})},n.Wa=function(t){return ds(this,Ba,{oobCode:t})};var Ba={endpoint:"setAccountInfo",C:qa,da:"email"},Ua={endpoint:"resetPassword",C:qa,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Gr("internal-error")}},Va={endpoint:"signupNewUser",C:function(t){if(Da(t),!t.password)throw new Gr("weak-password")},J:Na,R:!0},Ka={endpoint:"createAuthUri"},za={endpoint:"deleteAccount",T:["idToken"]},Ga={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],C:function(t){if(!m(t.deleteProvider))throw new Gr("internal-error")}},Wa={endpoint:"emailLinkSignin",T:["email","oobCode"],C:Da,J:Na,R:!0},Qa={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],C:Da,J:Na,R:!0},Ha={endpoint:"getAccountInfo"},Ya={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Gr("internal-error");Da(t)},da:"email"},Xa={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],C:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Gr("internal-error")},da:"email"},$a={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Gr("internal-error");Da(t)},da:"email"},Ja={wb:!0,endpoint:"getProjectConfig",Ib:"GET"},Za={wb:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new Gr("internal-error")}},ts={endpoint:"resetPassword",C:qa,da:"email"},es={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},ns={endpoint:"setAccountInfo",T:["idToken"],C:Ca,R:!0},rs={endpoint:"setAccountInfo",T:["idToken"],C:function(t){if(Ca(t),!t.password)throw new Gr("weak-password")},J:Na,R:!0},is={endpoint:"signupNewUser",J:Na,R:!0},os={endpoint:"verifyAssertion",C:Pa,Qa:Ra,J:Ma,R:!0},as={endpoint:"verifyAssertion",C:Pa,Qa:Ra,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Gr("user-not-found");if(t.errorMessage)throw ps(t.errorMessage);if(!t[va])throw new Gr("internal-error")},R:!0},ss={endpoint:"verifyAssertion",C:function(t){if(Pa(t),!t.idToken)throw new Gr("internal-error")},Qa:Ra,J:Ma,R:!0},us={endpoint:"verifyCustomToken",C:function(t){if(!t.token)throw new Gr("invalid-custom-token")},J:Na,R:!0},cs={endpoint:"verifyPassword",C:function(t){if(Da(t),!t.password)throw new Gr("wrong-password")},J:Na,R:!0},ls={endpoint:"verifyPhoneNumber",C:Oa,J:Na},hs={endpoint:"verifyPhoneNumber",C:function(t){if(!t.idToken)throw new Gr("internal-error");Oa(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",po(t);Na(t)}},fs={Wb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",C:Oa,J:Na};function ds(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.T))return At(new Gr("internal-error"));var r,i=e.Ib||"POST";return _t(n).then(e.C).then(function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var a=Je(t.g+e);Xe(a,"key",t.b),o&&Xe(a,"cb",k().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&Xe(a,u,r[u]);return new bt(function(e,o){ka(t,a.toString(),function(t){t?t.error?o(ms(t,i||{})):e(t):o(new Gr("network-request-failed"))},n,s?void 0:Un(br(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Wb,e.wb||!1)}).then(function(t){return r=t,e.Qa?e.Qa(n,r):r}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new Gr("internal-error");return r[e.da]})}function ps(t){return ms({error:{errors:[{message:t}],code:400,message:t}})}function ms(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Gr(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",ht(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Gr(r[i],e);return!e&&t&&(e=vr(t)),new Gr("internal-error",e)}function ys(t){var e;this.b=t,this.a=null,this.fb=(e=this,(ws||(ws=new bt(function(t,e){function n(){Tr(),fr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Tr(),e(Error("Network Error"))},timeout:vs.get()})}if(fr("gapi.iframes.Iframe"))t();else if(fr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){fr("gapi.load")?n():e(Error("Network Error"))},_t(ca(r=In(gs,{onload:r}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw ws=null,t}))).then(function(){return new bt(function(t,n){fr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:fr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},bs.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})}))}var gs=new vn(En,"https://apis.google.com/js/api.js?onload=%{onload}"),vs=new Ir(3e4,6e4),bs=new Ir(5e3,15e3),ws=null;function Es(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Ze(this.i,"/__/auth/iframe"),Xe(this.a,"apiKey",this.g),Xe(this.a,"appName",this.h),this.b=null,this.c=[]}function Ss(t,e,n,r,i){this.o=t,this.l=e,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ts(e){try{return t.app(e).auth().ya()}catch(e){return[]}}function Is(t,e,n,r,i){this.l=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function ks(t){var e,n=Qn();return(e=t,ds(e,Ja,{}).then(function(t){return t.authorizedDomains||[]})).then(function(t){t:{var e=Je(n),r=e.f;e=e.b;for(var i=0;i<t.length;i++){var o=t[i],a=e,s=r;if(a=0==o.indexOf("chrome-extension://")?Je(o).b==a&&"chrome-extension"==s:("http"==s||"https"==s)&&(Jn.test(o)?a==o:(o=o.split(".").join("\\."),new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)))){t=!0;break t}}t=!1}if(!t)throw new ho(Qn())})}function _s(t){return t.m||(t.m=tr().then(function(){if(!t.u){var e=t.c,n=t.h,r=Ts(t.b),i=new Es(t.l,t.f,t.b);i.f=e,i.b=n,i.c=z(r||[]),t.u=i.toString()}t.i=new ys(t.u),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");var e,n;e=t.i,n=function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=so(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",_t(n)}return n.status="ERROR",_t(n)},e.fb.then(function(){e.a.register("authEvent",n,fr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t)})),t.m}function As(t){return t.o||(t.v=t.c?lr(t.c,Ts(t.b)):null,t.o=new ya(t.f,di(t.h),t.v)),t.o}function Ds(t,e,n,r,i,o,a,s,u,c){return(t=new Ss(t,e,n,r,i)).i=o,t.g=a,t.h=s,t.b=st(u||null),t.f=c,t.toString()}function Cs(e){if(this.a=e||t.INTERNAL.reactNative&&t.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Gr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Ns(t){this.b=t,this.a={},this.c=T(this.f,this)}Es.prototype.toString=function(){return this.f?Xe(this.a,"v",this.f):fn(this.a.a,"v"),this.b?Xe(this.a,"eid",this.b):fn(this.a.a,"eid"),this.c.length?Xe(this.a,"fw",this.c.join(",")):fn(this.a.a,"fw"),this.a.toString()},Ss.prototype.toString=function(){var e=Ze(this.o,"/__/auth/handler");if(Xe(e,"apiKey",this.l),Xe(e,"appName",this.c),Xe(e,"authType",this.m),this.a.isOAuthProvider){var n=this.a;try{var r=t.app(this.c).auth().ea()}catch(e){r=null}for(var i in n.$a=r,Xe(e,"providerId",this.a.providerId),r=br((n=this.a).zb))r[i]=r[i].toString();i=n.Dc,r=st(r);for(var o=0;o<i.length;o++){var a=i[o];a in r&&delete r[a]}n.cb&&n.$a&&!r[n.cb]&&(r[n.cb]=n.$a),at(r)||Xe(e,"customParameters",vr(r))}if("function"==typeof this.a.Fb&&(n=this.a.Fb()).length&&Xe(e,"scopes",n.join(",")),this.i?Xe(e,"redirectUrl",this.i):fn(e.a,"redirectUrl"),this.g?Xe(e,"eventId",this.g):fn(e.a,"eventId"),this.h?Xe(e,"v",this.h):fn(e.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!$e(e,s)&&Xe(e,s,this.b[s]);return this.f?Xe(e,"eid",this.f):fn(e.a,"eid"),(s=Ts(this.c)).length&&Xe(e,"fw",s.join(",")),e.toString()},(n=Is.prototype).Ea=function(t,e,n){var r=new Gr("popup-closed-by-user"),i=new Gr("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){var n,r;(n=o,r={type:"webStorageSupport"},_s(n).then(function(){return t=n.i,e=r,t.fb.then(function(){return new bt(function(n){t.a.send(e.type,e,n,fr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var t,e}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})).then(function(n){n||(t&&Xn(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return e=t,new bt(function(t){return function n(){qe(2e3).then(function(){if(e&&!e.closed)return n();t()})}()});var e}).then(function(){if(!a)return qe(n).then(function(){e(r)})})},n.Mb=function(){var t=hr();return!gr(t)&&!Sr(t)},n.Hb=function(){return!1},n.Db=function(t,e,n,r,i,o,a){if(!t)return At(new Gr("popup-blocked"));if(a&&!gr())return this.ga().s(function(e){Xn(t),i(e)}),r(),_t();this.a||(this.a=ks(As(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw Xn(t),i(e),e});return r(),e}).then(function(){oo(n),a||Hn(Ds(s.l,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},n.Ca=function(t,e,n){this.a||(this.a=ks(As(this)));var r=this;return this.a.then(function(){oo(e),Hn(Ds(r.l,r.f,r.b,t,e,Qn(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},n.ga=function(){var t=this;return _s(this).then(function(){return t.i.fb}).s(function(){throw t.a=null,new Gr("network-request-failed")})},n.Pb=function(){return!0},n.wa=function(t){this.g.push(t)},n.La=function(t){V(this.g,function(e){return e==t})},(n=Cs.prototype).get=function(t){return _t(this.a.getItem(t)).then(function(t){return t&&wr(t)})},n.set=function(t,e){return _t(this.a.setItem(t,vr(e)))},n.P=function(t){return _t(this.a.removeItem(t))},n.Y=function(){},n.ca=function(){};var Os,xs=[];function Ps(t){this.a=t}function Rs(t){this.c=t,this.b=!1,this.a=[]}function Ms(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return At(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new bt(function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))}).then(function(e){return Ls(t,c),e}).s(function(e){throw Ls(t,c),e})}function Ls(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),V(t.a,function(t){return t==e})}}function js(){if(!qs())throw new Gr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.l=s.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.i=null,this.u=!1,this.h=null;var t,e=this;rr()&&self?(this.m=function(){var t=rr()?self:null;if(j(xs,function(n){n.b==t&&(e=n)}),!e){var e=new Ns(t);xs.push(e)}return e}(),this.m.subscribe("keyChanged",function(t,n){return zs(e).then(function(t){return 0<t.length&&j(e.a,function(e){e(t)}),{keyProcessed:B(t,n.key)}})}),this.m.subscribe("ping",function(){return _t(["keyChanged"])})):(t=s.navigator,t&&t.serviceWorker?_t().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):_t(null)).then(function(t){(e.h=t)&&(e.g=new Rs(new Ps(t)),Ms(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&B(t[0].value,"keyChanged")&&(e.u=!0)}).s(function(){}))})}function Fs(t){return t.o||(t.o=function t(e){return new bt(function(n,r){var i=e.l.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){r(t)}},i.onsuccess=function(i){var o;(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):(o=e,new bt(function(t,e){var n=o.l.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){t()},n.onerror=function(t){e(Error(t.target.error))}})).then(function(){return t(e)}).then(function(t){n(t)}).s(function(t){r(t)})}})}(t)),t.o}function qs(){try{return!!s.indexedDB}catch(t){return!1}}function Bs(t){return t.objectStore("firebaseLocalStorage")}function Us(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Vs(t){return new bt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Ks(t,e){return t.g&&t.h&&((n=s.navigator)&&n.serviceWorker&&n.serviceWorker.controller||null)===t.h?Ms(t.g,"keyChanged",{key:e},t.u).then(function(){}).s(function(){}):_t();var n}function zs(t){return Fs(t).then(function(t){var e=Bs(Us(t,!1));return e.getAll?Vs(e.getAll()):new bt(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function Gs(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Ws(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=_t().then(function(){if(qs()){var t=Er(),r="__sak"+t;return Os||(Os=new js),(n=Os).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){j(e.a,function(e){e(t)})}),t})}function Qs(){this.a={},this.type="inMemory"}function Hs(){if(!function(){var e="Node"==ir();if(!(e=Ys()||e&&t.INTERNAL.node&&t.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==ir())throw new Gr("internal-error","The LocalStorage compatibility library was not found.");throw new Gr("web-storage-unsupported")}this.a=Ys()||t.INTERNAL.node.localStorage,this.type="localStorage"}function Ys(){try{var t=s.localStorage,e=Er();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Xs(){this.type="nullStorage"}function $s(){if(!function(){var e="Node"==ir();if(!(e=Js()||e&&t.INTERNAL.node&&t.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==ir())throw new Gr("internal-error","The SessionStorage compatibility library was not found.");throw new Gr("web-storage-unsupported")}this.a=Js()||t.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Js(){try{var t=s.sessionStorage,e=Er();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Zs(){var t={};t.Browser=nu,t.Node=ru,t.ReactNative=iu,t.Worker=ou,this.a=t[ir()]}Ns.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];j(r,function(e){i.push(_t().then(function(){return e(t.origin,t.data.data)}))}),Ct(i).then(function(r){var i=[];j(r,function(t){i.push({fulfilled:t.Eb,value:t.value,reason:t.reason?t.reason.message:void 0})}),j(i,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},Ns.prototype.subscribe=function(t,e){at(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},Ns.prototype.unsubscribe=function(t,e){void 0!==this.a[t]&&e?(V(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],at(this.a)&&this.b.removeEventListener("message",this.c)},Ps.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Rs.prototype.close=function(){for(;0<this.a.length;)Ls(this,this.a[0]);this.b=!0},(n=js.prototype).set=function(t,e){var n,r=!1,i=this;return Fs(this).then(function(e){return Vs((e=Bs(Us(n=e,!0))).get(t))}).then(function(o){var a=Bs(Us(n,!0));return o?(o.value=e,Vs(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,Vs(a.add(o)))}).then(function(){return i.c[t]=e,Ks(i,t)}).ia(function(){r&&i.b--})},n.get=function(t){return Fs(this).then(function(e){return Vs(Bs(Us(e,!1)).get(t))}).then(function(t){return t&&t.value})},n.P=function(t){var e=!1,n=this;return Fs(this).then(function(r){return e=!0,n.b++,Vs(Bs(Us(r,!0)).delete(t))}).then(function(){return delete n.c[t],Ks(n,t)}).ia(function(){e&&n.b--})},n.Y=function(t){var e;0==this.a.length&&(Gs(e=this),function t(){e.f=setTimeout(function(){e.i=zs(e).then(function(t){0<t.length&&j(e.a,function(e){e(t)})}).then(function(){t()}).s(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()),this.a.push(t)},n.ca=function(t){V(this.a,function(e){return e==t}),0==this.a.length&&Gs(this)},(n=Ws.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},n.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},n.P=function(t){return this.b.then(function(e){return e.P(t)})},n.Y=function(t){this.a.push(t)},n.ca=function(t){V(this.a,function(e){return e==t})},(n=Qs.prototype).get=function(t){return _t(this.a[t])},n.set=function(t,e){return this.a[t]=e,_t()},n.P=function(t){return delete this.a[t],_t()},n.Y=function(){},n.ca=function(){},(n=Hs.prototype).get=function(t){var e=this;return _t().then(function(){return wr(e.a.getItem(t))})},n.set=function(t,e){var n=this;return _t().then(function(){var r=vr(e);null===r?n.P(t):n.a.setItem(t,r)})},n.P=function(t){var e=this;return _t().then(function(){e.a.removeItem(t)})},n.Y=function(t){s.window&&Se(s.window,"storage",t)},n.ca=function(t){s.window&&ke(s.window,"storage",t)},(n=Xs.prototype).get=function(){return _t(null)},n.set=function(){return _t()},n.P=function(){return _t()},n.Y=function(){},n.ca=function(){},(n=$s.prototype).get=function(t){var e=this;return _t().then(function(){return wr(e.a.getItem(t))})},n.set=function(t,e){var n=this;return _t().then(function(){var r=vr(e);null===r?n.P(t):n.a.setItem(t,r)})},n.P=function(t){var e=this;return _t().then(function(){e.a.removeItem(t)})},n.Y=function(){},n.ca=function(){};var tu,eu,nu={B:Hs,Ra:$s},ru={B:Hs,Ra:$s},iu={B:Cs,Ra:Xs},ou={B:Hs,Ra:Xs},au={Xc:"local",NONE:"none",Zc:"session"};function su(){var t=!(Sr(hr())||!nr()),e=gr(),n=dr();this.o=t,this.h=e,this.m=n,this.a={},tu||(tu=new Zs),t=tu;try{this.g=!Wn()&&Ar()||!s.indexedDB?new t.a.B:new Ws(rr()?new Qs:new t.a.B)}catch(t){this.g=new Qs,this.h=!0}try{this.i=new t.a.Ra}catch(t){this.i=new Qs}this.l=new Qs,this.f=T(this.Ob,this),this.b={}}function uu(){return eu||(eu=new su),eu}function cu(t,e){switch(e){case"session":return t.i;case"none":return t.l;default:return t.g}}function lu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function hu(t,e,n){return n=lu(e,n),"local"==e.B&&(t.b[n]=null),cu(t,e.B).P(n)}function fu(t){t.c&&(clearInterval(t.c),t.c=null)}function du(t){this.a=t,this.b=uu()}(n=su.prototype).get=function(t,e){return cu(this,t.B).get(lu(t,e))},n.set=function(t,e,n){var r=lu(t,n),i=this,o=cu(this,t.B);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.B&&(i.b[r]=e)})},n.addListener=function(t,e,n){var r;t=lu(t,e),this.m&&(this.b[t]=s.localStorage.getItem(t)),at(this.a)&&(cu(this,"local").Y(this.f),this.h||(Wn()||!Ar())&&s.indexedDB||!this.m||(fu(r=this),r.c=setInterval(function(){for(var t in r.a){var e=s.localStorage.getItem(t),n=r.b[t];e!=n&&(r.b[t]=e,e=new he({type:"storage",key:t,target:window,oldValue:n,newValue:e,a:!0}),r.Ob(e))}},1e3))),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},n.removeListener=function(t,e,n){t=lu(t,e),this.a[t]&&(V(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),at(this.a)&&(cu(this,"local").ca(this.f),fu(this))},n.Ob=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Xa(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?cu(this,"local").ca(this.f):fu(this),this.o)if(n=s.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?s.localStorage.setItem(e,r):s.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.Xa(e))},Qt&&ne&&10==ne&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else j(t,T(this.Xa,this))},n.Xa=function(t){this.a[t]&&j(this.a[t],function(t){t()})};var pu,mu={name:"authEvent",B:"local"};function yu(){this.a=uu()}function gu(t,e){this.b=vu,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.m=s.Int32Array?new Int32Array(64):Array(64),void 0!==pu||(pu=s.Int32Array?new Int32Array(ku):ku),this.reset()}_(gu,function(){this.b=-1});for(var vu=64,bu=vu-1,wu=[],Eu=0;Eu<bu;Eu++)wu[Eu]=0;var Su=K(128,wu);function Tu(t){for(var e=t.f,n=t.m,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;e<64;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;e<64;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|pu[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Iu(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(u(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Tu(t),i=0);else{if(!y(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Tu(t),i=0)}}t.c=i,t.g+=n}gu.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):z(this.h)};var ku=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _u(){gu.call(this,8,Au)}_(_u,gu);var Au=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Du(t,e,n,r,i){this.l=t,this.i=e,this.m=n,this.o=r||null,this.u=i||null,this.h=e+":"+n,this.v=new yu,this.g=new du(this.h),this.f=null,this.b=[],this.a=this.c=null}function Cu(t){return new Gr("invalid-cordova-configuration",t)}function Nu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Ou(t){return t.f||(t.f=t.ga().then(function(){return new bt(function(e){t.wa(function n(r){return e(r),t.La(n),!1}),function(t){function e(e){r=!0,i&&i.cancel(),xu(t).then(function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Di(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=wr($e(o=Je(i),"firebaseError")||null))?Wr(o):null)?new ao(r.c,r.b,null,null,o):new ao(r.c,r.b,i,r.f)),i=o||n}Nu(t,i)})}var n=new ao("unknown",null,null,null,new Gr("no-auth-event")),r=!1,i=qe(500).then(function(){return xu(t).then(function(){r||Nu(t,n)})}),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(fr("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},lo||(lo=new uo),lo.subscribe(e)}(t)})})),t.f}function xu(t){var e,n=null;return(e=t.g,e.b.get(mu,e.a).then(function(t){return so(t)})).then(function(e){return n=e,hu((e=t.g).b,mu,e.a)}).then(function(){return n})}function Pu(t){this.a=t,this.b=uu()}(n=Du.prototype).ga=function(){return this.za?this.za:this.za=(er(void 0)?tr().then(function(){return new bt(function(t,e){var n=s.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):At(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof fr("universalLinks.subscribe",s))throw Cu("cordova-universal-links-plugin-fix is not installed");if(void 0===fr("BuildInfo.packageName",s))throw Cu("cordova-plugin-buildinfo is not installed");if("function"!=typeof fr("cordova.plugins.browsertab.openUrl",s))throw Cu("cordova-plugin-browsertab is not installed");if("function"!=typeof fr("cordova.InAppBrowser.open",s))throw Cu("cordova-plugin-inappbrowser is not installed")},function(){throw new Gr("cordova-not-ready")})},n.Ea=function(t,e){return e(new Gr("operation-not-supported-in-this-environment")),_t()},n.Db=function(){return At(new Gr("operation-not-supported-in-this-environment"))},n.Pb=function(){return!1},n.Mb=function(){return!0},n.Hb=function(){return!0},n.Ca=function(t,e,n){if(this.c)return At(new Gr("redirect-operation-pending"));var r=this,i=s.document,o=null,a=null,u=null,c=null;return this.c=_t().then(function(){return oo(e),Ou(r)}).then(function(){return function(t,e,n,r){var i=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),o=new ao(e,r,null,i,new Gr("no-auth-event")),a=fr("BuildInfo.packageName",s);if("string"!=typeof a)throw new Gr("invalid-cordova-configuration");var u=fr("BuildInfo.displayName",s),c={};if(hr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=a;else{if(!hr().toLowerCase().match(/android/))return At(new Gr("operation-not-supported-in-this-environment"));c.apn=a}u&&(c.appDisplayName=u),i=function(t){var e=new _u;Iu(e,t),t=[];var n=8*e.g;e.c<56?Iu(e,Su,56-e.c):Iu(e,Su,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Tu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return F(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(i),c.sessionId=i;var l=Ds(t.l,t.i,t.m,e,n,null,r,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(mu,o.w(),e)}).then(function(){var e=fr("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new Gr("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=fr("cordova.plugins.browsertab.openUrl",s)))throw new Gr("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=fr("cordova.InAppBrowser.open",s)))throw new Gr("invalid-cordova-configuration");e=hr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n)}).then(function(){return new bt(function(t,e){a=function(){var e=fr("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(a),u=function(){o||(o=qe(2e3).then(function(){e(new Gr("redirect-cancelled-by-user"))}))},c=function(){kr()&&u()},i.addEventListener("resume",u,!1),hr().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",c,!1)}).s(function(t){return xu(r).then(function(){throw t})})}).ia(function(){u&&i.removeEventListener("resume",u,!1),c&&i.removeEventListener("visibilitychange",c,!1),o&&o.cancel(),a&&r.La(a),r.c=null})},n.wa=function(t){this.b.push(t),Ou(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new ao("unknown",null,null,null,new Gr("no-auth-event")),t(e))})},n.La=function(t){V(this.b,function(e){return e==t})};var Ru={name:"pendingRedirect",B:"session"};function Mu(t){return hu(t.b,Ru,t.a)}function Lu(t,e,n){this.i={},this.u=0,this.A=t,this.l=e,this.o=n,this.h=[],this.f=!1,this.m=T(this.bb,this),this.b=new Wu,this.v=new Xu,this.g=new Pu(this.l+":"+this.o),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.v,this.c.linkViaPopup=this.v,this.c.reauthViaPopup=this.v,this.a=ju(this.A,this.l,this.o,hi)}function ju(e,n,r,i){var o=t.SDK_VERSION||null;return er()?new Du(e,n,r,o,i):new Is(e,n,r,o,i)}function Fu(t){t.f||(t.f=!0,t.a.wa(t.m));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function qu(t){t.a.Mb()&&Fu(t).s(function(e){var n=new ao("unknown",null,null,null,new Gr("operation-not-supported-in-this-environment"));Ku(e)&&t.bb(n)}),t.a.Hb()||Qu(t.b)}(n=Lu.prototype).reset=function(){this.f=!1,this.a.La(this.m),this.a=ju(this.A,this.l,this.o),this.i={}},n.Ya=function(){this.b.Ya()},n.subscribe=function(t){if(B(this.h,t)||this.h.push(t),!this.f){var e=this;(n=this.g,n.b.get(Ru,n.a).then(function(t){return"pending"==t})).then(function(t){t?Mu(e.g).then(function(){Fu(e).s(function(t){var n=new ao("unknown",null,null,null,new Gr("operation-not-supported-in-this-environment"));Ku(t)&&e.bb(n)})}):qu(e)}).s(function(){qu(e)})}var n},n.unsubscribe=function(t){V(this.h,function(e){return e==t})},n.bb=function(t){if(!t)throw new Gr("invalid-auth-event");if(6e5<=k()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=k())),e=!0;break}}return Qu(this.b),e};var Bu=new Ir(2e3,1e4),Uu=new Ir(3e4,6e4);function Vu(t,e,n,r,i,o){return t.a.Db(e,n,r,function(){t.f||(t.f=!0,t.a.wa(t.m))},function(){t.reset()},i,o)}function Ku(t){return!(!t||"auth/cordova-not-ready"!=t.code)}Lu.prototype.fa=function(){return this.b.fa()},Lu.prototype.Ca=function(t,e,n){var r,i,o=this;return(i=this.g,i.b.set(Ru,"pending",i.a)).then(function(){return o.a.Ca(t,e,n).s(function(t){if(Ku(t))throw new Gr("operation-not-supported-in-this-environment");return r=t,Mu(o.g).then(function(){throw r})}).then(function(){return o.a.Pb()?new bt(function(){}):Mu(o.g).then(function(){return o.fa()}).then(function(){}).s(function(){})})})},Lu.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},Bu.get())};var zu={};function Gu(t,e,n){var r=e+":"+n;return zu[r]||(zu[r]=new Lu(t,e,n)),zu[r]}function Wu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Qu(t){t.g||(t.g=!0,Yu(t,!1,null,null))}function Hu(t,e){if(t.b=function(){return _t(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Yu(t,e,n,r){e?r?function(t,e){if(t.b=function(){return At(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Hu(t,n):Hu(t,{user:null}),t.f=[],t.c=[]}function Xu(){}function $u(){this.ub=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ub},set:function(t){this.ub=t},enumerable:!1})}function Ju(t,e){this.a=e,xr(this,"verificationId",t)}function Zu(t,e,n,r){return new no(t).Ua(e,n).then(function(t){return new Ju(t,r)})}function tc(t){var e=li(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Gr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Pr(this,{token:t,expirationTime:_r(1e3*e.exp),authTime:_r(1e3*e.auth_time),issuedAtTime:_r(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function ec(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function nc(t){this.f=t,this.b=this.a=null,this.c=0}function rc(t,e){var n=e[va],r=e.refreshToken;e=ic(e.expiresIn),t.b=n,t.c=e,t.a=r}function ic(t){return k()+1e3*parseInt(t,10)}function oc(t,e){this.a=t||null,this.b=e||null,Pr(this,{lastSignInTime:_r(e||null),creationTime:_r(t||null)})}function ac(t,e,n,r,i,o){Pr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function sc(t,e){for(var n in le.call(this,t),e)this[n]=e[n]}function uc(e,n,r){var i;this.G=[],this.l=e.apiKey,this.o=e.appName,this.u=e.authDomain||null,e=t.SDK_VERSION?lr(t.SDK_VERSION):null,this.c=new ya(this.l,di(hi),e),this.h=new nc(this.c),mc(this,n[va]),rc(this.h,n),xr(this,"refreshToken",this.h.a),vc(this,r||{}),Re.call(this),this.I=!1,this.u&&pr()&&(this.a=Gu(this.u,this.l,this.o)),this.N=[],this.i=null,this.A=(i=this,new ec(function(){return i.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var t=i.h.c-k()-3e5;return 0<t?t:0})),this.V=T(this.Ha,this);var o=this;this.ka=null,this.ta=function(t){o.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){lc(o,t.c)},this.W=null}function cc(t,e){t.X&&ke(t.X,"languageCodeChanged",t.ta),(t.X=e)&&Se(e,"languageCodeChanged",t.ta)}function lc(e,n){e.O=n,Ia(e.c,t.SDK_VERSION?lr(t.SDK_VERSION,e.O):null)}function hc(t,e){t.W&&ke(t.W,"frameworkChanged",t.sa),(t.W=e)&&Se(e,"frameworkChanged",t.sa)}function fc(e){try{return t.app(e.o).auth()}catch(t){throw new Gr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.o+"'!")}}function dc(t){t.D||t.A.b||(t.A.start(),ke(t,"tokenChanged",t.V),Se(t,"tokenChanged",t.V))}function pc(t){ke(t,"tokenChanged",t.V),t.A.stop()}function mc(t,e){t.ra=e,xr(t,"_lat",e)}function yc(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return Ct(e).then(function(){return t})}function gc(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function vc(t,e){Pr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new oc(e.createdAt,e.lastLoginAt),providerData:[]})}function bc(){}function wc(t){return _t().then(function(){if(t.D)throw new Gr("app-deleted")})}function Ec(t){return F(t.providerData,function(t){return t.providerId})}function Sc(t,e){e&&(Tc(t,e.providerId),t.providerData.push(e))}function Tc(t,e){V(t.providerData,function(t){return t.providerId==e})}function Ic(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&xr(t,e,n)}function kc(t,e){var n,r,i;t!=e&&(Pr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?xr(t,"metadata",new oc((i=e.metadata).a,i.b)):xr(t,"metadata",new oc),j(e.providerData,function(e){Sc(t,e)}),n=t.h,r=e.h,n.b=r.b,n.a=r.a,n.c=r.c,xr(t,"refreshToken",t.h.a))}function _c(t){return t.F().then(function(e){var n,r,i=t.isAnonymous;return(n=t,r=e,ds(n.c,Ha,{idToken:r}).then(T(n.xc,n))).then(function(){return i||Ic(t,"isAnonymous",!1),e})})}function Ac(t,e){e[va]&&t.ra!=e[va]&&(rc(t.h,e),t.dispatchEvent(new sc("tokenChanged")),mc(t,e[va]),Ic(t,"refreshToken",t.h.a))}function Dc(t,e){return _c(t).then(function(){if(B(Ec(t),e))return yc(t).then(function(){throw new Gr("provider-already-linked")})})}function Cc(t,e,n){return Rr({user:t,credential:io(e),additionalUserInfo:e=vi(e),operationType:n})}function Nc(t,e){return Ac(t,e),t.reload().then(function(){return t})}function Oc(e,n,r,i,o){if(!pr())return At(new Gr("operation-not-supported-in-this-environment"));if(e.i&&!o)return At(e.i);var a=gi(r.providerId),s=Er(e.uid+":::"),u=null;(!gr()||nr())&&e.u&&r.isOAuthProvider&&(u=Ds(e.u,e.l,e.o,n,r,null,s,t.SDK_VERSION||null));var c=$n(u,a&&a.Ba,a&&a.Aa);return i=i().then(function(){if(Pc(e),!o)return e.F().then(function(){})}).then(function(){return Vu(e.a,c,n,r,s,!!u)}).then(function(){return new bt(function(t,r){e.ha(n,null,new Gr("cancelled-popup-request"),e.g||null),e.f=t,e.v=r,e.g=s,e.b=e.a.Ea(e,n,c,s)})}).then(function(t){return c&&Xn(c),t?Rr(t):null}).s(function(t){throw c&&Xn(c),t}),Rc(e,i,o)}function xc(t,e,n,r,i){if(!pr())return At(new Gr("operation-not-supported-in-this-environment"));if(t.i&&!i)return At(t.i);var o=null,a=Er(t.uid+":::");return r=r().then(function(){if(Pc(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,yc(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(jc,t.w(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return Fc(t.ba);throw o}).then(function(){if(o)throw o}),Rc(t,r,i)}function Pc(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Gr("internal-error");throw new Gr("auth-domain-config-required")}}function Rc(t,e,n){var r,i,o,a=(i=e,o=n,(r=t).i&&!o?(i.cancel(),At(r.i)):i.s(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(r.i||r.dispatchEvent(new sc("userInvalidated")),r.i=t),t}));return t.G.push(a),a.ia(function(){U(t.G,a)}),a}function Mc(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[va]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-k())/1e3;var r=new uc(e,n,t);return t.providerData&&j(t.providerData,function(t){t&&Sc(r,Rr(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}function Lc(t){this.a=t,this.b=uu()}Wu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Wu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Yu(this,!0,null,t.a),_t()):e.xa(n,r)?function(t,e,n){n=n.xa(e.c,e.b);var r=e.g,i=e.f,o=e.h,a=!!e.c.match(/Redirect$/);n(r,i,o).then(function(e){Yu(t,a,e,null)}).s(function(e){Yu(t,a,null,e)})}(this,t,e):At(new Gr("invalid-auth-event")):(Yu(this,!1,null,null),_t())}else At(new Gr("invalid-auth-event"))},Wu.prototype.Ya=function(){this.g&&!this.i&&Yu(this,!1,null,null)},Wu.prototype.fa=function(){var t=this;return new bt(function(e,n){var r,i;t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),r=t,i=new Gr("timeout"),r.a&&r.a.cancel(),r.a=qe(Uu.get()).then(function(){r.b||(r.g=!0,Yu(r,!0,null,i))}))})},Xu.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ha(t.c,null,t.a,t.b),_t()):e.xa(n,r)?(o=e,a=(i=t).b,s=i.c,o.xa(s,a)(i.g,i.f,i.h).then(function(t){o.ha(s,t,null,a)}).s(function(t){o.ha(s,null,t,a)})):At(new Gr("invalid-auth-event"))}else At(new Gr("invalid-auth-event"));var i,o,a,s},Ju.prototype.confirm=function(t){return t=ro(this.verificationId,t),this.a(t)},ec.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=qe(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=s.document,e=null,kr()||!t?_t():new bt(function(n){e=function(){kr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},ec.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},nc.prototype.w=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},nc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?At(new Gr("user-token-expired")):t||!this.b||k()>this.c-3e4?this.a?function(t,e){return(n=t.f,r=e,new bt(function(t,e){"refresh_token"==r.grant_type&&r.refresh_token||"authorization_code"==r.grant_type&&r.code?ka(n,n.i+"?key="+encodeURIComponent(n.b),function(n){n?n.error?e(ms(n)):n.access_token&&n.refresh_token?t(n):e(new Gr("internal-error")):e(new Gr("network-request-failed"))},"POST",hn(r).toString(),n.f,n.m.get()):e(new Gr("internal-error"))})).then(function(e){return t.b=e.access_token,t.c=ic(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e});var n,r}(this,{grant_type:"refresh_token",refresh_token:this.a}):_t(null):_t({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},oc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},_(sc,le),_(uc,Re),uc.prototype.pa=function(t){this.ka=t,Ta(this.c,t)},uc.prototype.ea=function(){return this.ka},uc.prototype.ya=function(){return z(this.O)},uc.prototype.Ha=function(){this.A.b&&(this.A.stop(),this.A.start())},xr(uc.prototype,"providerId","firebase"),(n=uc.prototype).reload=function(){var t=this;return Rc(this,wc(this).then(function(){return _c(t).then(function(){return yc(t)}).then(bc)}))},n.bc=function(t){return this.F(t).then(function(t){return new tc(t)})},n.F=function(t){var e=this;return Rc(this,wc(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Gr("internal-error");return t.accessToken!=e.ra&&(mc(e,t.accessToken),e.dispatchEvent(new sc("tokenChanged"))),Ic(e,"refreshToken",t.refreshToken),t.accessToken}))},n.xc=function(t){if(!(t=t.users)||!t.length)throw new Gr("internal-error");vc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=(r=(r=t).providerUserInfo)&&r.length?F(r,function(t){return new ac(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[],n=0;n<e.length;n++)Sc(this,e[n]);var r;Ic(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},n.yc=function(t){return Nr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.gb(t)},n.gb=function(t){var e=this,n=null;return Rc(this,t.f(this.c,this.uid).then(function(t){return Ac(e,t),n=Cc(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},n.pc=function(t){return Nr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.eb(t)},n.eb=function(t){var e=this,n=null;return Rc(this,Dc(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.c,n)}).then(function(t){return n=Cc(e,t,"link"),Nc(e,t)}).then(function(){return n}))},n.qc=function(t,e){var n=this;return Rc(this,Dc(this,"phone").then(function(){return Zu(fc(n),t,e,T(n.eb,n))}))},n.zc=function(t,e){var n=this;return Rc(this,_t().then(function(){return Zu(fc(n),t,e,T(n.gb,n))}),!0)},n.rb=function(t){var e=this;return Rc(this,this.F().then(function(n){return e.c.rb(n,t)}).then(function(t){return Ac(e,t),e.reload()}))},n.Pc=function(t){var e=this;return Rc(this,this.F().then(function(n){return t.b(e.c,n)}).then(function(t){return Ac(e,t),e.reload()}))},n.sb=function(t){var e=this;return Rc(this,this.F().then(function(n){return e.c.sb(n,t)}).then(function(t){return Ac(e,t),e.reload()}))},n.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return wc(this);var e=this;return Rc(this,this.F().then(function(n){return e.c.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Ac(e,t),Ic(e,"displayName",t.displayName||null),Ic(e,"photoURL",t.photoUrl||null),j(e.providerData,function(t){"password"===t.providerId&&(xr(t,"displayName",e.displayName),xr(t,"photoURL",e.photoURL))}),yc(e)}).then(bc))},n.Nc=function(t){var e=this;return Rc(this,_c(this).then(function(n){return B(Ec(e),t)?(r=e.c,i=n,o=[t],ds(r,Ga,{idToken:i,deleteProvider:o})).then(function(t){var n={};return j(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),j(Ec(e),function(t){n[t]||Tc(e,t)}),n[no.PROVIDER_ID]||xr(e,"phoneNumber",null),yc(e)}):yc(e).then(function(){throw new Gr("no-such-provider")});var r,i,o}))},n.delete=function(){var t=this;return Rc(this,this.F().then(function(e){return ds(t.c,za,{idToken:e})}).then(function(){t.dispatchEvent(new sc("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");cc(t,null),hc(t,null),t.G=[],t.D=!0,pc(t),xr(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},n.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},n.ha=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},n.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?T(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?T(this.Cb,this):"linkViaRedirect"==t&&(this.aa||null)==e?T(this.Bb,this):"reauthViaRedirect"==t&&(this.aa||null)==e?T(this.Cb,this):null},n.rc=function(t){var e=this;return Oc(this,"linkViaPopup",t,function(){return Dc(e,t.providerId).then(function(){return yc(e)})},!1)},n.Ac=function(t){return Oc(this,"reauthViaPopup",t,function(){return _t()},!0)},n.sc=function(t){var e=this;return xc(this,"linkViaRedirect",t,function(){return Dc(e,t.providerId)},!1)},n.Bc=function(t){return xc(this,"reauthViaRedirect",t,function(){return _t()},!0)},n.Bb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return Rc(this,this.F().then(function(i){return ja(r.c,{requestUri:t,postBody:n,sessionId:e,idToken:i})}).then(function(t){return i=Cc(r,t,"link"),Nc(r,t)}).then(function(){return i}))},n.Cb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return Rc(this,_t().then(function(){return Ni(Fa(r.c,{requestUri:t,sessionId:e,postBody:n}),r.uid)}).then(function(t){return i=Cc(r,t,"reauthenticate"),Ac(r,t),r.i=null,r.reload()}).then(function(){return i}),!0)},n.jb=function(t){var e=this,n=null;return Rc(this,this.F().then(function(e){return n=e,void 0===t||at(t)?{}:oi(new Yr(t))}).then(function(t){return e.c.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},n.toJSON=function(){return this.w()},n.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.w(),redirectEventId:this.aa||null};return this.metadata&&ht(t,this.metadata.w()),j(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var jc={name:"redirectUser",B:"session"};function Fc(t){return hu(t.b,jc,t.a)}function qc(t){var e,n,r,i,o,a,u,c,l;this.a=t,this.b=uu(),this.c=null,this.f=(e=this,n=Vc("local"),r=Vc("session"),i=Vc("none"),(o=e.b,a=n,u=e.a,c=lu(a,u),l=cu(o,a.B),o.get(a,u).then(function(t){var e=null;try{e=wr(s.localStorage.getItem(c))}catch(t){}if(e&&!t)return s.localStorage.removeItem(c),o.set(a,e,u);e&&t&&"localStorage"!=l.type&&s.localStorage.removeItem(c)})).then(function(){return e.b.get(r,e.a)}).then(function(t){return t?r:e.b.get(i,e.a).then(function(t){return t?i:e.b.get(n,e.a).then(function(t){return t?n:e.b.get(Uc,e.a).then(function(t){return t?Vc(t):n})})})}).then(function(t){return e.c=t,Bc(e,t.B)}).s(function(){e.c||(e.c=n)})),this.b.addListener(Vc("local"),this.a,T(this.g,this))}function Bc(t,e){var n,r,i=[];for(n in au)au[n]!==e&&i.push(hu(t.b,Vc(au[n]),t.a));return i.push(hu(t.b,Uc,t.a)),r=i,new bt(function(t,e){var n=r.length,i=[];if(n)for(var o=function(e,r){n--,i[e]=r,0==n&&t(i)},a=function(t){e(t)},s=0;s<r.length;s++)Dt(r[s],I(o,s),a);else t(i)})}qc.prototype.g=function(){var t=this,e=Vc("local");Wc(this,function(){return _t().then(function(){return t.c&&"local"!=t.c.B?t.b.get(e,t.a):null}).then(function(n){if(n)return Bc(t,"local").then(function(){t.c=e})})})};var Uc={name:"persistence",B:"session"};function Vc(t){return{name:"authUser",B:t}}function Kc(t,e){return Wc(t,function(){return t.b.set(t.c,e.w(),t.a)})}function zc(t){return Wc(t,function(){return hu(t.b,t.c,t.a)})}function Gc(t,e){return Wc(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Mc(t||{})})})}function Wc(t,e){return t.f=t.f.then(e,e),t.f}function Qc(e){if(this.l=!1,xr(this,"settings",new $u),xr(this,"app",e),!tl(this).options||!tl(this).options.apiKey)throw new Gr("invalid-api-key");var n,r,i,o,a,s,u,c,l,h,f;e=t.SDK_VERSION?lr(t.SDK_VERSION):null,this.c=new ya(tl(this).options&&tl(this).options.apiKey,di(hi),e),this.N=[],this.o=[],this.I=[],this.Sb=t.INTERNAL.createSubscribe(T(this.mc,this)),this.O=void 0,this.Tb=t.INTERNAL.createSubscribe(T(this.nc,this)),Jc(this,null),this.h=new qc(tl(this).options.apiKey+":"+tl(this).name),this.A=new Lc(tl(this).options.apiKey+":"+tl(this).name),this.V=il(this,(r=tl(n=this).options.authDomain,i=(o=n,a=(s=o.A,u=tl(o).options.authDomain,s.b.get(jc,s.a).then(function(t){return t&&u&&(t.authDomain=u),Mc(t||{})})).then(function(t){return(o.D=t)&&(t.ba=o.A),Fc(o.A)}),il(o,a)).then(function(){return Gc(n.h,r)}).then(function(t){return t?(t.ba=n.A,n.D&&(n.D.aa||null)==(t.aa||null)?t:t.reload().then(function(){return Kc(n.h,t).then(function(){return t})}).s(function(e){return"auth/network-request-failed"==e.code?t:zc(n.h)})):null}).then(function(t){Jc(n,t||null)}),il(n,i))),this.i=il(this,(c=this).V.then(function(){return c.fa()}).s(function(){}).then(function(){if(!c.l)return c.ka()}).s(function(){}).then(function(){if(!c.l){c.X=!0;var t=c.h;t.b.addListener(Vc("local"),t.a,c.ka)}})),this.X=!1,this.ka=T(this.Kc,this),this.Ha=T(this.Z,this),this.ra=T(this.$b,this),this.sa=T(this.jc,this),this.ta=T(this.kc,this),h=tl(l=this).options.authDomain,f=tl(l).options.apiKey,h&&pr()&&(l.Rb=l.V.then(function(){if(!l.l){if(l.a=Gu(h,f,tl(l).name),l.a.subscribe(l),el(l)&&gc(el(l)),l.D){gc(l.D);var t=l.D;t.pa(l.ea()),cc(t,l),lc(t=l.D,l.G),hc(t,l),l.D=null}return l.a}})),this.INTERNAL={},this.INTERNAL.delete=T(this.delete,this),this.INTERNAL.logFramework=T(this.tc,this),this.u=0,Re.call(this),Object.defineProperty(this,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),this.W=null,this.G=[]}function Hc(t){le.call(this,"languageCodeChanged"),this.g=t}function Yc(t){le.call(this,"frameworkChanged"),this.c=t}function Xc(t){return t.Rb||At(new Gr("auth-domain-config-required"))}function $c(t,e){var n={};return n.apiKey=tl(t).options.apiKey,n.authDomain=tl(t).options.authDomain,n.appName=tl(t).name,t.V.then(function(){return r=n,i=e,o=t.A,a=t.ya(),s=new uc(r,i),o&&(s.ba=o),a&&lc(s,a),s.reload().then(function(){return s});var r,i,o,a,s}).then(function(e){return el(t)&&e.uid==el(t).uid?kc(el(t),e):(Jc(t,e),gc(e)),t.Z(e)}).then(function(){rl(t)})}function Jc(t,e){var n,r;el(t)&&(n=el(t),r=t.Ha,V(n.N,function(t){return t==r}),ke(el(t),"tokenChanged",t.ra),ke(el(t),"userDeleted",t.sa),ke(el(t),"userInvalidated",t.ta),pc(el(t))),e&&(e.N.push(t.Ha),Se(e,"tokenChanged",t.ra),Se(e,"userDeleted",t.sa),Se(e,"userInvalidated",t.ta),0<t.u&&dc(e)),xr(t,"currentUser",e),e&&(e.pa(t.ea()),cc(e,t),lc(e,t.G),hc(e,t))}function Zc(t,e){var n=null,r=null;return il(t,e.then(function(e){return n=io(e),r=vi(e),$c(t,e)}).then(function(){return Rr({user:el(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function tl(t){return t.app}function el(t){return t.currentUser}function nl(t){return el(t)&&el(t)._lat||null}function rl(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](nl(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](nl(t))}}function il(t,e){return t.N.push(e),e.ia(function(){U(t.N,e)}),e}function ol(){}function al(){this.a={},this.b=1e12}qc.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new Gr("invalid-persistence-type"),n=new Gr("unsupported-persistence-type");t:{for(r in au)if(au[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(ir()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!dr()&&"none"!==t)throw n}}(t),Wc(this,function(){return t!=n.c.B?n.b.get(n.c,n.a).then(function(r){return e=r,Bc(n,t)}).then(function(){if(n.c=Vc(t),e)return n.b.set(n.c,e,n.a)}):_t()})},_(Qc,Re),_(Hc,le),_(Yc,le),(n=Qc.prototype).mb=function(t){return il(this,t=this.h.mb(t))},n.pa=function(t){this.W===t||this.l||(this.W=t,Ta(this.c,this.W),this.dispatchEvent(new Hc(this.ea())))},n.ea=function(){return this.W},n.Qc=function(){var t=s.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},n.tc=function(e){this.G.push(e),Ia(this.c,t.SDK_VERSION?lr(t.SDK_VERSION,this.G):null),this.dispatchEvent(new Yc(this.G))},n.ya=function(){return z(this.G)},n.toJSON=function(){return{apiKey:tl(this).options.apiKey,authDomain:tl(this).options.authDomain,appName:tl(this).name,currentUser:el(this)&&el(this).w()}},n.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},n.ha=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},n.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?T(this.Zb,this):null},n.Zb=function(t,e,n){var r=this;t={requestUri:t,postBody:n,sessionId:e},this.b&&(this.b.cancel(),this.b=null);var i=null,o=null,a=La(r.c,t).then(function(t){return i=io(t),o=vi(t),t});return il(this,t=r.V.then(function(){return a}).then(function(t){return $c(r,t)}).then(function(){return Rr({user:el(r),credential:i,additionalUserInfo:o,operationType:"signIn"})}))},n.Ic=function(e){if(!pr())return At(new Gr("operation-not-supported-in-this-environment"));var n=this,r=gi(e.providerId),i=Er(),o=null;(!gr()||nr())&&tl(this).options.authDomain&&e.isOAuthProvider&&(o=Ds(tl(this).options.authDomain,tl(this).options.apiKey,tl(this).name,"signInViaPopup",e,null,i,t.SDK_VERSION||null));var a=$n(o,r&&r.Ba,r&&r.Aa);return il(this,r=Xc(this).then(function(t){return Vu(t,a,"signInViaPopup",e,i,!!o)}).then(function(){return new bt(function(t,e){n.ha("signInViaPopup",null,new Gr("cancelled-popup-request"),n.g),n.f=t,n.v=e,n.g=i,n.b=n.a.Ea(n,"signInViaPopup",a,i)})}).then(function(t){return a&&Xn(a),t?Rr(t):null}).s(function(t){throw a&&Xn(a),t}))},n.Jc=function(t){if(!pr())return At(new Gr("operation-not-supported-in-this-environment"));var e=this;return il(this,Xc(this).then(function(){return Wc(t=e.h,function(){return t.b.set(Uc,t.c.B,t.a)});var t}).then(function(){return e.a.Ca("signInViaRedirect",t)}))},n.fa=function(){if(!pr())return At(new Gr("operation-not-supported-in-this-environment"));var t=this;return il(this,Xc(this).then(function(){return t.a.fa()}).then(function(t){return t?Rr(t):null}))},n.Oc=function(t){if(!t)return At(new Gr("null-user"));var e=this,n={};n.apiKey=tl(this).options.apiKey,n.authDomain=tl(this).options.authDomain,n.appName=tl(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[va]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-k())/1e3,e=new uc(e,o),n&&(e.ba=n),r&&lc(e,r),kc(e,t),e}(t,n,e.A,e.ya());return il(this,this.i.then(function(){if(tl(e).options.apiKey!=t.l)return r.reload()}).then(function(){return el(e)&&t.uid==el(e).uid?(kc(el(e),t),e.Z(t)):(Jc(e,r),gc(r),e.Z(r))}).then(function(){rl(e)}))},n.pb=function(){var t=this;return il(this,this.i.then(function(){return el(t)?(Jc(t,null),zc(t.h).then(function(){rl(t)})):_t()}))},n.Kc=function(){var t=this;return Gc(this.h,tl(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=el(t)&&e){n=el(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return kc(el(t),e),el(t).F();(el(t)||e)&&(Jc(t,e),e&&(gc(e),e.ba=t.A),t.a&&t.a.subscribe(t),rl(t))}})},n.Z=function(t){return Kc(this.h,t)},n.$b=function(){rl(this),this.Z(el(this))},n.jc=function(){this.pb()},n.kc=function(){this.pb()},n.mc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(el(e))})},n.nc=function(t){var e,n,r=this;n=function(){t.next(el(r))},(e=this).I.push(n),il(e,e.i.then(function(){!e.l&&B(e.I,n)&&e.O!==e.getUid()&&(e.O=e.getUid(),n(nl(e)))}))},n.vc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){g(t)?t(el(r)):g(t.next)&&t.next(el(r))}),this.Sb(t,e,n)},n.uc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){r.O=r.getUid(),g(t)?t(el(r)):g(t.next)&&t.next(el(r))}),this.Tb(t,e,n)},n.ac=function(t){var e=this;return il(this,this.i.then(function(){return el(e)?el(e).F(t).then(function(t){return{accessToken:t}}):null}))},n.Ec=function(t){var e=this;return this.i.then(function(){return Zc(e,ds(e.c,us,{token:t}))}).then(function(t){var n=t.user;return Ic(n,"isAnonymous",!1),e.Z(n),t})},n.Fc=function(t,e){var n=this;return this.i.then(function(){return Zc(n,ds(n.c,cs,{email:t,password:e}))})},n.Vb=function(t,e){var n=this;return this.i.then(function(){return Zc(n,ds(n.c,Va,{email:t,password:e}))})},n.Nb=function(t){var e=this;return this.i.then(function(){return Zc(e,t.la(e.c))})},n.nb=function(t){return Nr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Nb(t)},n.ob=function(){var t=this;return this.i.then(function(){var e=el(t);return e&&e.isAnonymous?Rr({user:e,credential:null,additionalUserInfo:Rr({providerId:null,isNewUser:!1}),operationType:"signIn"}):Zc(t,t.c.ob()).then(function(e){var n=e.user;return Ic(n,"isAnonymous",!0),t.Z(n),e})})},n.getUid=function(){return el(this)&&el(this).uid||null},n.Ub=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&el(this)&&dc(el(this))},n.Cc=function(t){var e=this;j(this.o,function(n){n==t&&e.u--}),this.u<0&&(this.u=0),0==this.u&&el(this)&&pc(el(this)),this.removeAuthTokenListener(t)},n.addAuthTokenListener=function(t){var e=this;this.o.push(t),il(this,this.i.then(function(){e.l||B(e.o,t)&&t(nl(e))}))},n.removeAuthTokenListener=function(t){V(this.o,function(e){return e==t})},n.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h).b.removeListener(Vc("local"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Ya()),Promise.resolve()},n.Yb=function(t){return il(this,ds(this.c,Ka,{identifier:t,continueUri:mr()?Qn():"http://localhost"}).then(function(t){return t.signinMethods||[]}))},n.oc=function(t){return!!Ji(t)},n.lb=function(t,e){var n=this;return il(this,_t().then(function(){var t=new Yr(e);if(!t.c)throw new Gr("argument-error",Jr+" must be true when sending sign in link to email");return oi(t)}).then(function(e){return n.c.lb(t,e)}).then(function(){}))},n.Rc=function(t){return this.Ka(t).then(function(t){return t.data.email})},n.Za=function(t,e){return il(this,this.c.Za(t,e).then(function(){}))},n.Ka=function(t){return il(this,this.c.Ka(t).then(function(t){return new Lr(t)}))},n.Wa=function(t){return il(this,this.c.Wa(t).then(function(){}))},n.kb=function(t,e){var n=this;return il(this,_t().then(function(){return void 0===e||at(e)?{}:oi(new Yr(e))}).then(function(e){return n.c.kb(t,e)}).then(function(){}))},n.Hc=function(t,e){return il(this,Zu(this,t,e,T(this.nb,this)))},n.Gc=function(t,e){var n=this;return il(this,_t().then(function(){var r=$i(t,e||Qn());return n.nb(r)}))},ol.prototype.render=function(){},ol.prototype.reset=function(){},ol.prototype.getResponse=function(){},ol.prototype.execute=function(){};var sl=null;function ul(t,e){return(e=cl(e))&&t.a[e]||null}function cl(t){return(t=void 0===t?1e12:t)?t.toString():null}function ll(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=jn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Se(this.f,"click",this.i)}function hl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function fl(){}al.prototype.render=function(t,e){return this.a[this.b.toString()]=new ll(t,e),this.b++},al.prototype.reset=function(t){var e=ul(this,t);t=cl(t),e&&t&&(e.delete(),delete this.a[t])},al.prototype.getResponse=function(t){return(t=ul(this,t))?t.getResponse():null},al.prototype.execute=function(t){(t=ul(this,t))&&t.execute()},ll.prototype.getResponse=function(){return hl(this),this.b},ll.prototype.execute=function(){hl(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(e){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},ll.prototype.delete=function(){hl(this),this.g=!0,clearTimeout(this.a),this.a=null,ke(this.f,"click",this.i)},fl.prototype.g=function(){return sl||(sl=new al),_t(sl)},fl.prototype.c=function(){};var dl=null;function pl(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var ml=new vn(En,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),yl=new Ir(3e4,6e4);pl.prototype.g=function(t){var e=this;return new bt(function(n,r){var i=setTimeout(function(){r(new Gr("network-request-failed"))},yl.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new Gr("internal-error"));delete s[e.a]},_t(ca(In(ml,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(i),r(new Gr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(s.grecaptcha))})},pl.prototype.c=function(){this.b--};var gl=null;function vl(t,e,n,r,i,o,a){if(xr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.l=e,this.g=null,a=a?(dl||(dl=new fl),dl):(gl||(gl=new pl),gl),this.o=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[El])throw new Gr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Sl],!s.document)throw new Gr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!jn(e)||!this.i&&jn(e).hasChildNodes())throw new Gr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new ya(t,o||null,i||null),this.v=r||function(){return null};var u=this;this.m=[];var c=this.a[bl];this.a[bl]=function(t){if(Tl(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=fr(c,s);"function"==typeof e&&e(t)}};var l=this.a[wl];this.a[wl]=function(){if(Tl(u,null),"function"==typeof l)l();else if("string"==typeof l){var t=fr(l,s);"function"==typeof t&&t()}}}var bl="callback",wl="expired-callback",El="sitekey",Sl="size";function Tl(t,e){for(var n=0;n<t.m.length;n++)try{t.m[n](e)}catch(t){}}function Il(t,e){return t.h.push(e),e.ia(function(){U(t.h,e)}),e}function kl(t){if(t.D)throw new Gr("internal-error","RecaptchaVerifier instance has been destroyed.")}function _l(e,n,r){var i=!1;try{this.b=r||t.app()}catch(e){throw new Gr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Gr("invalid-api-key");r=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().ya()}catch(e){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}a=t.SDK_VERSION?lr(t.SDK_VERSION,a):null,vl.call(this,r,e,n,function(){try{var t=o.b.auth().ea()}catch(e){t=null}return t},a,di(hi),i)}function Al(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Gr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],i<0||i>=Dl.length)throw new Gr("internal-error","Argument validator received an unsupported number of arguments.");n=Dl[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new Gr("argument-error",t+" failed: "+r)}(n=vl.prototype).za=function(){var t=this;return this.f?this.f:this.f=Il(this,_t().then(function(){if(mr()&&!rr())return tr();throw new Gr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,ds(t.u,Za,{})}).then(function(e){t.a[El]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},n.render=function(){kl(this);var t=this;return Il(this,this.za().then(function(){if(null===t.c){var e=t.l;if(!t.i){var n=jn(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!gn&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',dt(a.name),'"'),a.type){o.push(' type="',dt(a.type),'"');var s={};ht(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(u(a)?o.className=a:m(a)?o.className=a.join(" "):Fn(o,a)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(u(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!y(o)||v(o)&&0<o.nodeType?r(o):j(Bn(o)?z(o):o,r)}}(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},n.verify=function(){kl(this);var t=this;return Il(this,this.render().then(function(e){return new bt(function(n){var r=t.g.getResponse(e);if(r)n(r);else{t.m.push(function e(r){var i;r&&(i=e,V(t.m,function(t){return t==i}),n(r))}),t.i&&t.g.execute(t.c)}})}))},n.reset=function(){kl(this),null!==this.c&&this.g.reset(this.c)},n.clear=function(){kl(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=jn(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}},_(_l,vl);var Dl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Cl(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:u}}function Nl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:c}}function Ol(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:v}}function xl(t,e){return{name:t||"",K:"a function",optional:!!e,M:g}}function Pl(t,e){return{name:t||"",K:"null",optional:!!e,M:p}}function Rl(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function Ml(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&u(t.type)&&g(t.verify))}}}function Ll(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function jl(t,e){for(var n in e){var r=e[n].name;t[r]=Bl(r,t[n],e[n].j)}}function Fl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I(function(t){return this[t]},n),set:I(function(t,e,n,r){Al(t,[n],[r],!0),this[e]=r},r,n,e[n].vb),enumerable:!0})}}function ql(t,e,n,r){t[e]=Bl(e,n,r)}function Bl(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Al(a,n,t),e.apply(this,t)}if(!n)return e;var i,o,a=(o=(o=t).split("."))[o.length-1];for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}jl(Qc.prototype,{Wa:{name:"applyActionCode",j:[Cl("code")]},Ka:{name:"checkActionCode",j:[Cl("code")]},Za:{name:"confirmPasswordReset",j:[Cl("code"),Cl("newPassword")]},Vb:{name:"createUserWithEmailAndPassword",j:[Cl("email"),Cl("password")]},Yb:{name:"fetchSignInMethodsForEmail",j:[Cl("email")]},fa:{name:"getRedirectResult",j:[]},oc:{name:"isSignInWithEmailLink",j:[Cl("emailLink")]},uc:{name:"onAuthStateChanged",j:[Ll(Ol(),xl(),"nextOrObserver"),xl("opt_error",!0),xl("opt_completed",!0)]},vc:{name:"onIdTokenChanged",j:[Ll(Ol(),xl(),"nextOrObserver"),xl("opt_error",!0),xl("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[Cl("email"),Ll(Ol("opt_actionCodeSettings",!0),Pl(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[Cl("email"),Ol("actionCodeSettings")]},mb:{name:"setPersistence",j:[Cl("persistence")]},nb:{name:"signInAndRetrieveDataWithCredential",j:[Rl()]},ob:{name:"signInAnonymously",j:[]},Nb:{name:"signInWithCredential",j:[Rl()]},Ec:{name:"signInWithCustomToken",j:[Cl("token")]},Fc:{name:"signInWithEmailAndPassword",j:[Cl("email"),Cl("password")]},Gc:{name:"signInWithEmailLink",j:[Cl("email"),Cl("emailLink",!0)]},Hc:{name:"signInWithPhoneNumber",j:[Cl("phoneNumber"),Ml()]},Ic:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Jc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"updateCurrentUser",j:[Ll({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof uc)}},Pl(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Cl(null,!0)]},Qc:{name:"useDeviceLanguage",j:[]},Rc:{name:"verifyPasswordResetCode",j:[Cl("code")]}}),Fl(Qc.prototype,{lc:{name:"languageCode",vb:Ll(Cl(),Pl(),"languageCode")}}),(Qc.Persistence=au).LOCAL="local",Qc.Persistence.SESSION="session",Qc.Persistence.NONE="none",jl(uc.prototype,{delete:{name:"delete",j:[]},bc:{name:"getIdTokenResult",j:[Nl("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[Nl("opt_forceRefresh",!0)]},pc:{name:"linkAndRetrieveDataWithCredential",j:[Rl()]},eb:{name:"linkWithCredential",j:[Rl()]},qc:{name:"linkWithPhoneNumber",j:[Cl("phoneNumber"),Ml()]},rc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},sc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},yc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Rl()]},gb:{name:"reauthenticateWithCredential",j:[Rl()]},zc:{name:"reauthenticateWithPhoneNumber",j:[Cl("phoneNumber"),Ml()]},Ac:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Bc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[Ll(Ol("opt_actionCodeSettings",!0),Pl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Cl(null,!0)]},Nc:{name:"unlink",j:[Cl("provider")]},rb:{name:"updateEmail",j:[Cl("email")]},sb:{name:"updatePassword",j:[Cl("password")]},Pc:{name:"updatePhoneNumber",j:[Rl("phone")]},tb:{name:"updateProfile",j:[Ol("profile")]}}),jl(al.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),jl(ol.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),jl(bt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Fl($u.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",vb:Nl("appVerificationDisabledForTesting")}}),jl(Ju.prototype,{confirm:{name:"confirm",j:[Cl("verificationCode")]}}),ql(Ci,"fromJSON",function(t){t=u(t)?JSON.parse(t):t;for(var e,n=[Li,Yi,to,Pi],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[Ll(Cl(),Ol(),"json")]),ql(Xi,"credential",function(t,e){return new Hi(t,e)},[Cl("email"),Cl("password")]),jl(Hi.prototype,{w:{name:"toJSON",j:[Cl(null,!0)]}}),jl(Bi.prototype,{ua:{name:"addScope",j:[Cl("scope")]},Da:{name:"setCustomParameters",j:[Ol("customOAuthParameters")]}}),ql(Bi,"credential",Ui,[Ll(Cl(),Ol(),"token")]),ql(Xi,"credentialWithLink",$i,[Cl("email"),Cl("emailLink")]),jl(Vi.prototype,{ua:{name:"addScope",j:[Cl("scope")]},Da:{name:"setCustomParameters",j:[Ol("customOAuthParameters")]}}),ql(Vi,"credential",Ki,[Ll(Cl(),Ol(),"token")]),jl(zi.prototype,{ua:{name:"addScope",j:[Cl("scope")]},Da:{name:"setCustomParameters",j:[Ol("customOAuthParameters")]}}),ql(zi,"credential",Gi,[Ll(Cl(),Ll(Ol(),Pl()),"idToken"),Ll(Cl(),Pl(),"accessToken",!0)]),jl(Wi.prototype,{Da:{name:"setCustomParameters",j:[Ol("customOAuthParameters")]}}),ql(Wi,"credential",Qi,[Ll(Cl(),Ol(),"token"),Cl("secret",!0)]),jl(qi.prototype,{ua:{name:"addScope",j:[Cl("scope")]},credential:{name:"credential",j:[Ll(Cl(),Ll(Ol(),Pl()),"optionsOrIdToken"),Ll(Cl(),Pl(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[Ol("customOAuthParameters")]}}),jl(Ri.prototype,{w:{name:"toJSON",j:[Cl(null,!0)]}}),jl(Oi.prototype,{w:{name:"toJSON",j:[Cl(null,!0)]}}),ql(no,"credential",ro,[Cl("verificationId"),Cl("verificationCode")]),jl(no.prototype,{Ua:{name:"verifyPhoneNumber",j:[Cl("phoneNumber"),Ml()]}}),jl(Zi.prototype,{w:{name:"toJSON",j:[Cl(null,!0)]}}),jl(Gr.prototype,{toJSON:{name:"toJSON",j:[Cl(null,!0)]}}),jl(fo.prototype,{toJSON:{name:"toJSON",j:[Cl(null,!0)]}}),jl(ho.prototype,{toJSON:{name:"toJSON",j:[Cl(null,!0)]}}),jl(_l.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===t||!t.INTERNAL||!t.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={Auth:Qc,AuthCredential:Ci,Error:Gr};ql(e,"EmailAuthProvider",Xi,[]),ql(e,"FacebookAuthProvider",Bi,[]),ql(e,"GithubAuthProvider",Vi,[]),ql(e,"GoogleAuthProvider",zi,[]),ql(e,"TwitterAuthProvider",Wi,[]),ql(e,"OAuthProvider",qi,[Cl("providerId")]),ql(e,"SAMLAuthProvider",Fi,[Cl("providerId")]),ql(e,"PhoneAuthProvider",no,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Qc)}}]),ql(e,"RecaptchaVerifier",_l,[Ll(Cl(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Ol("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof t.app.App)}}]),t.INTERNAL.registerService("auth",function(t,e){return e({INTERNAL:{getUid:T((t=new Qc(t)).getUid,t),getToken:T(t.ac,t),addAuthTokenListener:T(t.Ub,t),removeAuthTokenListener:T(t.Cc,t)}}),t},e,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),t.INTERNAL.extendNamespace({User:uc})}()}.apply(void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-auth - be sure to load firebase-app.js first.")}},"object"==typeof exports&&void 0!==t?i(n(66)):"function"==typeof define&&n(50)?define(["@firebase/app"],i):i((r=r||self).firebase)}).call(this,n(17))},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(114),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(17))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,u=1,c={},l=!1,h=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){p(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){o.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(t){var e=h.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},f.clearImmediate=d}function d(t){delete c[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(17),n(64))}]);