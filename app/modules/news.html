<body id="app">
  <template id="NewsPage">
    <ui:fragment>
      <Collection ui:ref="news"
                  data="<- db://index/news"
                  initials=":newsInitialTags" />
      <NewsList ui:props="<- news://info" />
      <!-- <BigRedButton data=":AddNewRecordData" tooltip="tool" action="-> news://openAddNew" /> -->
      <!-- <NewsUpdateModal ui:if="id" id="{{id}}" open="{{open}}" data2="db:one/news/{{id}}" /> -->
      <NewsCreateModal ui:props="<- news://newEntry" submit="-> news://saveNew" cancel="-> news://cancelAddNew" />
      <Toast ui:if="error" message="{{error.message}}" />
    </ui:fragment>
  </template>

  <template id="NewsList">
    <div class="container bg-gray" style="max-width:940px;">
      <a name="top"></a>
      <Box>
        <Box:1>
          <h3 class="s-title badge text-gray my-2" data-badge="{{counts|counts}}">Naviny z Olgarda</h3>
        </Box:1>
        <Box:2>
          <SearchBar
                     input="-> news:inputKluq"
                     enter="-> news:znajdzPoKluqu"
                     value="{{kluqInput}}"
                     suggestions="{{suggestions}}" />
        </Box:2>
      </Box>
      <div class="sticky bg-gray py-2">
        <Chips data="{{tags}}" click="-> news://tag" />
      </div>
      <div class="columns">
        <NewsListItem ui:props="{{item}}" itemClick="-> nav:openItem" ui:each="item of data">
          <ui:loading>
            <div class="column col-9 col-sm-12 loading"></div>
          </ui:loading>
          <ui:empty>
            <h6 class="column col-9 col-sm-12">Nic nema</h6>
          </ui:empty>
        </NewsListItem>
        <Toast ui:if="error" message="{{error.message}}" />
      </div>
      <button class="btn btn-primary btn-sm" data-size="20"
              click="-> news://showMore"
              ui:if="counts.hasMore">:pakazac_bolsh</button>
      <a href="#top" ui:if="counts.actual|isAbove:5">:naverx</a>
    </div>
  </template>

  <template id="NewsListItem">
    <div class="column col-12 col-sm-12 my-2">
      <div class="card">
        <div class="card-header">
          <div class="tile">
            <div class="tile-icon">
              <!-- <figure class="avatar avatar- bg-primary" data-initial="{{subject|initials}}"> -->
              <img src="{{image}}"
                   class="img-responsive" width="196" data-value="{{id}}" click="itemClick" />
              <!-- </figure> -->
            </div>
            <div class="tile-content">
              <h5 class="tile-title">{{subject|translit}}</h5>
              <p>
                <small class="text-gray">{{created_at|date}}</small>
                <small class="text-gray mx-1"><a href="{{link}}" target="_blank">{{link|hostOf}}</a></small>
                <small class="text-gray" ui:if="tags">({{tags}})</small>
              </p>
            </div>
          </div>
        </div>
        <div class="card-body">
          <img src="/assets/grodno2.svg" height="10" width="10" />
          <small class="mx-2">{{preview|translit}}</small>
        </div>
        <!-- <div class="card-footer">
          <button class="btn btn-primary btn-sm">Do</button>
        </div> -->
      </div>
    </div>
  </template>

  <template id="NewsCreateModal">
    <Modal ui:if="open" open="{{open}}" title="Add a new record" close="{{cancel}}">
      <Form fields=":news_form" data="{{data}}" change="->" />
      <Modal:footer>
        <button class="btn btn-primary" data="{{data}}" click="{{submit}}">:create_new</button>
      </Modal:footer>
    </Modal>
  </template>

  <template id="NewsUpdateModal">
    <Modal ui:if="id" open="{{open}}" title="Edit record ({{id}})" close="-> nav:close">
      <Form fields=":news_form" data="{{data}}" changed="{{assign}}" />
      <ui:fragment key="footer">
        <button class="btn btn-primary" data="{{data}}" click="-> db:update/news">:update</button>
        <button class="btn btn-danger" click="-> db:delete/news/{{id}}">:delete</button>
      </ui:fragment>
    </Modal>
  </template>

</body>