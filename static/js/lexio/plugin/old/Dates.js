// Generated by CoffeeScript 1.7.1
(function() {
  (function() {
    var CURR, checkDate, checkYear, _op;
    checkYear = function(t) {
      var n, p;
      n = t.next;
      if (n && n.kind === "s") {
        n = n.next;
      }
      if (n && n.word && n.word.best.root === "год") {
        t.input += " г.";
        t.setNext(n.next);
        t.tags.push("year");
        p = t.prev;
        if (p && p.kind === "s") {
          p = p.prev;
        }
        if (!p) {
          return;
        }
        if (p.tags.indexOf("date") + 1) {
          p.input += "-" + t.input;
          p.year = t.id;
          p.setNext(t.next);
        }
        if (MONTH_ROOTS.indexOf(Object.get(p, "word.best.root")) + 1) {
          p.input += "-" + t.input;
          p.year = t.id;
          p.setNext(t.next);
          p.tags.push("label", "date", "month");
        }
      }
    };
    checkDate = function(t) {
      var n;
      n = t.next;
      if (n && n.kind === "s") {
        n = n.next;
      }
      if (n && n.word && (MONTH_ROOTS.indexOf(Object.get(n, "word.best.root")) + 1)) {
        t.input += "-" + n.input;
        t.setNext(n.next);
        t.year = CURR.getFullYear();
        t.tags.push("label", "date");
      }
    };
    _op = function(t) {
      var w;
      if (t.kind === "d") {
        if (checkYear(t)) {
          w = 3;
        }
        checkDate(t);
      }
    };
    CURR = new Date();
    Object.entity.define("lexio/plugin/dates extends lexio/Plugin", {
      methods: function(_super) {
        return {
          performImpl: function(err, ev) {
            ev.eachToken(_op);
          }
        };
      }
    });
  })();

}).call(this);
